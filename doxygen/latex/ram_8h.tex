\hypertarget{ram_8h}{}\doxysection{hardware/ram.h File Reference}
\label{ram_8h}\index{hardware/ram.h@{hardware/ram.h}}


Memory Utilities and safe free for A\+VR.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} \mbox{\hyperlink{ram_8h_aa79c5ffa29a706dd8061d0ebb68df5d8}{heaptop}} (void)
\begin{DoxyCompactList}\small\item\em calloc may be aliased to safecalloc \end{DoxyCompactList}\item 
\mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} \mbox{\hyperlink{ram_8h_ade737d434849e3c83e8472ee7766a361}{free\+Ram}} (void)
\begin{DoxyCompactList}\small\item\em Return A\+VR Free memory for Malloc. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ram_8h_a90bd9d4d00f98de3df8c280e0da16189}{Print\+Free}} (void)
\begin{DoxyCompactList}\small\item\em Display A\+VR free memory of each type$>$ \end{DoxyCompactList}\item 
void $\ast$ \mbox{\hyperlink{ram_8h_a23863723b09c3a4f836a5c10e1ecaa82}{safecalloc}} (int size, int elements)
\begin{DoxyCompactList}\small\item\em Safe Alloc -\/ Display Error message if Calloc fails. \end{DoxyCompactList}\item 
void $\ast$ \mbox{\hyperlink{ram_8h_adefba2d5cc5425b0deeaaaee6d9a384e}{safemalloc}} (\mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} size)
\begin{DoxyCompactList}\small\item\em Safe Malloc -\/ Display Error message if Malloc fails. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ram_8h_a9dc7d99df87239df4577b5b45ec6300c}{safefree}} (void $\ast$p)
\begin{DoxyCompactList}\small\item\em Safe free -\/ Only free a pointer if it is in malloc memory range. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char $\ast$ \mbox{\hyperlink{ram_8h_ad193a2cc121e0d4614a1c21eb463fb56}{\+\_\+\+\_\+brkval}}
\item 
char $\ast$ \mbox{\hyperlink{ram_8h_a9310042b3956282440c091d20cb98c5f}{\+\_\+\+\_\+malloc\+\_\+heap\+\_\+start}}
\item 
char $\ast$ \mbox{\hyperlink{ram_8h_a4d7b1bf0f75d529cc75229a266132115}{\+\_\+\+\_\+malloc\+\_\+heap\+\_\+end}}
\item 
\mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} \mbox{\hyperlink{ram_8h_affadd67736fd340e893fb22c207de597}{\+\_\+\+\_\+malloc\+\_\+margin}}
\item 
void $\ast$ \mbox{\hyperlink{ram_8h_a675511f77c3237fe03ce5eeb229315e4}{\+\_\+\+\_\+stack}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Memory Utilities and safe free for A\+VR. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ram_8h_ade737d434849e3c83e8472ee7766a361}\label{ram_8h_ade737d434849e3c83e8472ee7766a361}} 
\index{ram.h@{ram.h}!freeRam@{freeRam}}
\index{freeRam@{freeRam}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{freeRam()}{freeRam()}}
{\footnotesize\ttfamily \mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} free\+Ram (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Return A\+VR Free memory for Malloc. 


\begin{DoxyItemize}
\item avr-\/libc dependent code.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
free memory in bytes. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{hardware_2user__config_8h_a6bb12c9cae32ecd32a4584a86c4c6c99}{malloc()}}. 
\end{DoxySeeAlso}


Definition at line 50 of file ram.\+c.



Referenced by Print\+Free().

\mbox{\Hypertarget{ram_8h_aa79c5ffa29a706dd8061d0ebb68df5d8}\label{ram_8h_aa79c5ffa29a706dd8061d0ebb68df5d8}} 
\index{ram.h@{ram.h}!heaptop@{heaptop}}
\index{heaptop@{heaptop}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{heaptop()}{heaptop()}}
{\footnotesize\ttfamily \mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} heaptop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



calloc may be aliased to safecalloc 

free may be aliased to safefree

malloc may be aliased to safecalloc

Return top of heap


\begin{DoxyItemize}
\item avr-\/libc dependent code.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
top of heap 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{hardware_2user__config_8h_a6bb12c9cae32ecd32a4584a86c4c6c99}{malloc()}}. 
\end{DoxySeeAlso}


Definition at line 27 of file ram.\+c.



Referenced by free\+Ram(), Print\+Free(), and safefree().

\mbox{\Hypertarget{ram_8h_a90bd9d4d00f98de3df8c280e0da16189}\label{ram_8h_a90bd9d4d00f98de3df8c280e0da16189}} 
\index{ram.h@{ram.h}!PrintFree@{PrintFree}}
\index{PrintFree@{PrintFree}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{PrintFree()}{PrintFree()}}
{\footnotesize\ttfamily void Print\+Free (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Display A\+VR free memory of each type$>$ 


\begin{DoxyItemize}
\item avr-\/libc dependent code.
\item Stack, B\+SS, Data, Heap, Malloc.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 69 of file ram.\+c.



Referenced by main(), safefree(), and user\+\_\+task().

\mbox{\Hypertarget{ram_8h_a23863723b09c3a4f836a5c10e1ecaa82}\label{ram_8h_a23863723b09c3a4f836a5c10e1ecaa82}} 
\index{ram.h@{ram.h}!safecalloc@{safecalloc}}
\index{safecalloc@{safecalloc}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{safecalloc()}{safecalloc()}}
{\footnotesize\ttfamily void$\ast$ safecalloc (\begin{DoxyParamCaption}\item[{int}]{size,  }\item[{int}]{elements }\end{DoxyParamCaption})}



Safe Alloc -\/ Display Error message if Calloc fails. 


\begin{DoxyItemize}
\item We check if the pointer was in the heap.
\item Otherwise it may have been statically defined -\/ display error.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 122 of file ram.\+c.



Referenced by alloc\+\_\+device(), copy(), fdevopen(), i2c\+\_\+task\+\_\+op\+\_\+add(), lif\+\_\+calloc(), Mat\+Alloc(), new\+\_\+file\+\_\+descriptor(), queue\+\_\+new(), set\+\_\+\+Config\+\_\+\+Defaults(), stralloc(), and strnalloc().

\mbox{\Hypertarget{ram_8h_a9dc7d99df87239df4577b5b45ec6300c}\label{ram_8h_a9dc7d99df87239df4577b5b45ec6300c}} 
\index{ram.h@{ram.h}!safefree@{safefree}}
\index{safefree@{safefree}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{safefree()}{safefree()}}
{\footnotesize\ttfamily void safefree (\begin{DoxyParamCaption}\item[{void $\ast$}]{p }\end{DoxyParamCaption})}



Safe free -\/ Only free a pointer if it is in malloc memory range. 


\begin{DoxyItemize}
\item We check if the pointer was in the heap.
\item Otherwise it may have been statically defined -\/ display error.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & pointer to free.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 158 of file ram.\+c.



Referenced by copy(), fatfs\+\_\+tests(), ff\+\_\+memfree(), free\+\_\+device(), free\+\_\+file\+\_\+descriptor(), i2c\+\_\+task\+\_\+free\+\_\+ops(), lif\+\_\+free(), Mat\+Free(), mkfs(), new\+\_\+file\+\_\+descriptor(), printer\+\_\+close(), queue\+\_\+del(), and queue\+\_\+new().

\mbox{\Hypertarget{ram_8h_adefba2d5cc5425b0deeaaaee6d9a384e}\label{ram_8h_adefba2d5cc5425b0deeaaaee6d9a384e}} 
\index{ram.h@{ram.h}!safemalloc@{safemalloc}}
\index{safemalloc@{safemalloc}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{safemalloc()}{safemalloc()}}
{\footnotesize\ttfamily void$\ast$ safemalloc (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}}}]{size }\end{DoxyParamCaption})}



Safe Malloc -\/ Display Error message if Malloc fails. 


\begin{DoxyItemize}
\item We check if the pointer was in the heap.
\item Otherwise it may have been statically defined -\/ display error. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em size} & size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 139 of file ram.\+c.



Referenced by fatfs\+\_\+tests(), ff\+\_\+memalloc(), and mkfs().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{ram_8h_ad193a2cc121e0d4614a1c21eb463fb56}\label{ram_8h_ad193a2cc121e0d4614a1c21eb463fb56}} 
\index{ram.h@{ram.h}!\_\_brkval@{\_\_brkval}}
\index{\_\_brkval@{\_\_brkval}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{\_\_brkval}{\_\_brkval}}
{\footnotesize\ttfamily char$\ast$ \+\_\+\+\_\+brkval}



Referenced by heaptop().

\mbox{\Hypertarget{ram_8h_a4d7b1bf0f75d529cc75229a266132115}\label{ram_8h_a4d7b1bf0f75d529cc75229a266132115}} 
\index{ram.h@{ram.h}!\_\_malloc\_heap\_end@{\_\_malloc\_heap\_end}}
\index{\_\_malloc\_heap\_end@{\_\_malloc\_heap\_end}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{\_\_malloc\_heap\_end}{\_\_malloc\_heap\_end}}
{\footnotesize\ttfamily char$\ast$ \+\_\+\+\_\+malloc\+\_\+heap\+\_\+end}



Referenced by heaptop().

\mbox{\Hypertarget{ram_8h_a9310042b3956282440c091d20cb98c5f}\label{ram_8h_a9310042b3956282440c091d20cb98c5f}} 
\index{ram.h@{ram.h}!\_\_malloc\_heap\_start@{\_\_malloc\_heap\_start}}
\index{\_\_malloc\_heap\_start@{\_\_malloc\_heap\_start}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{\_\_malloc\_heap\_start}{\_\_malloc\_heap\_start}}
{\footnotesize\ttfamily char$\ast$ \+\_\+\+\_\+malloc\+\_\+heap\+\_\+start}



Referenced by Print\+Free(), and safefree().

\mbox{\Hypertarget{ram_8h_affadd67736fd340e893fb22c207de597}\label{ram_8h_affadd67736fd340e893fb22c207de597}} 
\index{ram.h@{ram.h}!\_\_malloc\_margin@{\_\_malloc\_margin}}
\index{\_\_malloc\_margin@{\_\_malloc\_margin}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{\_\_malloc\_margin}{\_\_malloc\_margin}}
{\footnotesize\ttfamily \mbox{\hyperlink{hardware_2user__config_8h_aea0c7eab1ce1eebb4e879ef4e23c16ee}{size\+\_\+t}} \+\_\+\+\_\+malloc\+\_\+margin}



Referenced by heaptop().

\mbox{\Hypertarget{ram_8h_a675511f77c3237fe03ce5eeb229315e4}\label{ram_8h_a675511f77c3237fe03ce5eeb229315e4}} 
\index{ram.h@{ram.h}!\_\_stack@{\_\_stack}}
\index{\_\_stack@{\_\_stack}!ram.h@{ram.h}}
\doxysubsubsection{\texorpdfstring{\_\_stack}{\_\_stack}}
{\footnotesize\ttfamily void$\ast$ \+\_\+\+\_\+stack}



Referenced by Print\+Free().

