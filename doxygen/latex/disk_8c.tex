\hypertarget{disk_8c}{\section{fatfs/disk.c File Reference}
\label{disk_8c}\index{fatfs/disk.\-c@{fatfs/disk.\-c}}
}


Fat\-Fs utilities utilities and tests for H\-P85 disk emulator project.  


{\ttfamily \#include \char`\"{}hardware/hardware.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ff.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}diskio.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}posix.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{disk_8c_a9e41ec7ad56bfc095ddb5e718280c4eb}{put\-\_\-rc} (int rc)
\begin{DoxyCompactList}\small\item\em display Fat\-Fs return code as ascii string \end{DoxyCompactList}\item 
\hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} $\ast$ \hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo} (int allocate)
\begin{DoxyCompactList}\small\item\em Allocate \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure and optional long file name buffer. \end{DoxyCompactList}\item 
void \hyperlink{disk_8c_a55f2dd92d9b43ef0094f0eb6a07956a8}{fatfs\-\_\-free\-\_\-filinfo} (\hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} $\ast$finfo)
\begin{DoxyCompactList}\small\item\em Free a \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure and optional long file name buffer allocated by \hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo()} \end{DoxyCompactList}\item 
int \hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files} (char $\ast$path)
\begin{DoxyCompactList}\small\item\em Compute space used, number of directories and files contained under a specified directory. \end{DoxyCompactList}\item 
void \hyperlink{disk_8c_acc4f31b5dcf3d631bb9711c39c8a916f}{fatfs\-\_\-status} (char $\ast$ptr)
\begin{DoxyCompactList}\small\item\em Compute space used, number of directories and files contained used by a drive. \end{DoxyCompactList}\item 
void \hyperlink{disk_8c_adcd917b6190c42742129a67b304d9f1b}{fatfs\-\_\-filinfo\-\_\-list} (\hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} $\ast$info)
\begin{DoxyCompactList}\small\item\em Display \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure in a readable format. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structFATFS}{F\-A\-T\-F\-S} \hyperlink{disk_8c_aae427cc909a4b5993032934d85fd8c31}{Fatfs} \mbox{[}\hyperlink{ffconf_8h_a366da9a40c8ceb3103a6b72ca02b9969}{\-\_\-\-V\-O\-L\-U\-M\-E\-S}\mbox{]}
\begin{DoxyCompactList}\small\item\em Fat\-Fs Drive Volumes. \end{DoxyCompactList}\item 
static char $\ast$ \hyperlink{disk_8c_a259efda6b8ac3181431ef38fa99d214c}{err\-\_\-msg} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em Fat\-Fs Error Messages. \end{DoxyCompactList}\item 
\hyperlink{integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} \hyperlink{disk_8c_a1e9c5ddcfdf89c9a42c96ee1d2196876}{Acc\-Size}
\begin{DoxyCompactList}\small\item\em Total file space used. \end{DoxyCompactList}\item 
\hyperlink{integer_8h_a197942eefa7db30960ae396d68339b97}{W\-O\-R\-D} \hyperlink{disk_8c_a8886578bc67fc71837328a1ee237d10c}{Acc\-Files}
\begin{DoxyCompactList}\small\item\em Total number or Files and Directories. \end{DoxyCompactList}\item 
\hyperlink{integer_8h_a197942eefa7db30960ae396d68339b97}{W\-O\-R\-D} \hyperlink{disk_8c_a4fb5ebb5ee82d1ddf3fdcf88329dd5d3}{Acc\-Dirs}
\item 
static \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} \hyperlink{disk_8c_a8483e9060691e7d2b6eb51ab947ab1a6}{\-\_\-\-\_\-finfo}
\begin{DoxyCompactList}\small\item\em Use were \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure can be share in many functions See\-: \hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo()}, \hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files()} and \hyperlink{fatfs__tests_8c_ae4d36ee22ea27a1cacd024c90bbec1da}{fatfs\-\_\-ls()} \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Fat\-Fs utilities utilities and tests for H\-P85 disk emulator project. \begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\-0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 C\-Ha\-N.}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Credit\-: used parts of Fat\-Fs avr example project (C)Cha\-N, 2013.}

\end{DoxyParagraph}


Definition in file \hyperlink{disk_8c_source}{disk.\-c}.



\subsection{Function Documentation}
\hypertarget{disk_8c_afb13747c885845dd2b4011109364f83a}{\index{disk.\-c@{disk.\-c}!fatfs\-\_\-alloc\-\_\-finfo@{fatfs\-\_\-alloc\-\_\-finfo}}
\index{fatfs\-\_\-alloc\-\_\-finfo@{fatfs\-\_\-alloc\-\_\-finfo}!disk.c@{disk.\-c}}
\subsubsection[{fatfs\-\_\-alloc\-\_\-finfo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-I\-L\-I\-N\-F\-O}$\ast$ fatfs\-\_\-alloc\-\_\-finfo (
\begin{DoxyParamCaption}
\item[{int}]{allocate}
\end{DoxyParamCaption}
)}}\label{disk_8c_afb13747c885845dd2b4011109364f83a}


Allocate \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure and optional long file name buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em allocate} & If allocate is true use safecalloc otherwise return static \-\_\-\-\_\-finfo \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
fatfs\-\_\-free\-\_\-finfo() 

\hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files()} 

\hyperlink{fatfs__tests_8c_ae4d36ee22ea27a1cacd024c90bbec1da}{fatfs\-\_\-ls()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
\hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} $\ast$ on success 

N\-U\-L\-L on error 
\end{DoxyReturn}


Definition at line 108 of file disk.\-c.



Referenced by fatfs\-\_\-ls(), fatfs\-\_\-scan\-\_\-files(), and stat().

\hypertarget{disk_8c_adcd917b6190c42742129a67b304d9f1b}{\index{disk.\-c@{disk.\-c}!fatfs\-\_\-filinfo\-\_\-list@{fatfs\-\_\-filinfo\-\_\-list}}
\index{fatfs\-\_\-filinfo\-\_\-list@{fatfs\-\_\-filinfo\-\_\-list}!disk.c@{disk.\-c}}
\subsubsection[{fatfs\-\_\-filinfo\-\_\-list}]{\setlength{\rightskip}{0pt plus 5cm}void fatfs\-\_\-filinfo\-\_\-list (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L\-I\-N\-F\-O} $\ast$}]{info}
\end{DoxyParamCaption}
)}}\label{disk_8c_adcd917b6190c42742129a67b304d9f1b}


Display \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure in a readable format. 


\begin{DoxyItemize}
\item Credit\-: part of Fat\-Fs avr example project (C)Cha\-N, 2013.
\item Example\-: \begin{DoxyVerb}/// ----A 2014/10/16 00:39        14    test2.txt  
/// D---- 2014/10/12 21:29         0          tmp 
/// \end{DoxyVerb}
 \begin{DoxyVerb}@param[in] : FILINFO pointer
@return  void  \end{DoxyVerb}
 
\end{DoxyItemize}

Definition at line 297 of file disk.\-c.



Referenced by fatfs\-\_\-ls(), and fatfs\-\_\-stat().

\hypertarget{disk_8c_a55f2dd92d9b43ef0094f0eb6a07956a8}{\index{disk.\-c@{disk.\-c}!fatfs\-\_\-free\-\_\-filinfo@{fatfs\-\_\-free\-\_\-filinfo}}
\index{fatfs\-\_\-free\-\_\-filinfo@{fatfs\-\_\-free\-\_\-filinfo}!disk.c@{disk.\-c}}
\subsubsection[{fatfs\-\_\-free\-\_\-filinfo}]{\setlength{\rightskip}{0pt plus 5cm}void fatfs\-\_\-free\-\_\-filinfo (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L\-I\-N\-F\-O} $\ast$}]{finfo}
\end{DoxyParamCaption}
)}}\label{disk_8c_a55f2dd92d9b43ef0094f0eb6a07956a8}


Free a \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure and optional long file name buffer allocated by \hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo()} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em finfo} & Fat\-Fs \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} pointer to free \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo()} 

\hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files()} 

\hyperlink{fatfs__tests_8c_ae4d36ee22ea27a1cacd024c90bbec1da}{fatfs\-\_\-ls()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 157 of file disk.\-c.

\hypertarget{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{\index{disk.\-c@{disk.\-c}!fatfs\-\_\-scan\-\_\-files@{fatfs\-\_\-scan\-\_\-files}}
\index{fatfs\-\_\-scan\-\_\-files@{fatfs\-\_\-scan\-\_\-files}!disk.c@{disk.\-c}}
\subsubsection[{fatfs\-\_\-scan\-\_\-files}]{\setlength{\rightskip}{0pt plus 5cm}int fatfs\-\_\-scan\-\_\-files (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{path}
\end{DoxyParamCaption}
)}}\label{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}


Compute space used, number of directories and files contained under a specified directory. 


\begin{DoxyItemize}
\item Credit\-: part of Fat\-Fs avr example project (C)Cha\-N, 2013
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path} & \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8c_ab63b213c75f7335fbb63a1f3f70e5fc7}{f\-\_\-opendir()} 

\hyperlink{ff_8c_ab39e82a110695de45f416f3149358012}{f\-\_\-readdir()} 

\hyperlink{disk_8c_a4fb5ebb5ee82d1ddf3fdcf88329dd5d3}{Acc\-Dirs}\-: Total number of directories 

\hyperlink{disk_8c_a8886578bc67fc71837328a1ee237d10c}{Acc\-Files}\-: Total number of Files 

\hyperlink{disk_8c_a1e9c5ddcfdf89c9a42c96ee1d2196876}{Acc\-Size}\-: Total size of all files 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
0 if no error 

Faf\-Fs error code 
\end{DoxyReturn}


Definition at line 185 of file disk.\-c.



Referenced by fatfs\-\_\-scan\-\_\-files(), and fatfs\-\_\-status().

\hypertarget{disk_8c_acc4f31b5dcf3d631bb9711c39c8a916f}{\index{disk.\-c@{disk.\-c}!fatfs\-\_\-status@{fatfs\-\_\-status}}
\index{fatfs\-\_\-status@{fatfs\-\_\-status}!disk.c@{disk.\-c}}
\subsubsection[{fatfs\-\_\-status}]{\setlength{\rightskip}{0pt plus 5cm}void fatfs\-\_\-status (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{ptr}
\end{DoxyParamCaption}
)}}\label{disk_8c_acc4f31b5dcf3d631bb9711c39c8a916f}


Compute space used, number of directories and files contained used by a drive. 


\begin{DoxyItemize}
\item Credit\-: part of Fat\-Fs avr example project (C)Cha\-N, 2013
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ptr} & Drive path like \char`\"{}/\char`\"{} \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8c_a0ff39f75a87cbda9cd6ea65d83f16cec}{f\-\_\-getfree()} drive free space 

\hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files()} 

\hyperlink{disk_8c_a4fb5ebb5ee82d1ddf3fdcf88329dd5d3}{Acc\-Dirs}\-: Total number of directories 

\hyperlink{disk_8c_a8886578bc67fc71837328a1ee237d10c}{Acc\-Files}\-: Total number of Files 

\hyperlink{disk_8c_a1e9c5ddcfdf89c9a42c96ee1d2196876}{Acc\-Size}\-: Total size of all files 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 246 of file disk.\-c.



Referenced by fatfs\-\_\-tests(), mmc\-\_\-init(), and mmc\-\_\-test().

\hypertarget{disk_8c_a9e41ec7ad56bfc095ddb5e718280c4eb}{\index{disk.\-c@{disk.\-c}!put\-\_\-rc@{put\-\_\-rc}}
\index{put\-\_\-rc@{put\-\_\-rc}!disk.c@{disk.\-c}}
\subsubsection[{put\-\_\-rc}]{\setlength{\rightskip}{0pt plus 5cm}void put\-\_\-rc (
\begin{DoxyParamCaption}
\item[{int}]{rc}
\end{DoxyParamCaption}
)}}\label{disk_8c_a9e41ec7ad56bfc095ddb5e718280c4eb}


display Fat\-Fs return code as ascii string 

Credit\-: Part of Fat\-Fs avr example project (C)Cha\-N, 2013 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em rc} & Fat\-Fs status return code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 73 of file disk.\-c.



Referenced by dbf\-\_\-close(), dbf\-\_\-lseek(), dbf\-\_\-open(), dbf\-\_\-read(), dbf\-\_\-write(), fatfs\-\_\-cat(), fatfs\-\_\-cd(), fatfs\-\_\-copy(), fatfs\-\_\-create(), fatfs\-\_\-ls(), fatfs\-\_\-mkdir(), fatfs\-\_\-pwd(), fatfs\-\_\-rename(), fatfs\-\_\-rm(), fatfs\-\_\-rmdir(), fatfs\-\_\-status(), fatfs\-\_\-tests(), and mmc\-\_\-init().



\subsection{Variable Documentation}
\hypertarget{disk_8c_a8483e9060691e7d2b6eb51ab947ab1a6}{\index{disk.\-c@{disk.\-c}!\-\_\-\-\_\-finfo@{\-\_\-\-\_\-finfo}}
\index{\-\_\-\-\_\-finfo@{\-\_\-\-\_\-finfo}!disk.c@{disk.\-c}}
\subsubsection[{\-\_\-\-\_\-finfo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-I\-L\-I\-N\-F\-O} \-\_\-\-\_\-finfo\hspace{0.3cm}{\ttfamily [static]}}}\label{disk_8c_a8483e9060691e7d2b6eb51ab947ab1a6}


Use were \hyperlink{structFILINFO}{F\-I\-L\-I\-N\-F\-O} structure can be share in many functions See\-: \hyperlink{disk_8c_afb13747c885845dd2b4011109364f83a}{fatfs\-\_\-alloc\-\_\-finfo()}, \hyperlink{disk_8c_aeeaba07e5b5b3540ba023b7181b73467}{fatfs\-\_\-scan\-\_\-files()} and \hyperlink{fatfs__tests_8c_ae4d36ee22ea27a1cacd024c90bbec1da}{fatfs\-\_\-ls()} 



Definition at line 93 of file disk.\-c.

\hypertarget{disk_8c_a4fb5ebb5ee82d1ddf3fdcf88329dd5d3}{\index{disk.\-c@{disk.\-c}!Acc\-Dirs@{Acc\-Dirs}}
\index{Acc\-Dirs@{Acc\-Dirs}!disk.c@{disk.\-c}}
\subsubsection[{Acc\-Dirs}]{\setlength{\rightskip}{0pt plus 5cm}{\bf W\-O\-R\-D} Acc\-Dirs}}\label{disk_8c_a4fb5ebb5ee82d1ddf3fdcf88329dd5d3}


Definition at line 89 of file disk.\-c.



Referenced by fatfs\-\_\-scan\-\_\-files(), and fatfs\-\_\-status().

\hypertarget{disk_8c_a8886578bc67fc71837328a1ee237d10c}{\index{disk.\-c@{disk.\-c}!Acc\-Files@{Acc\-Files}}
\index{Acc\-Files@{Acc\-Files}!disk.c@{disk.\-c}}
\subsubsection[{Acc\-Files}]{\setlength{\rightskip}{0pt plus 5cm}{\bf W\-O\-R\-D} Acc\-Files}}\label{disk_8c_a8886578bc67fc71837328a1ee237d10c}


Total number or Files and Directories. 



Definition at line 89 of file disk.\-c.



Referenced by fatfs\-\_\-scan\-\_\-files(), and fatfs\-\_\-status().

\hypertarget{disk_8c_a1e9c5ddcfdf89c9a42c96ee1d2196876}{\index{disk.\-c@{disk.\-c}!Acc\-Size@{Acc\-Size}}
\index{Acc\-Size@{Acc\-Size}!disk.c@{disk.\-c}}
\subsubsection[{Acc\-Size}]{\setlength{\rightskip}{0pt plus 5cm}{\bf D\-W\-O\-R\-D} Acc\-Size}}\label{disk_8c_a1e9c5ddcfdf89c9a42c96ee1d2196876}


Total file space used. 



Definition at line 86 of file disk.\-c.



Referenced by fatfs\-\_\-scan\-\_\-files(), and fatfs\-\_\-status().

\hypertarget{disk_8c_a259efda6b8ac3181431ef38fa99d214c}{\index{disk.\-c@{disk.\-c}!err\-\_\-msg@{err\-\_\-msg}}
\index{err\-\_\-msg@{err\-\_\-msg}!disk.c@{disk.\-c}}
\subsubsection[{err\-\_\-msg}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ err\-\_\-msg\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{disk_8c_a259efda6b8ac3181431ef38fa99d214c}
{\bfseries Initial value\-:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"OK"},
    \textcolor{stringliteral}{"DISK\_ERR"},
    \textcolor{stringliteral}{"INT\_ERR"},
    \textcolor{stringliteral}{"NOT\_READY"},
    \textcolor{stringliteral}{"NO\_FILE"},
    \textcolor{stringliteral}{"NO\_PATH"},
    \textcolor{stringliteral}{"INVALID\_NAME"},
    \textcolor{stringliteral}{"DENIED"},
    \textcolor{stringliteral}{"EXIST"},
    \textcolor{stringliteral}{"INVALID\_OBJECT"},
    \textcolor{stringliteral}{"WRITE\_PROTECTED"},
    \textcolor{stringliteral}{"INVALID\_DRIVE"},
    \textcolor{stringliteral}{"NOT\_ENABLED"},
    \textcolor{stringliteral}{"NO\_FILE\_SYSTEM"},
    \textcolor{stringliteral}{"MKFS\_ABORTED"},
    \textcolor{stringliteral}{"TIMEOUT"},
    \textcolor{stringliteral}{"LOCKED"},
    \textcolor{stringliteral}{"NOT\_ENOUGH\_CORE"},
    \textcolor{stringliteral}{"TOO\_MANY\_OPEN\_FILES"},
    \textcolor{stringliteral}{"INVALID\_PARAMETER"},
    \hyperlink{hardware_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}
\}
\end{DoxyCode}


Fat\-Fs Error Messages. 


\begin{DoxyItemize}
\item Credit\-: part of Fat\-Fs avr example project (C)Cha\-N, 2013 
\end{DoxyItemize}

Definition at line 42 of file disk.\-c.



Referenced by put\-\_\-rc().

\hypertarget{disk_8c_aae427cc909a4b5993032934d85fd8c31}{\index{disk.\-c@{disk.\-c}!Fatfs@{Fatfs}}
\index{Fatfs@{Fatfs}!disk.c@{disk.\-c}}
\subsubsection[{Fatfs}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-A\-T\-F\-S} Fatfs\mbox{[}{\bf \-\_\-\-V\-O\-L\-U\-M\-E\-S}\mbox{]}}}\label{disk_8c_aae427cc909a4b5993032934d85fd8c31}


Fat\-Fs Drive Volumes. 



Definition at line 23 of file disk.\-c.



Referenced by mmc\-\_\-init().

