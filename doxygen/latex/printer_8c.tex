\hypertarget{printer_8c}{}\section{gpib/printer.c File Reference}
\label{printer_8c}\index{gpib/printer.\+c@{gpib/printer.\+c}}


G\+P\+IB Controller Mode code H\+P85 disk emulator project for A\+VR.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}drives.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib\+\_\+hal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib\+\_\+task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}printer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}posix.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}delay.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}controller.\+h\char`\"{}}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{printer_8c_a040866641093811ade9ff0231e1ff7af}{printer\+\_\+open} (char $\ast$name)
\begin{DoxyCompactList}\small\item\em Open a file to receive plot data using P\+O\+S\+IX functions. \end{DoxyCompactList}\item 
void \hyperlink{printer_8c_af7d0edbae11867139864cff8918d64a1}{printer\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Initialize plotter structures and state. \end{DoxyCompactList}\item 
void \hyperlink{printer_8c_a08ea52e3eccce111b91a40d22846bbf0}{printer\+\_\+close} ()
\begin{DoxyCompactList}\small\item\em Close current plot file and reset states. \end{DoxyCompactList}\item 
int \hyperlink{printer_8c_a49cd5ed3c7bfd27122f36ad0f9f16fac}{receive\+\_\+plot\+\_\+flush} ()
\begin{DoxyCompactList}\small\item\em Write Plotter data and flush. \end{DoxyCompactList}\item 
void \hyperlink{printer_8c_acc37d9e3a9cc3aec5e5986dbfff7da6b}{printer\+\_\+buffer} (uint16\+\_\+t val)
\begin{DoxyCompactList}\small\item\em Buffer Plotter data and flush when buffer is full. \end{DoxyCompactList}\item 
int \hyperlink{printer_8c_a72686fe9d4969430b6ef1f1fe68a6efe}{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS} (uint8\+\_\+t ch)
\begin{DoxyCompactList}\small\item\em G\+P\+IB Secondary Command Printer commands. \end{DoxyCompactList}\item 
void \hyperlink{printer_8c_ab0733357c2cffe1aaf6dfcf9240f86fb}{plot\+\_\+echo} (int gpib\+\_\+address)
\begin{DoxyCompactList}\small\item\em Instruct Instrument to send Plot data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structPRINTERStateType}{P\+R\+I\+N\+T\+E\+R\+State\+Type} \hyperlink{printer_8c_af553ce48b56b862023dcd451e94e65ac}{plot} = \{ 0 \}
\begin{DoxyCompactList}\small\item\em Plotter file data structure used for saving plot data. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{printer_8c_a86ffa26ff3c8695d7cd5536829aa3684}{plot\+\_\+str} \mbox{[}$\,$\mbox{]} = \{ 0x3f, 0x5f, 0x47, 0x21 \}
\begin{DoxyCompactList}\small\item\em Plotter G\+P\+IB test vector. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
G\+P\+IB Controller Mode code H\+P85 disk emulator project for A\+VR. 

H\+P\+GL printer capture code for H\+P85 disk emulator project for A\+VR.

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\tt http\+://github.\+com/magore/hp85disk} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\tt http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md} for Copyright details 

\href{http://github.com/magore/hp85disk}{\tt http\+://github.\+com/magore/hp85disk} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\tt http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md} for Copyright details
\end{DoxySeeAlso}
\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\tt http\+://github.\+com/magore/hp85disk} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\tt http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md} for Copyright details 
\end{DoxySeeAlso}


\subsection{Function Documentation}
\mbox{\Hypertarget{printer_8c_ab0733357c2cffe1aaf6dfcf9240f86fb}\label{printer_8c_ab0733357c2cffe1aaf6dfcf9240f86fb}} 
\index{printer.\+c@{printer.\+c}!plot\+\_\+echo@{plot\+\_\+echo}}
\index{plot\+\_\+echo@{plot\+\_\+echo}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{plot\+\_\+echo()}{plot\_echo()}}
{\footnotesize\ttfamily void plot\+\_\+echo (\begin{DoxyParamCaption}\item[{int}]{gpib\+\_\+address }\end{DoxyParamCaption})}



Instruct Instrument to send Plot data. 


\begin{DoxyItemize}
\item Not finished or working yet -\/ barely started work in progress, \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 255 of file printer.\+c.



Referenced by gpib\+\_\+tests().

\mbox{\Hypertarget{printer_8c_acc37d9e3a9cc3aec5e5986dbfff7da6b}\label{printer_8c_acc37d9e3a9cc3aec5e5986dbfff7da6b}} 
\index{printer.\+c@{printer.\+c}!printer\+\_\+buffer@{printer\+\_\+buffer}}
\index{printer\+\_\+buffer@{printer\+\_\+buffer}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{printer\+\_\+buffer()}{printer\_buffer()}}
{\footnotesize\ttfamily void printer\+\_\+buffer (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{val }\end{DoxyParamCaption})}



Buffer Plotter data and flush when buffer is full. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 186 of file printer.\+c.



Referenced by gpib\+\_\+task().

\mbox{\Hypertarget{printer_8c_a08ea52e3eccce111b91a40d22846bbf0}\label{printer_8c_a08ea52e3eccce111b91a40d22846bbf0}} 
\index{printer.\+c@{printer.\+c}!printer\+\_\+close@{printer\+\_\+close}}
\index{printer\+\_\+close@{printer\+\_\+close}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{printer\+\_\+close()}{printer\_close()}}
{\footnotesize\ttfamily void printer\+\_\+close (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Close current plot file and reset states. 


\begin{DoxyItemize}
\item Verify that polt file is open before attempting close.
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void F\+YI\+: for the H\+P54645D plots end with\+: pd;pu;pu;sp0; This gets called 
\end{DoxyReturn}


Definition at line 118 of file printer.\+c.



Referenced by G\+P\+I\+B(), gpib\+\_\+init\+\_\+devices(), listen\+\_\+cleanup(), plot\+\_\+echo(), and printer\+\_\+open().

\mbox{\Hypertarget{printer_8c_a72686fe9d4969430b6ef1f1fe68a6efe}\label{printer_8c_a72686fe9d4969430b6ef1f1fe68a6efe}} 
\index{printer.\+c@{printer.\+c}!P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS}}
\index{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S()}{PRINTER\_COMMANDS()}}
{\footnotesize\ttfamily int P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{ch }\end{DoxyParamCaption})}



G\+P\+IB Secondary Command Printer commands. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000007}{Todo}]Fully emulated plotter response. \end{DoxyRefDesc}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 227 of file printer.\+c.



Referenced by G\+P\+I\+B\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\mbox{\Hypertarget{printer_8c_af7d0edbae11867139864cff8918d64a1}\label{printer_8c_af7d0edbae11867139864cff8918d64a1}} 
\index{printer.\+c@{printer.\+c}!printer\+\_\+init@{printer\+\_\+init}}
\index{printer\+\_\+init@{printer\+\_\+init}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{printer\+\_\+init()}{printer\_init()}}
{\footnotesize\ttfamily void printer\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize plotter structures and state. 


\begin{DoxyItemize}
\item Only called once after power on by \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()}. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 98 of file printer.\+c.



Referenced by main(), and printer\+\_\+close().

\mbox{\Hypertarget{printer_8c_a040866641093811ade9ff0231e1ff7af}\label{printer_8c_a040866641093811ade9ff0231e1ff7af}} 
\index{printer.\+c@{printer.\+c}!printer\+\_\+open@{printer\+\_\+open}}
\index{printer\+\_\+open@{printer\+\_\+open}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{printer\+\_\+open()}{printer\_open()}}
{\footnotesize\ttfamily void printer\+\_\+open (\begin{DoxyParamCaption}\item[{char $\ast$}]{name }\end{DoxyParamCaption})}



Open a file to receive plot data using P\+O\+S\+IX functions. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 43 of file printer.\+c.



Referenced by G\+P\+I\+B\+\_\+\+L\+I\+S\+T\+E\+N(), and G\+P\+I\+B\+\_\+\+T\+A\+L\+K().

\mbox{\Hypertarget{printer_8c_a49cd5ed3c7bfd27122f36ad0f9f16fac}\label{printer_8c_a49cd5ed3c7bfd27122f36ad0f9f16fac}} 
\index{printer.\+c@{printer.\+c}!receive\+\_\+plot\+\_\+flush@{receive\+\_\+plot\+\_\+flush}}
\index{receive\+\_\+plot\+\_\+flush@{receive\+\_\+plot\+\_\+flush}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{receive\+\_\+plot\+\_\+flush()}{receive\_plot\_flush()}}
{\footnotesize\ttfamily int receive\+\_\+plot\+\_\+flush (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Write Plotter data and flush. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 

\hyperlink{printer_8c_acc37d9e3a9cc3aec5e5986dbfff7da6b}{printer\+\_\+buffer()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
file handle 
\end{DoxyReturn}
sync filesystem after every write 

Definition at line 151 of file printer.\+c.



Referenced by printer\+\_\+buffer(), and printer\+\_\+close().



\subsection{Variable Documentation}
\mbox{\Hypertarget{printer_8c_af553ce48b56b862023dcd451e94e65ac}\label{printer_8c_af553ce48b56b862023dcd451e94e65ac}} 
\index{printer.\+c@{printer.\+c}!plot@{plot}}
\index{plot@{plot}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{plot}{plot}}
{\footnotesize\ttfamily \hyperlink{structPRINTERStateType}{P\+R\+I\+N\+T\+E\+R\+State\+Type} plot = \{ 0 \}}



Plotter file data structure used for saving plot data. 



Definition at line 30 of file printer.\+c.

\mbox{\Hypertarget{printer_8c_a86ffa26ff3c8695d7cd5536829aa3684}\label{printer_8c_a86ffa26ff3c8695d7cd5536829aa3684}} 
\index{printer.\+c@{printer.\+c}!plot\+\_\+str@{plot\+\_\+str}}
\index{plot\+\_\+str@{plot\+\_\+str}!printer.\+c@{printer.\+c}}
\subsubsection{\texorpdfstring{plot\+\_\+str}{plot\_str}}
{\footnotesize\ttfamily uint8\+\_\+t plot\+\_\+str\mbox{[}$\,$\mbox{]} = \{ 0x3f, 0x5f, 0x47, 0x21 \}}



Plotter G\+P\+IB test vector. 



Definition at line 33 of file printer.\+c.

