\hypertarget{printer_8h}{}\section{gpib/printer.h File Reference}
\label{printer_8h}\index{gpib/printer.\+h@{gpib/printer.\+h}}


H\+P\+GL printer capture code for H\+P85 disk emulator project for A\+VR.  


{\ttfamily \#include $<$user\+\_\+config.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{printer_8h_a040866641093811ade9ff0231e1ff7af}{printer\+\_\+open} (char $\ast$name)
\begin{DoxyCompactList}\small\item\em Open a file to receive plot data using P\+O\+S\+IX functions. \end{DoxyCompactList}\item 
void \hyperlink{printer_8h_a3ed05788bcf67880241842f4e41e5217}{printer\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Initialize plotter structures and state. \end{DoxyCompactList}\item 
void \hyperlink{printer_8h_a3c909f346990aba58d80faa539f5effd}{printer\+\_\+close} (void)
\begin{DoxyCompactList}\small\item\em Close current plot file and reset states. \end{DoxyCompactList}\item 
int \hyperlink{printer_8h_a06cc5819c3a956913f41114deb55a113}{receive\+\_\+plot\+\_\+flush} (void)
\begin{DoxyCompactList}\small\item\em Write Plotter data and flush. \end{DoxyCompactList}\item 
void \hyperlink{printer_8h_acc37d9e3a9cc3aec5e5986dbfff7da6b}{printer\+\_\+buffer} (uint16\+\_\+t val)
\begin{DoxyCompactList}\small\item\em Buffer Plotter data and flush when buffer is full. \end{DoxyCompactList}\item 
int \hyperlink{printer_8h_a72686fe9d4969430b6ef1f1fe68a6efe}{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS} (uint8\+\_\+t ch)
\begin{DoxyCompactList}\small\item\em G\+P\+IB Secondary Command Printer commands. \end{DoxyCompactList}\item 
int \hyperlink{printer_8h_aac124dc0290a643bf1e950485a8dfb81}{controller\+\_\+send\+\_\+str} (uint8\+\_\+t from, uint8\+\_\+t to, uint8\+\_\+t $\ast$str, int len)
\begin{DoxyCompactList}\small\item\em Controller Mode send A\+S\+C\+II string Stops sending with E\+OI. \end{DoxyCompactList}\item 
int \hyperlink{printer_8h_ad447a1f9fa3fbefd996c5839f42b9642}{controller\+\_\+read\+\_\+str} (uint8\+\_\+t from, uint8\+\_\+t to, uint8\+\_\+t $\ast$str, int len)
\begin{DoxyCompactList}\small\item\em Controller Mode read A\+S\+C\+II string Stops reading at E\+OI. \end{DoxyCompactList}\item 
int \hyperlink{printer_8h_af027c36d1fffacf39a7a691fa78695c1}{controller\+\_\+read\+\_\+trace} (uint8\+\_\+t from, uint8\+\_\+t to)
\begin{DoxyCompactList}\small\item\em Controller Mode T\+R\+A\+CE read for debugging Stops reading at E\+OI. \end{DoxyCompactList}\item 
void \hyperlink{printer_8h_ae697f6dbf1676478adbe30ff1f945d55}{controller\+\_\+ifc} (void)
\item 
void \hyperlink{printer_8h_ab0733357c2cffe1aaf6dfcf9240f86fb}{plot\+\_\+echo} (int gpib\+\_\+address)
\begin{DoxyCompactList}\small\item\em Instruct Instrument to send Plot data. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
H\+P\+GL printer capture code for H\+P85 disk emulator project for A\+VR. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2017 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Function Documentation}
\index{printer.\+h@{printer.\+h}!controller\+\_\+ifc@{controller\+\_\+ifc}}
\index{controller\+\_\+ifc@{controller\+\_\+ifc}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{controller\+\_\+ifc(void)}{controller_ifc(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void controller\+\_\+ifc (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_ae697f6dbf1676478adbe30ff1f945d55}{}\label{printer_8h_ae697f6dbf1676478adbe30ff1f945d55}


Definition at line 340 of file printer.\+c.

\index{printer.\+h@{printer.\+h}!controller\+\_\+read\+\_\+str@{controller\+\_\+read\+\_\+str}}
\index{controller\+\_\+read\+\_\+str@{controller\+\_\+read\+\_\+str}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{controller\+\_\+read\+\_\+str(uint8\+\_\+t from, uint8\+\_\+t to, uint8\+\_\+t $\ast$str, int len)}{controller_read_str(uint8_t from, uint8_t to, uint8_t *str, int len)}}]{\setlength{\rightskip}{0pt plus 5cm}int controller\+\_\+read\+\_\+str (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{from, }
\item[{uint8\+\_\+t}]{to, }
\item[{uint8\+\_\+t $\ast$}]{str, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_ad447a1f9fa3fbefd996c5839f42b9642}{}\label{printer_8h_ad447a1f9fa3fbefd996c5839f42b9642}


Controller Mode read A\+S\+C\+II string Stops reading at E\+OI. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em from} & G\+P\+IB talker \\
\hline
\mbox{\tt in}  & {\em to} & G\+P\+IB listener \\
\hline
\mbox{\tt in}  & {\em str} & string to read \\
\hline
\mbox{\tt in}  & {\em len} & maximum number of bytes to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes read 
\end{DoxyReturn}


Definition at line 284 of file printer.\+c.



Referenced by plot\+\_\+echo().

\index{printer.\+h@{printer.\+h}!controller\+\_\+read\+\_\+trace@{controller\+\_\+read\+\_\+trace}}
\index{controller\+\_\+read\+\_\+trace@{controller\+\_\+read\+\_\+trace}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{controller\+\_\+read\+\_\+trace(uint8\+\_\+t from, uint8\+\_\+t to)}{controller_read_trace(uint8_t from, uint8_t to)}}]{\setlength{\rightskip}{0pt plus 5cm}int controller\+\_\+read\+\_\+trace (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{from, }
\item[{uint8\+\_\+t}]{to}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_af027c36d1fffacf39a7a691fa78695c1}{}\label{printer_8h_af027c36d1fffacf39a7a691fa78695c1}


Controller Mode T\+R\+A\+CE read for debugging Stops reading at E\+OI. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em from} & G\+P\+IB talker \\
\hline
\mbox{\tt in}  & {\em to} & G\+P\+IB listener \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes read 
\end{DoxyReturn}


Definition at line 312 of file printer.\+c.



Referenced by plot\+\_\+echo().

\index{printer.\+h@{printer.\+h}!controller\+\_\+send\+\_\+str@{controller\+\_\+send\+\_\+str}}
\index{controller\+\_\+send\+\_\+str@{controller\+\_\+send\+\_\+str}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{controller\+\_\+send\+\_\+str(uint8\+\_\+t from, uint8\+\_\+t to, uint8\+\_\+t $\ast$str, int len)}{controller_send_str(uint8_t from, uint8_t to, uint8_t *str, int len)}}]{\setlength{\rightskip}{0pt plus 5cm}int controller\+\_\+send\+\_\+str (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{from, }
\item[{uint8\+\_\+t}]{to, }
\item[{uint8\+\_\+t $\ast$}]{str, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_aac124dc0290a643bf1e950485a8dfb81}{}\label{printer_8h_aac124dc0290a643bf1e950485a8dfb81}


Controller Mode send A\+S\+C\+II string Stops sending with E\+OI. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em from} & G\+P\+IB talker \\
\hline
\mbox{\tt in}  & {\em to} & G\+P\+IB listener \\
\hline
\mbox{\tt in}  & {\em str} & string to send \\
\hline
\mbox{\tt in}  & {\em len} & number of bytes to send (if 0 then length of string) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of bytes sent 
\end{DoxyReturn}
debugging 

Definition at line 256 of file printer.\+c.



Referenced by plot\+\_\+echo().

\index{printer.\+h@{printer.\+h}!plot\+\_\+echo@{plot\+\_\+echo}}
\index{plot\+\_\+echo@{plot\+\_\+echo}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{plot\+\_\+echo(int gpib\+\_\+address)}{plot_echo(int gpib_address)}}]{\setlength{\rightskip}{0pt plus 5cm}void plot\+\_\+echo (
\begin{DoxyParamCaption}
\item[{int}]{gpib\+\_\+address}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_ab0733357c2cffe1aaf6dfcf9240f86fb}{}\label{printer_8h_ab0733357c2cffe1aaf6dfcf9240f86fb}


Instruct Instrument to send Plot data. 


\begin{DoxyItemize}
\item Not finished or working yet -\/ barely started work in progress, \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 355 of file printer.\+c.



Referenced by gpib\+\_\+tests().

\index{printer.\+h@{printer.\+h}!printer\+\_\+buffer@{printer\+\_\+buffer}}
\index{printer\+\_\+buffer@{printer\+\_\+buffer}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{printer\+\_\+buffer(uint16\+\_\+t val)}{printer_buffer(uint16_t val)}}]{\setlength{\rightskip}{0pt plus 5cm}void printer\+\_\+buffer (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{val}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_acc37d9e3a9cc3aec5e5986dbfff7da6b}{}\label{printer_8h_acc37d9e3a9cc3aec5e5986dbfff7da6b}


Buffer Plotter data and flush when buffer is full. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 183 of file printer.\+c.



Referenced by gpib\+\_\+task().

\index{printer.\+h@{printer.\+h}!printer\+\_\+close@{printer\+\_\+close}}
\index{printer\+\_\+close@{printer\+\_\+close}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{printer\+\_\+close(void)}{printer_close(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void printer\+\_\+close (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_a3c909f346990aba58d80faa539f5effd}{}\label{printer_8h_a3c909f346990aba58d80faa539f5effd}


Close current plot file and reset states. 


\begin{DoxyItemize}
\item Verify that polt file is open before attempting close.
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void F\+YI\+: for the H\+P54645D plots end with\+: pd;pu;pu;sp0; This gets called 
\end{DoxyReturn}


Definition at line 115 of file printer.\+c.



Referenced by G\+P\+I\+B(), gpib\+\_\+init\+\_\+devices(), listen\+\_\+cleanup(), plot\+\_\+echo(), and printer\+\_\+open().

\index{printer.\+h@{printer.\+h}!P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS}}
\index{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S(uint8\+\_\+t ch)}{PRINTER_COMMANDS(uint8_t ch)}}]{\setlength{\rightskip}{0pt plus 5cm}int P\+R\+I\+N\+T\+E\+R\+\_\+\+C\+O\+M\+M\+A\+N\+DS (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{ch}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_a72686fe9d4969430b6ef1f1fe68a6efe}{}\label{printer_8h_a72686fe9d4969430b6ef1f1fe68a6efe}


G\+P\+IB Secondary Command Printer commands. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000007}{Todo}]Fully emulated plotter response. \end{DoxyRefDesc}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 224 of file printer.\+c.



Referenced by G\+P\+I\+B\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\index{printer.\+h@{printer.\+h}!printer\+\_\+init@{printer\+\_\+init}}
\index{printer\+\_\+init@{printer\+\_\+init}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{printer\+\_\+init(void)}{printer_init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void printer\+\_\+init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_a3ed05788bcf67880241842f4e41e5217}{}\label{printer_8h_a3ed05788bcf67880241842f4e41e5217}


Initialize plotter structures and state. 


\begin{DoxyItemize}
\item Only called once after power on by \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()}. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 95 of file printer.\+c.



Referenced by main(), and printer\+\_\+close().

\index{printer.\+h@{printer.\+h}!printer\+\_\+open@{printer\+\_\+open}}
\index{printer\+\_\+open@{printer\+\_\+open}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{printer\+\_\+open(char $\ast$name)}{printer_open(char *name)}}]{\setlength{\rightskip}{0pt plus 5cm}void printer\+\_\+open (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_a040866641093811ade9ff0231e1ff7af}{}\label{printer_8h_a040866641093811ade9ff0231e1ff7af}


Open a file to receive plot data using P\+O\+S\+IX functions. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 40 of file printer.\+c.



Referenced by G\+P\+I\+B\+\_\+\+L\+I\+S\+T\+E\+N(), and G\+P\+I\+B\+\_\+\+T\+A\+L\+K().

\index{printer.\+h@{printer.\+h}!receive\+\_\+plot\+\_\+flush@{receive\+\_\+plot\+\_\+flush}}
\index{receive\+\_\+plot\+\_\+flush@{receive\+\_\+plot\+\_\+flush}!printer.\+h@{printer.\+h}}
\subsubsection[{\texorpdfstring{receive\+\_\+plot\+\_\+flush(void)}{receive_plot_flush(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int receive\+\_\+plot\+\_\+flush (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{printer_8h_a06cc5819c3a956913f41114deb55a113}{}\label{printer_8h_a06cc5819c3a956913f41114deb55a113}


Write Plotter data and flush. 


\begin{DoxyItemize}
\item Uses P\+O\+S\+IX Fat\+Fs wrappers.
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c}{posix.\+c} 

\hyperlink{posix_8h}{posix.\+h} 

\hyperlink{printer_8c_acc37d9e3a9cc3aec5e5986dbfff7da6b}{printer\+\_\+buffer()} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
file handle 
\end{DoxyReturn}
sync filesystem after every write 

Definition at line 148 of file printer.\+c.



Referenced by printer\+\_\+buffer(), and printer\+\_\+close().

