\hypertarget{gpib__hal_8h}{\section{gpib/gpib\-\_\-hal.h File Reference}
\label{gpib__hal_8h}\index{gpib/gpib\-\_\-hal.\-h@{gpib/gpib\-\_\-hal.\-h}}
}


G\-P\-I\-B emulator hardwware layer for H\-P85 disk emulator project for A\-V\-R8.  


{\ttfamily \#include \char`\"{}hardware/hardware.\-h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct__gpib__t}{\-\_\-gpib\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{gpib__hal_8h_a5f1e4767ce01d70700e03b6eb4965fce}{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E}()~\-\_\-delay\-\_\-us(\hyperlink{gpib_8h_a32473ded8149304bd8d0be0abe6e3de8}{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E\-\_\-\-D\-E\-L\-A\-Y})
\item 
\#define \hyperlink{gpib__hal_8h_a4e9b50fcf601cb4f967d11668cd9e640}{G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}~\hyperlink{timer_8h_a7e0b78d1697fa3781598373f4e161ea3}{S\-Y\-S\-T\-E\-M\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}       /$\ast$ Interrupt \hyperlink{time_8h_ae7841e681c8c9d59818568d39553642c}{time} in U\-S $\ast$/
\item 
\#define \hyperlink{gpib__hal_8h_a6aaf20205cebc55cf256db1750fab754}{S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R}~/$\ast$ We have a system elapsed \hyperlink{time_8h_ae7841e681c8c9d59818568d39553642c}{time} function $\ast$/
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{struct__gpib__t}{\-\_\-gpib\-\_\-t} \hyperlink{gpib__hal_8h_a4791e72a1dc0caa0e23b3f4fb6aefc94}{gpib\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{gpib__hal_8h_a9b6c518118134f3eb680bf927e93c836}{gpib\-\_\-clock\-\_\-task} (void)
\item 
void \hyperlink{gpib__hal_8h_acd3a9c6b7893afed15717f7ed85fc185}{gpib\-\_\-timer\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Install G\-P\-I\-B timers, Elapsed time and Timeout tasks. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{gpib__hal_8h_aaff7ca1ff8eb6c387fe41ce530fe0eb8}{reverse\-\_\-8bits} (uint8\-\_\-t mask)
\begin{DoxyCompactList}\small\item\em Reverse the bits in an 8 bit value. \end{DoxyCompactList}\item 
void \hyperlink{gpib__hal_8h_a62ab33e5f2d926916ee673ddcb8e9410}{ppr\-\_\-set} (uint8\-\_\-t mask)
\begin{DoxyCompactList}\small\item\em Enable or Disable Parallel Poll Response bits -\/ P\-P\-R. \end{DoxyCompactList}\item 
void \hyperlink{gpib__hal_8h_a8772af94e84d58285c52be53679bfbb2}{soft\-\_\-ppr\-\_\-assert} (void)
\item 
void \hyperlink{gpib__hal_8h_a2065b4c9ff1a1c90a90779fc31870511}{soft\-\_\-ppr\-\_\-restore} (void)
\item 
uint8\-\_\-t \hyperlink{gpib__hal_8h_a57653cc4c2dc251f12d5cc5b1bf7b754}{ppr\-\_\-reg} (void)
\begin{DoxyCompactList}\small\item\em Return P\-P\-R enable register. \end{DoxyCompactList}\item 
void \hyperlink{gpib__hal_8h_a9198a0ec473e147423887e68bb9f267d}{ppr\-\_\-init} (void)
\begin{DoxyCompactList}\small\item\em Reset P\-P\-R enable register -\/ all disable.. \end{DoxyCompactList}\item 
void \hyperlink{gpib__hal_8h_a4ab95314499ea3d42ead5229bfbc2b27}{ppr\-\_\-bit\-\_\-set} (uint8\-\_\-t bit)
\begin{DoxyCompactList}\small\item\em Enable hardware P\-P\-R response for a given device. \end{DoxyCompactList}\item 
void \hyperlink{gpib__hal_8h_af29c709ec1aeedc42ff180662636d8c6}{ppr\-\_\-bit\-\_\-clr} (uint8\-\_\-t bit)
\begin{DoxyCompactList}\small\item\em Disbale hardware P\-P\-R response for a given device. \end{DoxyCompactList}\item 
\hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{gpib__hal_8h_a7d75cde9e0af3c75dce17919bdf7fe3e}{dbf\-\_\-open} (\hyperlink{structFIL}{F\-I\-L} $\ast$fp, const \hyperlink{ff_8h_a03bdb8ce5895c7e261aadc2529637546}{T\-C\-H\-A\-R} $\ast$path, \hyperlink{integer_8h_a4ae1dab0fb4b072a66584546209e7d58}{B\-Y\-T\-E} mode)
\begin{DoxyCompactList}\small\item\em Wrapper for Fat\-Fs \hyperlink{ff_8c_aefdef7126128d99d0b3bd82c28e54d80}{f\-\_\-open()} that can displays errors. \end{DoxyCompactList}\item 
\hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{gpib__hal_8h_a2303ee350c0d266ac87a2135936cb727}{dbf\-\_\-read} (\hyperlink{structFIL}{F\-I\-L} $\ast$fp, void $\ast$buff, \hyperlink{integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} btr, \hyperlink{integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} $\ast$br)
\begin{DoxyCompactList}\small\item\em Wrapper for Fat\-Fs \hyperlink{ff_8c_ac4c3dcb6869ca252888eebabe39727b3}{f\-\_\-read()} that can display errors. \end{DoxyCompactList}\item 
\hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{gpib__hal_8h_a14af877aeb5d346730aaabba033695bf}{dbf\-\_\-write} (\hyperlink{structFIL}{F\-I\-L} $\ast$fp, const void $\ast$buff, \hyperlink{integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} btw, \hyperlink{integer_8h_a36cb3b01d81ffd844bbbfb54003e06ec}{U\-I\-N\-T} $\ast$bw)
\begin{DoxyCompactList}\small\item\em wrapper for Fat\-Fs \hyperlink{ff_8c_ae6a4dfae8a9e308bdb2283a37ef680f2}{f\-\_\-write()} that can display errors. \end{DoxyCompactList}\item 
\hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{gpib__hal_8h_afd7a928788776071dc461e7d99d9f506}{dbf\-\_\-lseek} (\hyperlink{structFIL}{F\-I\-L} $\ast$fp, \hyperlink{integer_8h_ad342ac907eb044443153a22f964bf0af}{D\-W\-O\-R\-D} ofs)
\begin{DoxyCompactList}\small\item\em Wrapper of Fat\-Fs f\-\_\-seek() that can display errors. \end{DoxyCompactList}\item 
\hyperlink{ff_8h_a49d0171ecbd362cda5680a0d360db44c}{F\-R\-E\-S\-U\-L\-T} \hyperlink{gpib__hal_8h_a827fbebac6fd202d102386e15b92b28b}{dbf\-\_\-close} (\hyperlink{structFIL}{F\-I\-L} $\ast$fp)
\begin{DoxyCompactList}\small\item\em Wrapper of Fat\-Fs \hyperlink{ff_8c_a53882db20ef4323dcfd1874d7733ffc3}{f\-\_\-close()} that can display errors. \end{DoxyCompactList}\item 
int \hyperlink{gpib__hal_8h_af60274390be1b899ca94740dba5931df}{dbf\-\_\-open\-\_\-read} (char $\ast$name, uint32\-\_\-t pos, void $\ast$buff, int size, int $\ast$errors)
\begin{DoxyCompactList}\small\item\em Open, Seek, Read data and Close Fat\-Fs functions. \end{DoxyCompactList}\item 
int \hyperlink{gpib__hal_8h_a9a6e6853672fd6150839e79ee4e857af}{dbf\-\_\-open\-\_\-write} (char $\ast$name, uint32\-\_\-t pos, void $\ast$buff, int size, int $\ast$errors)
\begin{DoxyCompactList}\small\item\em Open, Seek, Write data and Close Fat\-Fs functions. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{gpib__hal_8h_a4791e72a1dc0caa0e23b3f4fb6aefc94}{gpib\-\_\-t} \hyperlink{gpib__hal_8h_aced56ceaa5d240d5554a33f88596f87a}{gpib\-\_\-timer}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
G\-P\-I\-B emulator hardwware layer for H\-P85 disk emulator project for A\-V\-R8. \begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\-0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


Definition in file \hyperlink{gpib__hal_8h_source}{gpib\-\_\-hal.\-h}.



\subsection{Macro Definition Documentation}
\hypertarget{gpib__hal_8h_a5f1e4767ce01d70700e03b6eb4965fce}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E@{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E}}
\index{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E@{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)~\-\_\-delay\-\_\-us({\bf G\-P\-I\-B\-\_\-\-B\-U\-S\-\_\-\-S\-E\-T\-T\-L\-E\-\_\-\-D\-E\-L\-A\-Y})}}\label{gpib__hal_8h_a5f1e4767ce01d70700e03b6eb4965fce}


Definition at line 20 of file gpib\-\_\-hal.\-h.



Referenced by gpib\-\_\-bus\-\_\-init(), gpib\-\_\-read\-\_\-byte(), and gpib\-\_\-write\-\_\-byte().

\hypertarget{gpib__hal_8h_a4e9b50fcf601cb4f967d11668cd9e640}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S@{G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}}
\index{G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S@{G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\-P\-I\-B\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S~{\bf S\-Y\-S\-T\-E\-M\-\_\-\-T\-A\-S\-K\-\_\-\-T\-I\-C\-\_\-\-U\-S}       /$\ast$ Interrupt {\bf time} in U\-S $\ast$/}}\label{gpib__hal_8h_a4e9b50fcf601cb4f967d11668cd9e640}


Definition at line 22 of file gpib\-\_\-hal.\-h.



Referenced by gpib\-\_\-timer\-\_\-elapsed\-\_\-end().

\hypertarget{gpib__hal_8h_a6aaf20205cebc55cf256db1750fab754}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R@{S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R}}
\index{S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R@{S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\-Y\-S\-T\-E\-M\-\_\-\-E\-L\-A\-P\-S\-E\-D\-\_\-\-T\-I\-M\-E\-R~/$\ast$ We have a system elapsed {\bf time} function $\ast$/}}\label{gpib__hal_8h_a6aaf20205cebc55cf256db1750fab754}


Definition at line 24 of file gpib\-\_\-hal.\-h.



\subsection{Typedef Documentation}
\hypertarget{gpib__hal_8h_a4791e72a1dc0caa0e23b3f4fb6aefc94}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!gpib\-\_\-t@{gpib\-\_\-t}}
\index{gpib\-\_\-t@{gpib\-\_\-t}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{gpib\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf \-\_\-gpib\-\_\-t}  {\bf gpib\-\_\-t}}}\label{gpib__hal_8h_a4791e72a1dc0caa0e23b3f4fb6aefc94}


\subsection{Function Documentation}
\hypertarget{gpib__hal_8h_a827fbebac6fd202d102386e15b92b28b}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-close@{dbf\-\_\-close}}
\index{dbf\-\_\-close@{dbf\-\_\-close}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-close}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} dbf\-\_\-close (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a827fbebac6fd202d102386e15b92b28b}


Wrapper of Fat\-Fs \hyperlink{ff_8c_a53882db20ef4323dcfd1874d7733ffc3}{f\-\_\-close()} that can display errors. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fp} & Fat\-Fs \hyperlink{structFIL}{F\-I\-L} $\ast$ pointer.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8h}{ff.\-h}. 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T dbf\-\_\-close (F\-I\-L$\ast$ fp) 
\end{DoxyReturn}


Definition at line 296 of file gpib\-\_\-hal.\-c.



Referenced by dbf\-\_\-open\-\_\-read(), dbf\-\_\-open\-\_\-write(), Fat\-Fs\-\_\-\-Read\-\_\-\-Config(), and gpib\-\_\-format\-\_\-disk().

\hypertarget{gpib__hal_8h_afd7a928788776071dc461e7d99d9f506}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-lseek@{dbf\-\_\-lseek}}
\index{dbf\-\_\-lseek@{dbf\-\_\-lseek}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-lseek}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} dbf\-\_\-lseek (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{{\bf D\-W\-O\-R\-D}}]{ofs}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_afd7a928788776071dc461e7d99d9f506}


Wrapper of Fat\-Fs f\-\_\-seek() that can display errors. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fp} & Fat\-Fs \hyperlink{structFIL}{F\-I\-L} $\ast$ pointer. \\
\hline
\mbox{\tt in}  & {\em ofs} & seek offset.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8h}{ff.\-h}. 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T 
\end{DoxyReturn}


Definition at line 275 of file gpib\-\_\-hal.\-c.



Referenced by dbf\-\_\-open\-\_\-read(), dbf\-\_\-open\-\_\-write(), and gpib\-\_\-format\-\_\-disk().

\hypertarget{gpib__hal_8h_a7d75cde9e0af3c75dce17919bdf7fe3e}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-open@{dbf\-\_\-open}}
\index{dbf\-\_\-open@{dbf\-\_\-open}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-open}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} dbf\-\_\-open (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{const {\bf T\-C\-H\-A\-R} $\ast$}]{path, }
\item[{{\bf B\-Y\-T\-E}}]{mode}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a7d75cde9e0af3c75dce17919bdf7fe3e}


Wrapper for Fat\-Fs \hyperlink{ff_8c_aefdef7126128d99d0b3bd82c28e54d80}{f\-\_\-open()} that can displays errors. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fp} & Fat\-Fs \hyperlink{structFIL}{F\-I\-L} handle \\
\hline
\mbox{\tt in}  & {\em path} & path name of file to open \\
\hline
\mbox{\tt in}  & {\em mode} & Fat\-Fs open mode flags\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8h}{ff.\-h}
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T f\-\_\-open(fp,path, mode); 
\end{DoxyReturn}


Definition at line 204 of file gpib\-\_\-hal.\-c.



Referenced by dbf\-\_\-open\-\_\-read(), dbf\-\_\-open\-\_\-write(), Fat\-Fs\-\_\-\-Read\-\_\-\-Config(), and gpib\-\_\-format\-\_\-disk().

\hypertarget{gpib__hal_8h_af60274390be1b899ca94740dba5931df}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-open\-\_\-read@{dbf\-\_\-open\-\_\-read}}
\index{dbf\-\_\-open\-\_\-read@{dbf\-\_\-open\-\_\-read}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-open\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}int dbf\-\_\-open\-\_\-read (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name, }
\item[{uint32\-\_\-t}]{pos, }
\item[{void $\ast$}]{buff, }
\item[{int}]{size, }
\item[{int $\ast$}]{errors}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_af60274390be1b899ca94740dba5931df}


Open, Seek, Read data and Close Fat\-Fs functions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & File name to open. \\
\hline
\mbox{\tt in}  & {\em pos} & file offset. \\
\hline
\mbox{\tt out}  & {\em buff} & buffer to read data into. \\
\hline
\mbox{\tt in}  & {\em size} & bytes to read. \\
\hline
\mbox{\tt in}  & {\em errors} & error flags pointer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bytes actually read. 

-\/1 on error. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See Also}
\-: \hyperlink{ff_8h}{ff.\-h}. 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T 
\end{DoxyReturn}
S\-E\-E\-K 

Definition at line 323 of file gpib\-\_\-hal.\-c.



Referenced by amigo\-\_\-buffered\-\_\-read(), amigo\-\_\-verify(), and S\-S80\-\_\-locate\-\_\-and\-\_\-read().

\hypertarget{gpib__hal_8h_a9a6e6853672fd6150839e79ee4e857af}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-open\-\_\-write@{dbf\-\_\-open\-\_\-write}}
\index{dbf\-\_\-open\-\_\-write@{dbf\-\_\-open\-\_\-write}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-open\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}int dbf\-\_\-open\-\_\-write (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name, }
\item[{uint32\-\_\-t}]{pos, }
\item[{void $\ast$}]{buff, }
\item[{int}]{size, }
\item[{int $\ast$}]{errors}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a9a6e6853672fd6150839e79ee4e857af}


Open, Seek, Write data and Close Fat\-Fs functions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & File name to open. \\
\hline
\mbox{\tt in}  & {\em pos} & file offset. \\
\hline
\mbox{\tt in}  & {\em buff} & buffer to write. \\
\hline
\mbox{\tt in}  & {\em size} & bytes to write. \\
\hline
\mbox{\tt in}  & {\em errors} & error flags pointer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bytes actually written. 

-\/1 on error. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See Also}
\-: \hyperlink{ff_8h}{ff.\-h}. 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T 
\end{DoxyReturn}
S\-E\-E\-K 

Definition at line 381 of file gpib\-\_\-hal.\-c.



Referenced by amigo\-\_\-buffered\-\_\-write(), amigo\-\_\-format(), and S\-S80\-\_\-locate\-\_\-and\-\_\-write().

\hypertarget{gpib__hal_8h_a2303ee350c0d266ac87a2135936cb727}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-read@{dbf\-\_\-read}}
\index{dbf\-\_\-read@{dbf\-\_\-read}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} dbf\-\_\-read (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{void $\ast$}]{buff, }
\item[{{\bf U\-I\-N\-T}}]{btr, }
\item[{{\bf U\-I\-N\-T} $\ast$}]{br}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a2303ee350c0d266ac87a2135936cb727}


Wrapper for Fat\-Fs \hyperlink{ff_8c_ac4c3dcb6869ca252888eebabe39727b3}{f\-\_\-read()} that can display errors. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fp} & Fat\-Fs \hyperlink{structFIL}{F\-I\-L} handle. \\
\hline
\mbox{\tt in}  & {\em buff} & buffer to read data into. \\
\hline
\mbox{\tt in}  & {\em btr} & bytes to read. \\
\hline
\mbox{\tt in}  & {\em br} & bytes actually read.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8h}{ff.\-h}
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T f\-\_\-read (F\-I\-L$\ast$ fp, void$\ast$ buff, U\-I\-N\-T btr, U\-I\-N\-T$\ast$ br) 
\end{DoxyReturn}


Definition at line 229 of file gpib\-\_\-hal.\-c.



Referenced by dbf\-\_\-open\-\_\-read(), and gpib\-\_\-format\-\_\-disk().

\hypertarget{gpib__hal_8h_a14af877aeb5d346730aaabba033695bf}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!dbf\-\_\-write@{dbf\-\_\-write}}
\index{dbf\-\_\-write@{dbf\-\_\-write}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{dbf\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}{\bf F\-R\-E\-S\-U\-L\-T} dbf\-\_\-write (
\begin{DoxyParamCaption}
\item[{{\bf F\-I\-L} $\ast$}]{fp, }
\item[{const void $\ast$}]{buff, }
\item[{{\bf U\-I\-N\-T}}]{btw, }
\item[{{\bf U\-I\-N\-T} $\ast$}]{bw}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a14af877aeb5d346730aaabba033695bf}


wrapper for Fat\-Fs \hyperlink{ff_8c_ae6a4dfae8a9e308bdb2283a37ef680f2}{f\-\_\-write()} that can display errors. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fp} & Fat\-Fs \hyperlink{structFIL}{F\-I\-L} handle. \\
\hline
\mbox{\tt in}  & {\em buff} & buffer to write data from. \\
\hline
\mbox{\tt in}  & {\em btw} & bytes to write. \\
\hline
\mbox{\tt in}  & {\em bw} & bytes actually written.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See Also}
\hyperlink{ff_8h}{ff.\-h} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
F\-R\-E\-S\-U\-L\-T f\-\_\-write (F\-I\-L$\ast$ fp, void$\ast$ buff, U\-I\-N\-T btw, U\-I\-N\-T$\ast$ bw) 
\end{DoxyReturn}


Definition at line 253 of file gpib\-\_\-hal.\-c.



Referenced by dbf\-\_\-open\-\_\-write(), and gpib\-\_\-format\-\_\-disk().

\hypertarget{gpib__hal_8h_a9b6c518118134f3eb680bf927e93c836}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!gpib\-\_\-clock\-\_\-task@{gpib\-\_\-clock\-\_\-task}}
\index{gpib\-\_\-clock\-\_\-task@{gpib\-\_\-clock\-\_\-task}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{gpib\-\_\-clock\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}void gpib\-\_\-clock\-\_\-task (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a9b6c518118134f3eb680bf927e93c836}
\hypertarget{gpib__hal_8h_acd3a9c6b7893afed15717f7ed85fc185}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!gpib\-\_\-timer\-\_\-init@{gpib\-\_\-timer\-\_\-init}}
\index{gpib\-\_\-timer\-\_\-init@{gpib\-\_\-timer\-\_\-init}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{gpib\-\_\-timer\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void gpib\-\_\-timer\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_acd3a9c6b7893afed15717f7ed85fc185}


Install G\-P\-I\-B timers, Elapsed time and Timeout tasks. 

Notes\-: \char`\"{}\-E\-O\-I\char`\"{} gets convereted into the required D\-D\-R and B\-I\-T definitions. We use the comma operator to return the P\-I\-N test. We do not use \{\} around the statements so they behave like functions. Consider what would happen if you used breaces (should be obviious) if ( G\-P\-I\-B\-\_\-\-I\-O\-\_\-\-R\-D(\-E\-O\-I) ) \{ printf\char`\"{}\-E\-O\-I\char`\"{}); \} else \{ do stuff \} Notes about A\-V\-R and P\-I\-C differences Your C\-P\-U mave have other differences A\-V\-R P\-I\-C D\-D\-R 1=out, 0 =in T\-R\-I\-S 0=out,1=in P\-O\-R\-T=val same as L\-A\-T\-C\-H=val P\-O\-R\-T=val same as L\-A\-T\-C\-H=val val=P\-O\-R\-T, reads L\-A\-T\-C\-H val=P\-O\-R\-T reads P\-I\-N state val=P\-I\-N, reads P\-I\-N state val=L\-A\-T\-C\-H reads latch


\begin{DoxyItemize}
\item Has some platform dependent code. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 26 of file gpib\-\_\-hal.\-c.



Referenced by main().

\hypertarget{gpib__hal_8h_af29c709ec1aeedc42ff180662636d8c6}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!ppr\-\_\-bit\-\_\-clr@{ppr\-\_\-bit\-\_\-clr}}
\index{ppr\-\_\-bit\-\_\-clr@{ppr\-\_\-bit\-\_\-clr}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{ppr\-\_\-bit\-\_\-clr}]{\setlength{\rightskip}{0pt plus 5cm}void ppr\-\_\-bit\-\_\-clr (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{bit}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_af29c709ec1aeedc42ff180662636d8c6}


Disbale hardware P\-P\-R response for a given device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bit} & P\-P\-R bit to disable.
\begin{DoxyItemize}
\item H\-I = P\-P\-R bus L\-O\-W.
\item L\-O\-W = P\-P\-R bus F\-L\-O\-A\-T.
\item Device P\-P\-R bits are specified in reversed order in G\-P\-I\-B.
\item 0 controlls G\-P\-I\-B D8.
\item 1 controlls G\-P\-I\-B D7.
\item 2 controlls G\-P\-I\-B D6.
\item 3 controlls G\-P\-I\-B D5. 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 187 of file gpib\-\_\-hal.\-c.



Referenced by Disable\-P\-P\-R(), and gpib\-\_\-tests().

\hypertarget{gpib__hal_8h_a4ab95314499ea3d42ead5229bfbc2b27}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!ppr\-\_\-bit\-\_\-set@{ppr\-\_\-bit\-\_\-set}}
\index{ppr\-\_\-bit\-\_\-set@{ppr\-\_\-bit\-\_\-set}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{ppr\-\_\-bit\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}void ppr\-\_\-bit\-\_\-set (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{bit}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a4ab95314499ea3d42ead5229bfbc2b27}


Enable hardware P\-P\-R response for a given device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bit} & P\-P\-R bit to enable.
\begin{DoxyItemize}
\item H\-I = P\-P\-R bus L\-O\-W.
\item L\-O\-W = P\-P\-R bus F\-L\-O\-A\-T.
\item Device P\-P\-R bits are specified in reversed order in G\-P\-I\-B.
\item 0 controlls G\-P\-I\-B D8.
\item 1 controlls G\-P\-I\-B D7.
\item 2 controlls G\-P\-I\-B D6.
\item 3 controlls G\-P\-I\-B D5.
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 168 of file gpib\-\_\-hal.\-c.



Referenced by Enable\-P\-P\-R(), and gpib\-\_\-tests().

\hypertarget{gpib__hal_8h_a9198a0ec473e147423887e68bb9f267d}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!ppr\-\_\-init@{ppr\-\_\-init}}
\index{ppr\-\_\-init@{ppr\-\_\-init}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{ppr\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void ppr\-\_\-init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a9198a0ec473e147423887e68bb9f267d}


Reset P\-P\-R enable register -\/ all disable.. 


\begin{DoxyItemize}
\item Hides the register access implimentation from the upper level. \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 149 of file gpib\-\_\-hal.\-c.



Referenced by gpib\-\_\-state\-\_\-init(), and gpib\-\_\-tests().

\hypertarget{gpib__hal_8h_a57653cc4c2dc251f12d5cc5b1bf7b754}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!ppr\-\_\-reg@{ppr\-\_\-reg}}
\index{ppr\-\_\-reg@{ppr\-\_\-reg}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{ppr\-\_\-reg}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t ppr\-\_\-reg (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a57653cc4c2dc251f12d5cc5b1bf7b754}


Return P\-P\-R enable register. 


\begin{DoxyItemize}
\item Hides the register access implimentation from the upper level. \begin{DoxyReturn}{Returns}
P\-P\-R enable register 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 138 of file gpib\-\_\-hal.\-c.



Referenced by Disable\-P\-P\-R(), Enable\-P\-P\-R(), and Parallel\-\_\-\-Poll().

\hypertarget{gpib__hal_8h_a62ab33e5f2d926916ee673ddcb8e9410}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!ppr\-\_\-set@{ppr\-\_\-set}}
\index{ppr\-\_\-set@{ppr\-\_\-set}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{ppr\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}void ppr\-\_\-set (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{mask}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a62ab33e5f2d926916ee673ddcb8e9410}


Enable or Disable Parallel Poll Response bits -\/ P\-P\-R. 


\begin{DoxyItemize}
\item The hardware implimentation does reversal automatically.
\item The software implimentation must have the bits reversed.
\item Aside\-: Software P\-P\-R is impractical -\/ timing is sub microsecond.
\item Mask Bits.
\begin{DoxyItemize}
\item H\-I = P\-P\-R bus L\-O\-W.
\item L\-O\-W = P\-P\-R bus F\-L\-O\-A\-T.
\item Device P\-P\-R bits are specified in reversed order in G\-P\-I\-B.
\item 0 controlls G\-P\-I\-B D8.
\item 1 controlls G\-P\-I\-B D7.
\item 2 controlls G\-P\-I\-B D6.
\item 3 controlls G\-P\-I\-B D5.
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mask} & Parallel Poll Response bits to enable or disable\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 86 of file gpib\-\_\-hal.\-c.



Referenced by gpib\-\_\-tests(), ppr\-\_\-bit\-\_\-clr(), ppr\-\_\-bit\-\_\-set(), and ppr\-\_\-init().

\hypertarget{gpib__hal_8h_aaff7ca1ff8eb6c387fe41ce530fe0eb8}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!reverse\-\_\-8bits@{reverse\-\_\-8bits}}
\index{reverse\-\_\-8bits@{reverse\-\_\-8bits}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{reverse\-\_\-8bits}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t reverse\-\_\-8bits (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{mask}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_aaff7ca1ff8eb6c387fe41ce530fe0eb8}


Reverse the bits in an 8 bit value. 


\begin{DoxyItemize}
\item G\-P\-I\-B Parallel poll response bits are reversed.
\item G\-P\-I\-B D8 controls first device.
\item G\-P\-I\-B D1 controls last device.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mask} & bit mask to reverse. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
reversed bits 
\end{DoxyReturn}


Definition at line 52 of file gpib\-\_\-hal.\-c.



Referenced by ppr\-\_\-set().

\hypertarget{gpib__hal_8h_a8772af94e84d58285c52be53679bfbb2}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!soft\-\_\-ppr\-\_\-assert@{soft\-\_\-ppr\-\_\-assert}}
\index{soft\-\_\-ppr\-\_\-assert@{soft\-\_\-ppr\-\_\-assert}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{soft\-\_\-ppr\-\_\-assert}]{\setlength{\rightskip}{0pt plus 5cm}void soft\-\_\-ppr\-\_\-assert (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a8772af94e84d58285c52be53679bfbb2}


Referenced by Parallel\-\_\-\-Poll().

\hypertarget{gpib__hal_8h_a2065b4c9ff1a1c90a90779fc31870511}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!soft\-\_\-ppr\-\_\-restore@{soft\-\_\-ppr\-\_\-restore}}
\index{soft\-\_\-ppr\-\_\-restore@{soft\-\_\-ppr\-\_\-restore}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{soft\-\_\-ppr\-\_\-restore}]{\setlength{\rightskip}{0pt plus 5cm}void soft\-\_\-ppr\-\_\-restore (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{gpib__hal_8h_a2065b4c9ff1a1c90a90779fc31870511}


Referenced by Parallel\-\_\-\-Poll().



\subsection{Variable Documentation}
\hypertarget{gpib__hal_8h_aced56ceaa5d240d5554a33f88596f87a}{\index{gpib\-\_\-hal.\-h@{gpib\-\_\-hal.\-h}!gpib\-\_\-timer@{gpib\-\_\-timer}}
\index{gpib\-\_\-timer@{gpib\-\_\-timer}!gpib_hal.h@{gpib\-\_\-hal.\-h}}
\subsubsection[{gpib\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf gpib\-\_\-t} gpib\-\_\-timer}}\label{gpib__hal_8h_aced56ceaa5d240d5554a33f88596f87a}


Definition at line 19 of file gpib\-\_\-hal.\-c.



Referenced by gpib\-\_\-timeout\-\_\-set(), gpib\-\_\-timeout\-\_\-test(), gpib\-\_\-timer\-\_\-elapsed\-\_\-begin(), gpib\-\_\-timer\-\_\-elapsed\-\_\-end(), gpib\-\_\-timer\-\_\-reset(), and gpib\-\_\-timer\-\_\-task().

