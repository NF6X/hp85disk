\hypertarget{rs232_8h}{}\section{hardware/rs232.h File Reference}
\label{rs232_8h}\index{hardware/rs232.\+h@{hardware/rs232.\+h}}


R\+S232 Driver A\+V\+R8.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct__uart}{\+\_\+uart}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE}~80
\item 
\#define \hyperlink{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW}~20
\item 
\#define \hyperlink{rs232_8h_a53fcdd70e498c7be83606115582640fd}{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW}~1
\item 
\#define \hyperlink{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}{X\+O\+N\+\_\+\+C\+H\+AR}~0x11
\item 
\#define \hyperlink{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}{X\+O\+F\+F\+\_\+\+C\+H\+AR}~0x13
\item 
\#define \hyperlink{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE}~4
\item 
\#define \hyperlink{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}{X\+O\+F\+F\+\_\+\+P\+UT}~2
\item 
\#define \hyperlink{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}{X\+O\+F\+F\+\_\+\+G\+ET}~1
\item 
\#define \hyperlink{rs232_8h_a14061d90f6727665218418b15943af7f}{U\+A\+R\+TS}~1
\item 
\#define \hyperlink{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}{kbhit}(uart)~\hyperlink{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count}( uart )
\item 
\#define \hyperlink{rs232_8h_a2be774878148befdb085b93380cba587}{uart\+\_\+putc}(a,  c)~\hyperlink{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{uart0\+\_\+putchar}(c,\hyperlink{user__config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{rs232_8h_ab823b4d83752db47c0852bfa36a59036}{uart\+\_\+rx\+\_\+flush} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Flush receive ring buffer for specified uart. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}{uart0\+\_\+getchar} (void $\ast$f)
\begin{DoxyCompactList}\small\item\em U\+A\+RT receive character function using avr-\/libc. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{uart0\+\_\+putchar} (int c, void $\ast$f)
\begin{DoxyCompactList}\small\item\em U\+A\+RT transmit character function using avr-\/libc. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{rs232_8h_acf0f1788a444afef4ccd7c614429df05}{uart\+\_\+ubr} (uint32\+\_\+t baud, int $\ast$u2x, uint32\+\_\+t $\ast$actual)
\begin{DoxyCompactList}\small\item\em U\+A\+RT baud rate caluculation We compute the best values of baud rate register and prescale. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}{uart\+\_\+init} (uint8\+\_\+t uart, uint32\+\_\+t baud)
\begin{DoxyCompactList}\small\item\em U\+A\+RT initialization function that works with avr-\/libc functions. \end{DoxyCompactList}\item 
void \hyperlink{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}{uart\+\_\+rx\+\_\+interrupt} (uint8\+\_\+t uart, uint8\+\_\+t data)
\begin{DoxyCompactList}\small\item\em U\+A\+RT Receive Interrupt task. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}{uart\+\_\+peek\+\_\+tail} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Return character waiting in ring buffer without removing it. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a608ab716311f6b7d674356ec38307593}{uart\+\_\+get\+\_\+tail} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Return next character from ring buffer. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em return count of character count waiting in U\+A\+RT ring buffer. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}{uart\+\_\+rx\+\_\+byte} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Recive character character from uart. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a9364291206d77b83c180ff6832e61c9b}{uart\+\_\+getchar} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Receive character from uart with option C\+R/\+LF conversion. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a3c1200094b998cbb987f545257aaa355}{uart\+\_\+tx\+\_\+byte} (int c, uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Transmit 1 byte on uart. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a4f688360d609d955f8bd6fd629872e80}{uart\+\_\+putchar} (int c, int uart)
\begin{DoxyCompactList}\small\item\em Transmit 1 byte on uart. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a94d11755189c23a221fc8819d326289c}{uart\+\_\+keyhit} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Do we have receive characters waiting ?. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}{uart\+\_\+put} (int c)
\begin{DoxyCompactList}\small\item\em Transmit a character on U\+A\+RT 0. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a0f8facdf08ca026788fdd919aacee502}{uart\+\_\+get} (void)
\begin{DoxyCompactList}\small\item\em Receive a character from U\+A\+RT 0. \end{DoxyCompactList}\item 
int \hyperlink{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}{get\+\_\+line} (char $\ast$buff, int len)
\begin{DoxyCompactList}\small\item\em Get a line from U\+A\+RT 0 up to a maximum of len bytes. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
R\+S232 Driver A\+V\+R8. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2017 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Macro Definition Documentation}
\index{rs232.\+h@{rs232.\+h}!kbhit@{kbhit}}
\index{kbhit@{kbhit}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{kbhit}{kbhit}}]{\setlength{\rightskip}{0pt plus 5cm}\#define kbhit(
\begin{DoxyParamCaption}
\item[{}]{uart}
\end{DoxyParamCaption}
)~{\bf uart\+\_\+rx\+\_\+count}( uart )}\hypertarget{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}{}\label{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}


Definition at line 45 of file rs232.\+h.



Referenced by task(), and testpage().

\index{rs232.\+h@{rs232.\+h}!R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE@{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE}}
\index{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE@{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE}{RX_BUF_SIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE~80}\hypertarget{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}{}\label{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}


Definition at line 18 of file rs232.\+h.



Referenced by uart\+\_\+get\+\_\+tail(), and uart\+\_\+rx\+\_\+interrupt().

\index{rs232.\+h@{rs232.\+h}!R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW@{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW}}
\index{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW@{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW}{RX_FLOW_WINDOW}}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW~20}\hypertarget{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}{}\label{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}


Definition at line 19 of file rs232.\+h.

\index{rs232.\+h@{rs232.\+h}!R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW@{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW}}
\index{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW@{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW}{RX_OVERFLOW}}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW~1}\hypertarget{rs232_8h_a53fcdd70e498c7be83606115582640fd}{}\label{rs232_8h_a53fcdd70e498c7be83606115582640fd}


Definition at line 21 of file rs232.\+h.



Referenced by uart\+\_\+rx\+\_\+interrupt().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+putc@{uart\+\_\+putc}}
\index{uart\+\_\+putc@{uart\+\_\+putc}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+putc}{uart_putc}}]{\setlength{\rightskip}{0pt plus 5cm}\#define uart\+\_\+putc(
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{c}
\end{DoxyParamCaption}
)~{\bf uart0\+\_\+putchar}(c,{\bf N\+U\+LL})}\hypertarget{rs232_8h_a2be774878148befdb085b93380cba587}{}\label{rs232_8h_a2be774878148befdb085b93380cba587}


Definition at line 47 of file rs232.\+h.



Referenced by fatfs\+\_\+ls().

\index{rs232.\+h@{rs232.\+h}!U\+A\+R\+TS@{U\+A\+R\+TS}}
\index{U\+A\+R\+TS@{U\+A\+R\+TS}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{U\+A\+R\+TS}{UARTS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define U\+A\+R\+TS~1}\hypertarget{rs232_8h_a14061d90f6727665218418b15943af7f}{}\label{rs232_8h_a14061d90f6727665218418b15943af7f}


Definition at line 44 of file rs232.\+h.



Referenced by uart\+\_\+get\+\_\+tail(), uart\+\_\+getchar(), uart\+\_\+init(), uart\+\_\+peek\+\_\+tail(), uart\+\_\+rx\+\_\+count(), and uart\+\_\+rx\+\_\+flush().

\index{rs232.\+h@{rs232.\+h}!X\+O\+F\+F\+\_\+\+C\+H\+AR@{X\+O\+F\+F\+\_\+\+C\+H\+AR}}
\index{X\+O\+F\+F\+\_\+\+C\+H\+AR@{X\+O\+F\+F\+\_\+\+C\+H\+AR}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{X\+O\+F\+F\+\_\+\+C\+H\+AR}{XOFF_CHAR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+O\+F\+F\+\_\+\+C\+H\+AR~0x13}\hypertarget{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}{}\label{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}


Definition at line 24 of file rs232.\+h.

\index{rs232.\+h@{rs232.\+h}!X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE@{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE}}
\index{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE@{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE}{XOFF_ENABLE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE~4}\hypertarget{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}{}\label{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}


Definition at line 26 of file rs232.\+h.

\index{rs232.\+h@{rs232.\+h}!X\+O\+F\+F\+\_\+\+G\+ET@{X\+O\+F\+F\+\_\+\+G\+ET}}
\index{X\+O\+F\+F\+\_\+\+G\+ET@{X\+O\+F\+F\+\_\+\+G\+ET}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{X\+O\+F\+F\+\_\+\+G\+ET}{XOFF_GET}}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+O\+F\+F\+\_\+\+G\+ET~1}\hypertarget{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}{}\label{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}


Definition at line 28 of file rs232.\+h.

\index{rs232.\+h@{rs232.\+h}!X\+O\+F\+F\+\_\+\+P\+UT@{X\+O\+F\+F\+\_\+\+P\+UT}}
\index{X\+O\+F\+F\+\_\+\+P\+UT@{X\+O\+F\+F\+\_\+\+P\+UT}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{X\+O\+F\+F\+\_\+\+P\+UT}{XOFF_PUT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+O\+F\+F\+\_\+\+P\+UT~2}\hypertarget{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}{}\label{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}


Definition at line 27 of file rs232.\+h.

\index{rs232.\+h@{rs232.\+h}!X\+O\+N\+\_\+\+C\+H\+AR@{X\+O\+N\+\_\+\+C\+H\+AR}}
\index{X\+O\+N\+\_\+\+C\+H\+AR@{X\+O\+N\+\_\+\+C\+H\+AR}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{X\+O\+N\+\_\+\+C\+H\+AR}{XON_CHAR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define X\+O\+N\+\_\+\+C\+H\+AR~0x11}\hypertarget{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}{}\label{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}


Definition at line 23 of file rs232.\+h.



\subsection{Function Documentation}
\index{rs232.\+h@{rs232.\+h}!get\+\_\+line@{get\+\_\+line}}
\index{get\+\_\+line@{get\+\_\+line}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{get\+\_\+line(char $\ast$buff, int len)}{get_line(char *buff, int len)}}]{\setlength{\rightskip}{0pt plus 5cm}int get\+\_\+line (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{buff, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}{}\label{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}


Get a line from U\+A\+RT 0 up to a maximum of len bytes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buff} & line input buffer \\
\hline
\mbox{\tt in}  & {\em len} & line length maximum \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 412 of file rs232.\+c.

\index{rs232.\+h@{rs232.\+h}!uart0\+\_\+getchar@{uart0\+\_\+getchar}}
\index{uart0\+\_\+getchar@{uart0\+\_\+getchar}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart0\+\_\+getchar(void $\ast$f)}{uart0_getchar(void *f)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart0\+\_\+getchar (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{f}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}{}\label{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}


U\+A\+RT receive character function using avr-\/libc. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em f} & unused F\+I\+LE $\ast$stream pointer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uart\+\_\+getchar(0);. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()} from avr-\/libc. 
\end{DoxySeeAlso}


Definition at line 45 of file rs232.\+c.



Referenced by uart\+\_\+get(), and uart\+\_\+init().

\index{rs232.\+h@{rs232.\+h}!uart0\+\_\+putchar@{uart0\+\_\+putchar}}
\index{uart0\+\_\+putchar@{uart0\+\_\+putchar}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart0\+\_\+putchar(int c, void $\ast$f)}{uart0_putchar(int c, void *f)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart0\+\_\+putchar (
\begin{DoxyParamCaption}
\item[{int}]{c, }
\item[{void $\ast$}]{f}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{}\label{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}


U\+A\+RT transmit character function using avr-\/libc. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em c} & character to send. \\
\hline
\mbox{\tt in}  & {\em f} & unused F\+I\+LE $\ast$stream pointer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uart\+\_\+putchar(c, 0);. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()} from avr-\/libc. 
\end{DoxySeeAlso}


Definition at line 57 of file rs232.\+c.



Referenced by uart\+\_\+init(), and uart\+\_\+put().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+get@{uart\+\_\+get}}
\index{uart\+\_\+get@{uart\+\_\+get}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+get(void)}{uart_get(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+get (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a0f8facdf08ca026788fdd919aacee502}{}\label{rs232_8h_a0f8facdf08ca026788fdd919aacee502}


Receive a character from U\+A\+RT 0. 

\begin{DoxyReturn}{Returns}
character 
\end{DoxyReturn}


Definition at line 402 of file rs232.\+c.



Referenced by get\+\_\+line().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+get\+\_\+tail@{uart\+\_\+get\+\_\+tail}}
\index{uart\+\_\+get\+\_\+tail@{uart\+\_\+get\+\_\+tail}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+get\+\_\+tail(uint8\+\_\+t uart)}{uart_get_tail(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+get\+\_\+tail (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a608ab716311f6b7d674356ec38307593}{}\label{rs232_8h_a608ab716311f6b7d674356ec38307593}


Return next character from ring buffer. 


\begin{DoxyItemize}
\item Wait for at least one character.
\item Update index pointers and character count.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number to read. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
character. 

0 on error. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{rs232_8c_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count()}. 
\end{DoxySeeAlso}


Definition at line 247 of file rs232.\+c.



Referenced by uart\+\_\+rx\+\_\+byte().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+getchar@{uart\+\_\+getchar}}
\index{uart\+\_\+getchar@{uart\+\_\+getchar}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+getchar(uint8\+\_\+t uart)}{uart_getchar(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+getchar (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a9364291206d77b83c180ff6832e61c9b}{}\label{rs232_8h_a9364291206d77b83c180ff6832e61c9b}


Receive character from uart with option C\+R/\+LF conversion. 


\begin{DoxyItemize}
\item C\+R/\+LF processing is disabled at the moment.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character. 
\end{DoxyReturn}


Definition at line 306 of file rs232.\+c.



Referenced by uart0\+\_\+getchar().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+init@{uart\+\_\+init}}
\index{uart\+\_\+init@{uart\+\_\+init}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+init(uint8\+\_\+t uart, uint32\+\_\+t baud)}{uart_init(uint8_t uart, uint32_t baud)}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t uart\+\_\+init (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart, }
\item[{uint32\+\_\+t}]{baud}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}{}\label{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}


U\+A\+RT initialization function that works with avr-\/libc functions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & U\+A\+RT number. \\
\hline
\mbox{\tt in}  & {\em baud} & Baud Rate in HZ.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
actual baud rate, closest we could get with register settings 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()} avr-\/libc function that attaches uart functions to \hyperlink{posix_8h_ab38efc888190556f106cafb08d17d16f}{getchar} and \hyperlink{posix_8h_ac9195b3de02e450cfdeea1ce97b32da4}{putchar} \hyperlink{posix_8h_a1c3d85ae80df5590fa314acffd8bf840}{P\+O\+S\+IX} functions. 
\end{DoxySeeAlso}
actual baud rate 

Definition at line 115 of file rs232.\+c.



Referenced by main().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+keyhit@{uart\+\_\+keyhit}}
\index{uart\+\_\+keyhit@{uart\+\_\+keyhit}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+keyhit(uint8\+\_\+t uart)}{uart_keyhit(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+keyhit (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a94d11755189c23a221fc8819d326289c}{}\label{rs232_8h_a94d11755189c23a221fc8819d326289c}


Do we have receive characters waiting ?. 


\begin{DoxyItemize}
\item Returns non zero if there are any caracters.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character count in receive buffer. 
\end{DoxyReturn}


Definition at line 386 of file rs232.\+c.



Referenced by controller\+\_\+read\+\_\+trace(), gpib\+\_\+detect\+\_\+\+P\+P(), gpib\+\_\+error\+\_\+test(), gpib\+\_\+read\+\_\+byte(), gpib\+\_\+trace\+\_\+task(), gpib\+\_\+write\+\_\+byte(), and plot\+\_\+echo().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+peek\+\_\+tail@{uart\+\_\+peek\+\_\+tail}}
\index{uart\+\_\+peek\+\_\+tail@{uart\+\_\+peek\+\_\+tail}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+peek\+\_\+tail(uint8\+\_\+t uart)}{uart_peek_tail(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+peek\+\_\+tail (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}{}\label{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}


Return character waiting in ring buffer without removing it. 

\begin{DoxyReturn}{Returns}
character. 

0 on error. 
\end{DoxyReturn}


Definition at line 225 of file rs232.\+c.

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+put@{uart\+\_\+put}}
\index{uart\+\_\+put@{uart\+\_\+put}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+put(int c)}{uart_put(int c)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+put (
\begin{DoxyParamCaption}
\item[{int}]{c}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}{}\label{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}


Transmit a character on U\+A\+RT 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em c} & character to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 395 of file rs232.\+c.



Referenced by get\+\_\+line().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+putchar@{uart\+\_\+putchar}}
\index{uart\+\_\+putchar@{uart\+\_\+putchar}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+putchar(int c, int uart)}{uart_putchar(int c, int uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+putchar (
\begin{DoxyParamCaption}
\item[{int}]{c, }
\item[{int}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a4f688360d609d955f8bd6fd629872e80}{}\label{rs232_8h_a4f688360d609d955f8bd6fd629872e80}


Transmit 1 byte on uart. 


\begin{DoxyItemize}
\item C\+R/\+LF Output translation. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em c} & transmit character. \\
\hline
\mbox{\tt in}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 370 of file rs232.\+c.



Referenced by uart0\+\_\+putchar().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+rx\+\_\+byte@{uart\+\_\+rx\+\_\+byte}}
\index{uart\+\_\+rx\+\_\+byte@{uart\+\_\+rx\+\_\+byte}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+rx\+\_\+byte(uint8\+\_\+t uart)}{uart_rx_byte(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+rx\+\_\+byte (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}{}\label{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}


Recive character character from uart. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character. 
\end{DoxyReturn}


Definition at line 293 of file rs232.\+c.



Referenced by plot\+\_\+echo(), and uart\+\_\+getchar().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+rx\+\_\+count@{uart\+\_\+rx\+\_\+count}}
\index{uart\+\_\+rx\+\_\+count@{uart\+\_\+rx\+\_\+count}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+rx\+\_\+count(uint8\+\_\+t uart)}{uart_rx_count(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+rx\+\_\+count (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{}\label{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}


return count of character count waiting in U\+A\+RT ring buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number to check count for.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character count in ring buffer. 
\end{DoxyReturn}


Definition at line 271 of file rs232.\+c.



Referenced by uart\+\_\+get\+\_\+tail(), and uart\+\_\+keyhit().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+rx\+\_\+flush@{uart\+\_\+rx\+\_\+flush}}
\index{uart\+\_\+rx\+\_\+flush@{uart\+\_\+rx\+\_\+flush}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+rx\+\_\+flush(uint8\+\_\+t uart)}{uart_rx_flush(uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}void uart\+\_\+rx\+\_\+flush (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_ab823b4d83752db47c0852bfa36a59036}{}\label{rs232_8h_ab823b4d83752db47c0852bfa36a59036}


Flush receive ring buffer for specified uart. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 22 of file rs232.\+c.



Referenced by uart\+\_\+init().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+rx\+\_\+interrupt@{uart\+\_\+rx\+\_\+interrupt}}
\index{uart\+\_\+rx\+\_\+interrupt@{uart\+\_\+rx\+\_\+interrupt}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+rx\+\_\+interrupt(uint8\+\_\+t uart, uint8\+\_\+t data)}{uart_rx_interrupt(uint8_t uart, uint8_t data)}}]{\setlength{\rightskip}{0pt plus 5cm}void uart\+\_\+rx\+\_\+interrupt (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{uart, }
\item[{uint8\+\_\+t}]{data}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}{}\label{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}


U\+A\+RT Receive Interrupt task. 


\begin{DoxyItemize}
\item Add characters to ring receive buffer.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & uart number. \\
\hline
\mbox{\tt in}  & {\em data} & register data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 206 of file rs232.\+c.



Referenced by I\+S\+R().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+tx\+\_\+byte@{uart\+\_\+tx\+\_\+byte}}
\index{uart\+\_\+tx\+\_\+byte@{uart\+\_\+tx\+\_\+byte}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+tx\+\_\+byte(int c, uint8\+\_\+t uart)}{uart_tx_byte(int c, uint8_t uart)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+tx\+\_\+byte (
\begin{DoxyParamCaption}
\item[{int}]{c, }
\item[{uint8\+\_\+t}]{uart}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_a3c1200094b998cbb987f545257aaa355}{}\label{rs232_8h_a3c1200094b998cbb987f545257aaa355}


Transmit 1 byte on uart. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em c} & transmit character. \\
\hline
\mbox{\tt in}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 341 of file rs232.\+c.



Referenced by uart\+\_\+getchar(), and uart\+\_\+putchar().

\index{rs232.\+h@{rs232.\+h}!uart\+\_\+ubr@{uart\+\_\+ubr}}
\index{uart\+\_\+ubr@{uart\+\_\+ubr}!rs232.\+h@{rs232.\+h}}
\subsubsection[{\texorpdfstring{uart\+\_\+ubr(uint32\+\_\+t baud, int $\ast$u2x, uint32\+\_\+t $\ast$actual)}{uart_ubr(uint32_t baud, int *u2x, uint32_t *actual)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t uart\+\_\+ubr (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{baud, }
\item[{int $\ast$}]{u2x, }
\item[{uint32\+\_\+t $\ast$}]{actual}
\end{DoxyParamCaption}
)}\hypertarget{rs232_8h_acf0f1788a444afef4ccd7c614429df05}{}\label{rs232_8h_acf0f1788a444afef4ccd7c614429df05}


U\+A\+RT baud rate caluculation We compute the best values of baud rate register and prescale. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uart} & desired baud rate in HZ \\
\hline
\mbox{\tt in}  & {\em $\ast$u2x} & computed prescale 1 = divide by 8, 0 = divide by 16 \\
\hline
\mbox{\tt in}  & {\em $\ast$actual} & Actual computed baud rate, closest we could get with register settings\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
baud rate register value 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()} avr-\/libc function that attaches uart functions to \hyperlink{posix_8h_ab38efc888190556f106cafb08d17d16f}{getchar} and \hyperlink{posix_8h_ac9195b3de02e450cfdeea1ce97b32da4}{putchar} \hyperlink{posix_8h_a1c3d85ae80df5590fa314acffd8bf840}{P\+O\+S\+IX} functions. 
\end{DoxySeeAlso}
Use 8 prescale as a default

Use 16 prescale f we have a low baud rate 

Definition at line 72 of file rs232.\+c.



Referenced by uart\+\_\+init().

