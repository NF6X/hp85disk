\hypertarget{rs232_8h}{}\doxysection{hardware/rs232.h File Reference}
\label{rs232_8h}\index{hardware/rs232.h@{hardware/rs232.h}}


R\+S232 Driver A\+V\+R8.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct__uart}{\+\_\+uart}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}{R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE}}~80
\item 
\#define \mbox{\hyperlink{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}{R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW}}~20
\item 
\#define \mbox{\hyperlink{rs232_8h_a53fcdd70e498c7be83606115582640fd}{R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW}}~1
\item 
\#define \mbox{\hyperlink{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}{X\+O\+N\+\_\+\+C\+H\+AR}}~0x11
\item 
\#define \mbox{\hyperlink{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}{X\+O\+F\+F\+\_\+\+C\+H\+AR}}~0x13
\item 
\#define \mbox{\hyperlink{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}{X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE}}~4
\item 
\#define \mbox{\hyperlink{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}{X\+O\+F\+F\+\_\+\+P\+UT}}~2
\item 
\#define \mbox{\hyperlink{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}{X\+O\+F\+F\+\_\+\+G\+ET}}~1
\item 
\#define \mbox{\hyperlink{rs232_8h_a14061d90f6727665218418b15943af7f}{U\+A\+R\+TS}}~1
\item 
\#define \mbox{\hyperlink{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}{kbhit}}(uart)~\mbox{\hyperlink{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count}}( uart )
\item 
\#define \mbox{\hyperlink{rs232_8h_a2be774878148befdb085b93380cba587}{uart\+\_\+putc}}(a,  c)~\mbox{\hyperlink{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{uart0\+\_\+putchar}}(c,\mbox{\hyperlink{hardware_2user__config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}})
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{rs232_8h_ab823b4d83752db47c0852bfa36a59036}{uart\+\_\+rx\+\_\+flush}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Flush receive ring buffer for specified uart. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}{uart0\+\_\+getchar}} (void $\ast$f)
\item 
int \mbox{\hyperlink{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{uart0\+\_\+putchar}} (int c, void $\ast$f)
\item 
uint16\+\_\+t \mbox{\hyperlink{rs232_8h_acf0f1788a444afef4ccd7c614429df05}{uart\+\_\+ubr}} (uint32\+\_\+t baud, int $\ast$u2x, uint32\+\_\+t $\ast$actual)
\begin{DoxyCompactList}\small\item\em U\+A\+RT baud rate caluculation We compute the best values of baud rate register and prescale. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}{uart\+\_\+init}} (uint8\+\_\+t uart, uint32\+\_\+t baud)
\begin{DoxyCompactList}\small\item\em U\+A\+RT initialization function that works with avr-\/libc functions. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}{uart\+\_\+rx\+\_\+interrupt}} (uint8\+\_\+t uart, uint8\+\_\+t data)
\begin{DoxyCompactList}\small\item\em U\+A\+RT Receive Interrupt task. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}{uart\+\_\+peek\+\_\+tail}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Return character waiting in ring buffer without removing it. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a608ab716311f6b7d674356ec38307593}{uart\+\_\+get\+\_\+tail}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Return next character from ring buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em return count of character count waiting in U\+A\+RT ring buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}{uart\+\_\+rx\+\_\+byte}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Recive character character from uart. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a9364291206d77b83c180ff6832e61c9b}{uart\+\_\+getchar}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Receive character from uart with option C\+R/\+LF conversion. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a3c1200094b998cbb987f545257aaa355}{uart\+\_\+tx\+\_\+byte}} (int c, uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Transmit 1 byte on uart. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a4f688360d609d955f8bd6fd629872e80}{uart\+\_\+putchar}} (int c, int uart)
\begin{DoxyCompactList}\small\item\em Transmit 1 byte on uart. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a94d11755189c23a221fc8819d326289c}{uart\+\_\+keyhit}} (uint8\+\_\+t uart)
\begin{DoxyCompactList}\small\item\em Do we have receive characters waiting ?. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}{uart\+\_\+put}} (int c)
\begin{DoxyCompactList}\small\item\em Transmit a character on U\+A\+RT 0. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a0f8facdf08ca026788fdd919aacee502}{uart\+\_\+get}} (void)
\begin{DoxyCompactList}\small\item\em Receive a character from U\+A\+RT 0. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}{get\+\_\+line}} (char $\ast$buff, int len)
\begin{DoxyCompactList}\small\item\em Get a line from U\+A\+RT 0 up to a maximum of len bytes. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
R\+S232 Driver A\+V\+R8. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}\label{rs232_8h_aeddebfcb46db9f5421188decb3e21edb}} 
\index{rs232.h@{rs232.h}!kbhit@{kbhit}}
\index{kbhit@{kbhit}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{kbhit}{kbhit}}
{\footnotesize\ttfamily \#define kbhit(\begin{DoxyParamCaption}\item[{}]{uart }\end{DoxyParamCaption})~\mbox{\hyperlink{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count}}( uart )}



Definition at line 45 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}\label{rs232_8h_a690f985c933da2ce6fe62b6c61dfa662}} 
\index{rs232.h@{rs232.h}!RX\_BUF\_SIZE@{RX\_BUF\_SIZE}}
\index{RX\_BUF\_SIZE@{RX\_BUF\_SIZE}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{RX\_BUF\_SIZE}{RX\_BUF\_SIZE}}
{\footnotesize\ttfamily \#define R\+X\+\_\+\+B\+U\+F\+\_\+\+S\+I\+ZE~80}



Definition at line 18 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}\label{rs232_8h_acd5cd53e4ba6ba166c636bb3ce49ac93}} 
\index{rs232.h@{rs232.h}!RX\_FLOW\_WINDOW@{RX\_FLOW\_WINDOW}}
\index{RX\_FLOW\_WINDOW@{RX\_FLOW\_WINDOW}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{RX\_FLOW\_WINDOW}{RX\_FLOW\_WINDOW}}
{\footnotesize\ttfamily \#define R\+X\+\_\+\+F\+L\+O\+W\+\_\+\+W\+I\+N\+D\+OW~20}



Definition at line 19 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a53fcdd70e498c7be83606115582640fd}\label{rs232_8h_a53fcdd70e498c7be83606115582640fd}} 
\index{rs232.h@{rs232.h}!RX\_OVERFLOW@{RX\_OVERFLOW}}
\index{RX\_OVERFLOW@{RX\_OVERFLOW}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{RX\_OVERFLOW}{RX\_OVERFLOW}}
{\footnotesize\ttfamily \#define R\+X\+\_\+\+O\+V\+E\+R\+F\+L\+OW~1}



Definition at line 21 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a2be774878148befdb085b93380cba587}\label{rs232_8h_a2be774878148befdb085b93380cba587}} 
\index{rs232.h@{rs232.h}!uart\_putc@{uart\_putc}}
\index{uart\_putc@{uart\_putc}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_putc}{uart\_putc}}
{\footnotesize\ttfamily \#define uart\+\_\+putc(\begin{DoxyParamCaption}\item[{}]{a,  }\item[{}]{c }\end{DoxyParamCaption})~\mbox{\hyperlink{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}{uart0\+\_\+putchar}}(c,\mbox{\hyperlink{hardware_2user__config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{N\+U\+LL}})}



Definition at line 47 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a14061d90f6727665218418b15943af7f}\label{rs232_8h_a14061d90f6727665218418b15943af7f}} 
\index{rs232.h@{rs232.h}!UARTS@{UARTS}}
\index{UARTS@{UARTS}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{UARTS}{UARTS}}
{\footnotesize\ttfamily \#define U\+A\+R\+TS~1}



Definition at line 44 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}\label{rs232_8h_aa9379a9c5bc361c5c9f066290b11da58}} 
\index{rs232.h@{rs232.h}!XOFF\_CHAR@{XOFF\_CHAR}}
\index{XOFF\_CHAR@{XOFF\_CHAR}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{XOFF\_CHAR}{XOFF\_CHAR}}
{\footnotesize\ttfamily \#define X\+O\+F\+F\+\_\+\+C\+H\+AR~0x13}



Definition at line 24 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}\label{rs232_8h_a7ab06bdbe55410a658a832262569b6eb}} 
\index{rs232.h@{rs232.h}!XOFF\_ENABLE@{XOFF\_ENABLE}}
\index{XOFF\_ENABLE@{XOFF\_ENABLE}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{XOFF\_ENABLE}{XOFF\_ENABLE}}
{\footnotesize\ttfamily \#define X\+O\+F\+F\+\_\+\+E\+N\+A\+B\+LE~4}



Definition at line 26 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}\label{rs232_8h_ae5337d6a1de4c781812b21ed7cf387c2}} 
\index{rs232.h@{rs232.h}!XOFF\_GET@{XOFF\_GET}}
\index{XOFF\_GET@{XOFF\_GET}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{XOFF\_GET}{XOFF\_GET}}
{\footnotesize\ttfamily \#define X\+O\+F\+F\+\_\+\+G\+ET~1}



Definition at line 28 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}\label{rs232_8h_a866afbf96fb51f104a602e0bbb03bdcc}} 
\index{rs232.h@{rs232.h}!XOFF\_PUT@{XOFF\_PUT}}
\index{XOFF\_PUT@{XOFF\_PUT}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{XOFF\_PUT}{XOFF\_PUT}}
{\footnotesize\ttfamily \#define X\+O\+F\+F\+\_\+\+P\+UT~2}



Definition at line 27 of file rs232.\+h.

\mbox{\Hypertarget{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}\label{rs232_8h_a7d8bee9a9d7d0b05223314232799af6f}} 
\index{rs232.h@{rs232.h}!XON\_CHAR@{XON\_CHAR}}
\index{XON\_CHAR@{XON\_CHAR}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{XON\_CHAR}{XON\_CHAR}}
{\footnotesize\ttfamily \#define X\+O\+N\+\_\+\+C\+H\+AR~0x11}



Definition at line 23 of file rs232.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}\label{rs232_8h_a293b550a7aa47a2f4bbadcf1103b78e6}} 
\index{rs232.h@{rs232.h}!get\_line@{get\_line}}
\index{get\_line@{get\_line}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{get\_line()}{get\_line()}}
{\footnotesize\ttfamily int get\+\_\+line (\begin{DoxyParamCaption}\item[{char $\ast$}]{buff,  }\item[{int}]{len }\end{DoxyParamCaption})}



Get a line from U\+A\+RT 0 up to a maximum of len bytes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em buff} & line input buffer \\
\hline
\mbox{\texttt{ in}}  & {\em len} & line length maximum \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 421 of file rs232.\+c.

\mbox{\Hypertarget{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}\label{rs232_8h_a3e291aed5863354a29aea03c94cc1d5e}} 
\index{rs232.h@{rs232.h}!uart0\_getchar@{uart0\_getchar}}
\index{uart0\_getchar@{uart0\_getchar}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart0\_getchar()}{uart0\_getchar()}}
{\footnotesize\ttfamily int uart0\+\_\+getchar (\begin{DoxyParamCaption}\item[{void $\ast$}]{f }\end{DoxyParamCaption})}

\mbox{\Hypertarget{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}\label{rs232_8h_ab0bdd8f61d18809268fc58d8871a881b}} 
\index{rs232.h@{rs232.h}!uart0\_putchar@{uart0\_putchar}}
\index{uart0\_putchar@{uart0\_putchar}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart0\_putchar()}{uart0\_putchar()}}
{\footnotesize\ttfamily int uart0\+\_\+putchar (\begin{DoxyParamCaption}\item[{int}]{c,  }\item[{void $\ast$}]{f }\end{DoxyParamCaption})}

\mbox{\Hypertarget{rs232_8h_a0f8facdf08ca026788fdd919aacee502}\label{rs232_8h_a0f8facdf08ca026788fdd919aacee502}} 
\index{rs232.h@{rs232.h}!uart\_get@{uart\_get}}
\index{uart\_get@{uart\_get}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_get()}{uart\_get()}}
{\footnotesize\ttfamily int uart\+\_\+get (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Receive a character from U\+A\+RT 0. 

\begin{DoxyReturn}{Returns}
character 
\end{DoxyReturn}


Definition at line 411 of file rs232.\+c.



Referenced by get\+\_\+line().

\mbox{\Hypertarget{rs232_8h_a608ab716311f6b7d674356ec38307593}\label{rs232_8h_a608ab716311f6b7d674356ec38307593}} 
\index{rs232.h@{rs232.h}!uart\_get\_tail@{uart\_get\_tail}}
\index{uart\_get\_tail@{uart\_get\_tail}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_get\_tail()}{uart\_get\_tail()}}
{\footnotesize\ttfamily int uart\+\_\+get\+\_\+tail (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Return next character from ring buffer. 


\begin{DoxyItemize}
\item Wait for at least one character.
\item Update index pointers and character count.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number to read. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
character. 

0 on error. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{rs232_8c_a72746897c9285db2e3d50c9c38e8bb93}{uart\+\_\+rx\+\_\+count()}}. 
\end{DoxySeeAlso}


Definition at line 249 of file rs232.\+c.



Referenced by uart\+\_\+rx\+\_\+byte().

\mbox{\Hypertarget{rs232_8h_a9364291206d77b83c180ff6832e61c9b}\label{rs232_8h_a9364291206d77b83c180ff6832e61c9b}} 
\index{rs232.h@{rs232.h}!uart\_getchar@{uart\_getchar}}
\index{uart\_getchar@{uart\_getchar}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_getchar()}{uart\_getchar()}}
{\footnotesize\ttfamily int uart\+\_\+getchar (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Receive character from uart with option C\+R/\+LF conversion. 


\begin{DoxyItemize}
\item C\+R/\+LF processing is disabled at the moment.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character. 
\end{DoxyReturn}


Definition at line 312 of file rs232.\+c.



Referenced by uart0\+\_\+getchar().

\mbox{\Hypertarget{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}\label{rs232_8h_aeadb33b98af6eefa927f6d623cd5759e}} 
\index{rs232.h@{rs232.h}!uart\_init@{uart\_init}}
\index{uart\_init@{uart\_init}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_init()}{uart\_init()}}
{\footnotesize\ttfamily uint32\+\_\+t uart\+\_\+init (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart,  }\item[{uint32\+\_\+t}]{baud }\end{DoxyParamCaption})}



U\+A\+RT initialization function that works with avr-\/libc functions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & U\+A\+RT number. \\
\hline
\mbox{\texttt{ in}}  & {\em baud} & Baud Rate in HZ.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
actual baud rate, closest we could get with register settings 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()}} avr-\/libc function that attaches uart functions to \mbox{\hyperlink{posix_8h_ab38efc888190556f106cafb08d17d16f}{getchar}} and \mbox{\hyperlink{posix_8h_ac9195b3de02e450cfdeea1ce97b32da4}{putchar}} \mbox{\hyperlink{posix_8h_a1c3d85ae80df5590fa314acffd8bf840}{P\+O\+S\+IX}} functions. 
\end{DoxySeeAlso}
actual baud rate

Definition at line 117 of file rs232.\+c.



Referenced by main().

\mbox{\Hypertarget{rs232_8h_a94d11755189c23a221fc8819d326289c}\label{rs232_8h_a94d11755189c23a221fc8819d326289c}} 
\index{rs232.h@{rs232.h}!uart\_keyhit@{uart\_keyhit}}
\index{uart\_keyhit@{uart\_keyhit}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_keyhit()}{uart\_keyhit()}}
{\footnotesize\ttfamily int uart\+\_\+keyhit (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Do we have receive characters waiting ?. 


\begin{DoxyItemize}
\item Returns non zero if there are any caracters.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character count in receive buffer. 
\end{DoxyReturn}


Definition at line 394 of file rs232.\+c.



Referenced by gpib\+\_\+detect\+\_\+\+P\+P(), gpib\+\_\+error\+\_\+test(), gpib\+\_\+read\+\_\+byte(), gpib\+\_\+trace\+\_\+task(), and gpib\+\_\+write\+\_\+byte().

\mbox{\Hypertarget{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}\label{rs232_8h_a6d3c4d6b4fb921390e819f9306d4baa9}} 
\index{rs232.h@{rs232.h}!uart\_peek\_tail@{uart\_peek\_tail}}
\index{uart\_peek\_tail@{uart\_peek\_tail}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_peek\_tail()}{uart\_peek\_tail()}}
{\footnotesize\ttfamily int uart\+\_\+peek\+\_\+tail (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Return character waiting in ring buffer without removing it. 

\begin{DoxyReturn}{Returns}
character. 

0 on error. 
\end{DoxyReturn}


Definition at line 227 of file rs232.\+c.

\mbox{\Hypertarget{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}\label{rs232_8h_a19bd935cf7d05c0d5fe2a07782dff641}} 
\index{rs232.h@{rs232.h}!uart\_put@{uart\_put}}
\index{uart\_put@{uart\_put}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_put()}{uart\_put()}}
{\footnotesize\ttfamily int uart\+\_\+put (\begin{DoxyParamCaption}\item[{int}]{c }\end{DoxyParamCaption})}



Transmit a character on U\+A\+RT 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & character to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 403 of file rs232.\+c.



Referenced by get\+\_\+line().

\mbox{\Hypertarget{rs232_8h_a4f688360d609d955f8bd6fd629872e80}\label{rs232_8h_a4f688360d609d955f8bd6fd629872e80}} 
\index{rs232.h@{rs232.h}!uart\_putchar@{uart\_putchar}}
\index{uart\_putchar@{uart\_putchar}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_putchar()}{uart\_putchar()}}
{\footnotesize\ttfamily int uart\+\_\+putchar (\begin{DoxyParamCaption}\item[{int}]{c,  }\item[{int}]{uart }\end{DoxyParamCaption})}



Transmit 1 byte on uart. 


\begin{DoxyItemize}
\item C\+R/\+LF Output translation. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & transmit character. \\
\hline
\mbox{\texttt{ in}}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 376 of file rs232.\+c.



Referenced by uart0\+\_\+putchar().

\mbox{\Hypertarget{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}\label{rs232_8h_ac2daabfbed3e1679f834b158dfbbbe80}} 
\index{rs232.h@{rs232.h}!uart\_rx\_byte@{uart\_rx\_byte}}
\index{uart\_rx\_byte@{uart\_rx\_byte}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_rx\_byte()}{uart\_rx\_byte()}}
{\footnotesize\ttfamily int uart\+\_\+rx\+\_\+byte (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Recive character character from uart. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character. 
\end{DoxyReturn}


Definition at line 299 of file rs232.\+c.



Referenced by uart\+\_\+getchar().

\mbox{\Hypertarget{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}\label{rs232_8h_a72746897c9285db2e3d50c9c38e8bb93}} 
\index{rs232.h@{rs232.h}!uart\_rx\_count@{uart\_rx\_count}}
\index{uart\_rx\_count@{uart\_rx\_count}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_rx\_count()}{uart\_rx\_count()}}
{\footnotesize\ttfamily int uart\+\_\+rx\+\_\+count (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



return count of character count waiting in U\+A\+RT ring buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number to check count for.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Character count in ring buffer. 
\end{DoxyReturn}


Definition at line 277 of file rs232.\+c.



Referenced by uart\+\_\+get\+\_\+tail(), and uart\+\_\+keyhit().

\mbox{\Hypertarget{rs232_8h_ab823b4d83752db47c0852bfa36a59036}\label{rs232_8h_ab823b4d83752db47c0852bfa36a59036}} 
\index{rs232.h@{rs232.h}!uart\_rx\_flush@{uart\_rx\_flush}}
\index{uart\_rx\_flush@{uart\_rx\_flush}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_rx\_flush()}{uart\_rx\_flush()}}
{\footnotesize\ttfamily void uart\+\_\+rx\+\_\+flush (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Flush receive ring buffer for specified uart. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 22 of file rs232.\+c.



Referenced by uart\+\_\+init(), and user\+\_\+task().

\mbox{\Hypertarget{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}\label{rs232_8h_a382aa76e85fa3a1a2add5111578e954e}} 
\index{rs232.h@{rs232.h}!uart\_rx\_interrupt@{uart\_rx\_interrupt}}
\index{uart\_rx\_interrupt@{uart\_rx\_interrupt}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_rx\_interrupt()}{uart\_rx\_interrupt()}}
{\footnotesize\ttfamily void uart\+\_\+rx\+\_\+interrupt (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{uart,  }\item[{uint8\+\_\+t}]{data }\end{DoxyParamCaption})}



U\+A\+RT Receive Interrupt task. 


\begin{DoxyItemize}
\item Add characters to ring receive buffer.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & uart number. \\
\hline
\mbox{\texttt{ in}}  & {\em data} & register data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 207 of file rs232.\+c.



Referenced by I\+S\+R().

\mbox{\Hypertarget{rs232_8h_a3c1200094b998cbb987f545257aaa355}\label{rs232_8h_a3c1200094b998cbb987f545257aaa355}} 
\index{rs232.h@{rs232.h}!uart\_tx\_byte@{uart\_tx\_byte}}
\index{uart\_tx\_byte@{uart\_tx\_byte}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_tx\_byte()}{uart\_tx\_byte()}}
{\footnotesize\ttfamily int uart\+\_\+tx\+\_\+byte (\begin{DoxyParamCaption}\item[{int}]{c,  }\item[{uint8\+\_\+t}]{uart }\end{DoxyParamCaption})}



Transmit 1 byte on uart. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & transmit character. \\
\hline
\mbox{\texttt{ in}}  & {\em uart} & uart number.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 347 of file rs232.\+c.



Referenced by uart\+\_\+getchar(), and uart\+\_\+putchar().

\mbox{\Hypertarget{rs232_8h_acf0f1788a444afef4ccd7c614429df05}\label{rs232_8h_acf0f1788a444afef4ccd7c614429df05}} 
\index{rs232.h@{rs232.h}!uart\_ubr@{uart\_ubr}}
\index{uart\_ubr@{uart\_ubr}!rs232.h@{rs232.h}}
\doxysubsubsection{\texorpdfstring{uart\_ubr()}{uart\_ubr()}}
{\footnotesize\ttfamily uint16\+\_\+t uart\+\_\+ubr (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{baud,  }\item[{int $\ast$}]{u2x,  }\item[{uint32\+\_\+t $\ast$}]{actual }\end{DoxyParamCaption})}



U\+A\+RT baud rate caluculation We compute the best values of baud rate register and prescale. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em uart} & desired baud rate in HZ \\
\hline
\mbox{\texttt{ in}}  & {\em $\ast$u2x} & computed prescale 1 = divide by 8, 0 = divide by 16 \\
\hline
\mbox{\texttt{ in}}  & {\em $\ast$actual} & Actual computed baud rate, closest we could get with register settings\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
baud rate register value 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{posix_8c_ab814cff71bcbcc3a72a6c399e5084573}{fdevopen()}} avr-\/libc function that attaches uart functions to \mbox{\hyperlink{posix_8h_ab38efc888190556f106cafb08d17d16f}{getchar}} and \mbox{\hyperlink{posix_8h_ac9195b3de02e450cfdeea1ce97b32da4}{putchar}} \mbox{\hyperlink{posix_8h_a1c3d85ae80df5590fa314acffd8bf840}{P\+O\+S\+IX}} functions. 
\end{DoxySeeAlso}
Use 8 prescale as a default

Use 16 prescale f we have a low baud rate

Definition at line 73 of file rs232.\+c.



Referenced by uart\+\_\+init().

