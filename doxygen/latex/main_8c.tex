\hypertarget{main_8c}{}\section{main.\+c File Reference}
\label{main_8c}\index{main.\+c@{main.\+c}}


Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+V\+R8.  


{\ttfamily \#include $<$user\+\_\+config.\+h$>$}\\*
{\ttfamily \#include \char`\"{}hardware/iom1284p.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/defines.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+hal.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/gpib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+task.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+tests.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/printer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/amigo.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}gpib/ss80.\+h\char`\"{}}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{main_8c_a7b7a6b774a78bf2034b3b9ba5702da15}{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME}~(1406357902\+L -\/ 3600\+L $\ast$ 4\+L)
\begin{DoxyCompactList}\small\item\em Defines a default E\+P\+O\+CH time to set the R\+TC if not initialied. \end{DoxyCompactList}\item 
\#define \hyperlink{main_8c_a77a4765d1e38b93e353315ca174c9959}{T\+I\+M\+E\+Z\+O\+NE}~300\+L                             /$\ast$ west $\ast$/
\begin{DoxyCompactList}\small\item\em Timezone west in minutes. \end{DoxyCompactList}\item 
\#define \hyperlink{main_8c_a842ed03f27719bc87666bfd1f75415b8}{M\+A\+X\+\_\+\+L\+I\+NE}~80
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}{help} ()
\begin{DoxyCompactList}\small\item\em Display the main help menu -\/ calls all other help menus. \end{DoxyCompactList}\item 
void \hyperlink{main_8c_a9926884643efcc16ac36662b381b6bde}{delay\+\_\+tests} ()
\begin{DoxyCompactList}\small\item\em perform tests on delay functions \end{DoxyCompactList}\item 
void \hyperlink{main_8c_aaad9fc8eb63b077e9ad3d72a2092f27c}{setup\+\_\+clock} ()
\begin{DoxyCompactList}\small\item\em Read R\+TC D\+S1307. \end{DoxyCompactList}\item 
void \hyperlink{main_8c_a4eb8933c334d8d88e9ff0b0d1152951c}{display\+\_\+time} ()
\begin{DoxyCompactList}\small\item\em Display current D\+S1307 R\+TC time. \end{DoxyCompactList}\item 
void \hyperlink{main_8c_a2771e513dfe7d81fe8ea232427b7e6eb}{task} (char $\ast$\hyperlink{main_8c_a4381722bcf21e1580d2d3990afd4f580}{line}, int max, uint8\+\_\+t gpib)
\begin{DoxyCompactList}\small\item\em User command handler -\/ called as main task. \end{DoxyCompactList}\item 
int \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main} (void)
\begin{DoxyCompactList}\small\item\em \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()} for gpib project \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
char \hyperlink{main_8c_a4381722bcf21e1580d2d3990afd4f580}{line} \mbox{[}\hyperlink{main_8c_a842ed03f27719bc87666bfd1f75415b8}{M\+A\+X\+\_\+\+L\+I\+NE}+1\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+V\+R8. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Macro Definition Documentation}
\index{main.\+c@{main.\+c}!D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME@{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME}}
\index{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME@{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME}{DEFAULT_TIME}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+I\+ME~(1406357902\+L -\/ 3600\+L $\ast$ 4\+L)}\hypertarget{main_8c_a7b7a6b774a78bf2034b3b9ba5702da15}{}\label{main_8c_a7b7a6b774a78bf2034b3b9ba5702da15}


Defines a default E\+P\+O\+CH time to set the R\+TC if not initialied. 



Definition at line 88 of file main.\+c.



Referenced by setup\+\_\+clock().

\index{main.\+c@{main.\+c}!M\+A\+X\+\_\+\+L\+I\+NE@{M\+A\+X\+\_\+\+L\+I\+NE}}
\index{M\+A\+X\+\_\+\+L\+I\+NE@{M\+A\+X\+\_\+\+L\+I\+NE}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+L\+I\+NE}{MAX_LINE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+L\+I\+NE~80}\hypertarget{main_8c_a842ed03f27719bc87666bfd1f75415b8}{}\label{main_8c_a842ed03f27719bc87666bfd1f75415b8}


Definition at line 241 of file main.\+c.



Referenced by main().

\index{main.\+c@{main.\+c}!T\+I\+M\+E\+Z\+O\+NE@{T\+I\+M\+E\+Z\+O\+NE}}
\index{T\+I\+M\+E\+Z\+O\+NE@{T\+I\+M\+E\+Z\+O\+NE}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{T\+I\+M\+E\+Z\+O\+NE}{TIMEZONE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+I\+M\+E\+Z\+O\+NE~300\+L                             /$\ast$ west $\ast$/}\hypertarget{main_8c_a77a4765d1e38b93e353315ca174c9959}{}\label{main_8c_a77a4765d1e38b93e353315ca174c9959}


Timezone west in minutes. 



Definition at line 90 of file main.\+c.



\subsection{Function Documentation}
\index{main.\+c@{main.\+c}!delay\+\_\+tests@{delay\+\_\+tests}}
\index{delay\+\_\+tests@{delay\+\_\+tests}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{delay\+\_\+tests()}{delay_tests()}}]{\setlength{\rightskip}{0pt plus 5cm}void delay\+\_\+tests (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_a9926884643efcc16ac36662b381b6bde}{}\label{main_8c_a9926884643efcc16ac36662b381b6bde}


perform tests on delay functions 

This included measurement of avr-\/libc delays \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 52 of file main.\+c.



Referenced by task().

\index{main.\+c@{main.\+c}!display\+\_\+time@{display\+\_\+time}}
\index{display\+\_\+time@{display\+\_\+time}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{display\+\_\+time()}{display_time()}}]{\setlength{\rightskip}{0pt plus 5cm}void display\+\_\+time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_a4eb8933c334d8d88e9ff0b0d1152951c}{}\label{main_8c_a4eb8933c334d8d88e9ff0b0d1152951c}


Display current D\+S1307 R\+TC time. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\+: \hyperlink{rtc_8h_a13dd224642e709b435d15f4ea2c58a3e}{rtc\+\_\+read} 

\+: \hyperlink{time_8c_a8386ff819a39512ea00cfc78ce5a27d5}{timegm()} 

\+: ascitime() 
\end{DoxySeeAlso}


Definition at line 138 of file main.\+c.



Referenced by main(), and task().

\index{main.\+c@{main.\+c}!help@{help}}
\index{help@{help}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{help()}{help()}}]{\setlength{\rightskip}{0pt plus 5cm}void help (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}{}\label{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}


Display the main help menu -\/ calls all other help menus. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib__tests_8c_a48d3cb0472f32b3aac3af47bad350db2}{gpib\+\_\+help()} 

\hyperlink{fatfs__utils_8c_afc835e47fa248967d3ebc236e3d850d7}{fatfs\+\_\+help()} 
\end{DoxySeeAlso}


Definition at line 36 of file main.\+c.



Referenced by task().

\index{main.\+c@{main.\+c}!main@{main}}
\index{main@{main}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{main(void)}{main(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{}\label{main_8c_a840291bc02cba5474a4cb46a9b9566fe}


\hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()} for gpib project 

\begin{DoxyReturn}{Returns}
should never return! 
\end{DoxyReturn}
Power up delay

Power up delay

@ initialize bus state as soon as practical

process config file

G\+P\+IB talking/listening state variables Must be done A\+F\+T\+ER \hyperlink{gpib__task_8c_a29b89503cfbf214695082b16d6d40f52}{gpib\+\_\+file\+\_\+init()} so we have a valid configuration

Display Config

Address Summary

Display debug level 

Definition at line 246 of file main.\+c.



Referenced by Mat\+Write().

\index{main.\+c@{main.\+c}!setup\+\_\+clock@{setup\+\_\+clock}}
\index{setup\+\_\+clock@{setup\+\_\+clock}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{setup\+\_\+clock()}{setup_clock()}}]{\setlength{\rightskip}{0pt plus 5cm}void setup\+\_\+clock (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_aaad9fc8eb63b077e9ad3d72a2092f27c}{}\label{main_8c_aaad9fc8eb63b077e9ad3d72a2092f27c}


Read R\+TC D\+S1307. 

If not initialized set default time \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\+: \hyperlink{timer_8c_a4ebca9883466f2cc6fea0547e0e64e79}{clock\+\_\+settime()} 
\end{DoxySeeAlso}


Definition at line 97 of file main.\+c.



Referenced by main().

\index{main.\+c@{main.\+c}!task@{task}}
\index{task@{task}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{task(char $\ast$line, int max, uint8\+\_\+t gpib)}{task(char *line, int max, uint8_t gpib)}}]{\setlength{\rightskip}{0pt plus 5cm}void task (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{line, }
\item[{int}]{max, }
\item[{uint8\+\_\+t}]{gpib}
\end{DoxyParamCaption}
)}\hypertarget{main_8c_a2771e513dfe7d81fe8ea232427b7e6eb}{}\label{main_8c_a2771e513dfe7d81fe8ea232427b7e6eb}


User command handler -\/ called as main task. 

If a keypress is detected read a line from the uart parse the result and call various user functions. ? will return a list of fuctions and paramters permitted 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em gpib} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 180 of file main.\+c.



Referenced by main().



\subsection{Variable Documentation}
\index{main.\+c@{main.\+c}!line@{line}}
\index{line@{line}!main.\+c@{main.\+c}}
\subsubsection[{\texorpdfstring{line}{line}}]{\setlength{\rightskip}{0pt plus 5cm}char line\mbox{[}{\bf M\+A\+X\+\_\+\+L\+I\+NE}+1\mbox{]}}\hypertarget{main_8c_a4381722bcf21e1580d2d3990afd4f580}{}\label{main_8c_a4381722bcf21e1580d2d3990afd4f580}


Definition at line 242 of file main.\+c.



Referenced by main().

