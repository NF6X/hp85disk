\hypertarget{main_8c}{}\section{main.\+c File Reference}
\label{main_8c}\index{main.\+c@{main.\+c}}


Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+VR.  


{\ttfamily \#include $<$user\+\_\+config.\+h$>$}\newline
{\ttfamily \#include \char`\"{}hardware/i2c.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/defines.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+hal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+tests.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/printer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/amigo.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/ss80.\+h\char`\"{}}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \hyperlink{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}{R\+E\+S\+E\+T\+\_\+t}) (void)
\begin{DoxyCompactList}\small\item\em Display the main help menu -\/ calls all other help menus. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{main_8c_ada2555fd3159dbf04e0738fe9c50e22c}{copyright} ()
\begin{DoxyCompactList}\small\item\em Display Copyright. \end{DoxyCompactList}\item 
void \hyperlink{main_8c_a8824827cf2979219e9a65ead803647e6}{gpib\+\_\+user\+\_\+task} ()
\begin{DoxyCompactList}\small\item\em ====================================== \end{DoxyCompactList}\item 
void \hyperlink{main_8c_a66ac220b8fb4c59823fdf116cecda862}{task} (uint8\+\_\+t gpib)
\begin{DoxyCompactList}\small\item\em ====================================== \end{DoxyCompactList}\item 
int \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main} (void)
\begin{DoxyCompactList}\small\item\em \hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()} for gpib project \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+VR. 

\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\tt http\+://github.\+com/magore/hp85disk} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\tt http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md} for Copyright details
\end{DoxySeeAlso}
\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file. 
\end{DoxyItemize}
\end{DoxyParagraph}


\subsection{Typedef Documentation}
\mbox{\Hypertarget{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}\label{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}} 
\index{main.\+c@{main.\+c}!R\+E\+S\+E\+T\+\_\+t@{R\+E\+S\+E\+T\+\_\+t}}
\index{R\+E\+S\+E\+T\+\_\+t@{R\+E\+S\+E\+T\+\_\+t}!main.\+c@{main.\+c}}
\subsubsection{\texorpdfstring{R\+E\+S\+E\+T\+\_\+t}{RESET\_t}}
{\footnotesize\ttfamily typedef void($\ast$ R\+E\+S\+E\+T\+\_\+t) (void)}



Display the main help menu -\/ calls all other help menus. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib__tests_8c_a4bd85d1cfc93b13cd8cfbac1014224c4}{gpib\+\_\+help()} 

\hyperlink{fatfs__tests_8c_ad16bc1913c19300dba43a07006c9ac52}{fatfs\+\_\+help()} 
\end{DoxySeeAlso}


Definition at line 96 of file main.\+c.



\subsection{Function Documentation}
\mbox{\Hypertarget{main_8c_ada2555fd3159dbf04e0738fe9c50e22c}\label{main_8c_ada2555fd3159dbf04e0738fe9c50e22c}} 
\index{main.\+c@{main.\+c}!copyright@{copyright}}
\index{copyright@{copyright}!main.\+c@{main.\+c}}
\subsubsection{\texorpdfstring{copyright()}{copyright()}}
{\footnotesize\ttfamily void copyright (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Display Copyright. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 43 of file main.\+c.

\mbox{\Hypertarget{main_8c_a8824827cf2979219e9a65ead803647e6}\label{main_8c_a8824827cf2979219e9a65ead803647e6}} 
\index{main.\+c@{main.\+c}!gpib\+\_\+user\+\_\+task@{gpib\+\_\+user\+\_\+task}}
\index{gpib\+\_\+user\+\_\+task@{gpib\+\_\+user\+\_\+task}!main.\+c@{main.\+c}}
\subsubsection{\texorpdfstring{gpib\+\_\+user\+\_\+task()}{gpib\_user\_task()}}
{\footnotesize\ttfamily void gpib\+\_\+user\+\_\+task (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



====================================== 

====================================== ====================================== 

Definition at line 236 of file main.\+c.



Referenced by gpib\+\_\+read\+\_\+byte().

\mbox{\Hypertarget{main_8c_a840291bc02cba5474a4cb46a9b9566fe}\label{main_8c_a840291bc02cba5474a4cb46a9b9566fe}} 
\index{main.\+c@{main.\+c}!main@{main}}
\index{main@{main}!main.\+c@{main.\+c}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()} for gpib project 

\begin{DoxyReturn}{Returns}
should never return! 
\end{DoxyReturn}
@ initialize bus state as soon as practical

@ Initialize U\+A\+RT early Returns actual B\+A\+UD rate -\/ possible with hardware -\/ may differ slightly

Power up delay

Power up delay

@ initialize S\+PI bus

@ initialize I2C bus

@ initialize clock by R\+TC if we have it

@ initialize Optional I2C L\+CD

@ initialize M\+MC bus

@ initialize bus state as soon as practical

@ initialize Printer Capture

@ initialize G\+P\+IB timer tasks

Process hp85disk emulator config file

G\+P\+IB talking/listening state variables Must be done A\+F\+T\+ER \hyperlink{gpib__task_8c_a29b89503cfbf214695082b16d6d40f52}{gpib\+\_\+file\+\_\+init()} so we have a valid configuration

Display Address Summary

Display debug level

Format any drives that do not yet exist

Start main G\+P\+IB state machine

Keep the task running task does not exit unless a keypress occurs When it restarts A\+LL G\+P\+IB states are reset 

Definition at line 366 of file main.\+c.



Referenced by Mat\+Write().

\mbox{\Hypertarget{main_8c_a66ac220b8fb4c59823fdf116cecda862}\label{main_8c_a66ac220b8fb4c59823fdf116cecda862}} 
\index{main.\+c@{main.\+c}!task@{task}}
\index{task@{task}!main.\+c@{main.\+c}}
\subsubsection{\texorpdfstring{task()}{task()}}
{\footnotesize\ttfamily void task (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{gpib }\end{DoxyParamCaption})}



====================================== 

User command handler -\/ called as main task

If a keypress is detected read a line from the uart parse the result and call various user functions. ? will return a list of fuctions and paramters permitted 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em gpib} & -\/ if non-\/zero run gpib while there are no user commands \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 254 of file main.\+c.



Referenced by main().

