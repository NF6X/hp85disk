\hypertarget{main_8c}{}\doxysection{main.\+c File Reference}
\label{main_8c}\index{main.c@{main.c}}


Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+VR.  


{\ttfamily \#include $<$user\+\_\+config.\+h$>$}\newline
{\ttfamily \#include \char`\"{}hardware/i2c.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/defines.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+hal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+task.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/gpib\+\_\+tests.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/printer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/amigo.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpib/ss80.\+h\char`\"{}}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \mbox{\hyperlink{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}{R\+E\+S\+E\+T\+\_\+t}}) (void)
\begin{DoxyCompactList}\small\item\em Display Copyright. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{main_8c_a8824827cf2979219e9a65ead803647e6}{gpib\+\_\+user\+\_\+task}} ()
\begin{DoxyCompactList}\small\item\em ====================================== \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}{help}} ()
\begin{DoxyCompactList}\small\item\em Display the main help menu -\/ calls all other help menus. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{main_8c_a60bde6d5d7a2cb6c56e942f0fa898dcb}{user\+\_\+task}} (uint8\+\_\+t gpib)
\begin{DoxyCompactList}\small\item\em User command handler -\/ called as main task. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()}} for gpib project \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Main for G\+P\+IB emulator for H\+P85 disk emulator project for A\+VR. 

\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\texttt{ http\+://github.\+com/magore/hp85disk}} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\texttt{ http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md}} for Copyright details
\end{DoxySeeAlso}
\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file. 
\end{DoxyItemize}
\end{DoxyParagraph}


\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}\label{main_8c_a52d21b0c2b1c100472ac0571d94ab0b5}} 
\index{main.c@{main.c}!RESET\_t@{RESET\_t}}
\index{RESET\_t@{RESET\_t}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{RESET\_t}{RESET\_t}}
{\footnotesize\ttfamily typedef void($\ast$ R\+E\+S\+E\+T\+\_\+t) (void)}



Display Copyright. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 42 of file main.\+c.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8c_a8824827cf2979219e9a65ead803647e6}\label{main_8c_a8824827cf2979219e9a65ead803647e6}} 
\index{main.c@{main.c}!gpib\_user\_task@{gpib\_user\_task}}
\index{gpib\_user\_task@{gpib\_user\_task}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{gpib\_user\_task()}{gpib\_user\_task()}}
{\footnotesize\ttfamily void gpib\+\_\+user\+\_\+task (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



====================================== 

user task called in G\+P\+IB read/write byte functions

====================================== ====================================== 

Definition at line 233 of file main.\+c.



Referenced by gpib\+\_\+read\+\_\+byte(), and gpib\+\_\+write\+\_\+byte().

\mbox{\Hypertarget{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}\label{main_8c_a97ee70a8770dc30d06c744b24eb2fcfc}} 
\index{main.c@{main.c}!help@{help}}
\index{help@{help}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{help()}{help()}}
{\footnotesize\ttfamily void help (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Display the main help menu -\/ calls all other help menus. 

\hypertarget{main_8h_autotoc_md17}{}\doxysubsection{======================================}\label{main_8h_autotoc_md17}
====================================== \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{gpib__tests_8c_a4bd85d1cfc93b13cd8cfbac1014224c4}{gpib\+\_\+help()}} 

\mbox{\hyperlink{fatfs__tests_8c_ad16bc1913c19300dba43a07006c9ac52}{fatfs\+\_\+help()}} 
\end{DoxySeeAlso}


Definition at line 289 of file main.\+c.



Referenced by user\+\_\+task().

\mbox{\Hypertarget{main_8c_a840291bc02cba5474a4cb46a9b9566fe}\label{main_8c_a840291bc02cba5474a4cb46a9b9566fe}} 
\index{main.c@{main.c}!main@{main}}
\index{main@{main}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\mbox{\hyperlink{main_8c_a840291bc02cba5474a4cb46a9b9566fe}{main()}} for gpib project 

\begin{DoxyReturn}{Returns}
should never return! 
\end{DoxyReturn}
@ initialize bus state as soon as practical

@ Initialize U\+A\+RT early Returns actual B\+A\+UD rate -\/ possible with hardware -\/ may differ slightly

Power up delay

@ initialize S\+PI bus

@ initialize I2C bus

@ initialize clock by R\+TC if we have it

@ initialize Optional I2C L\+CD

@ initialize M\+MC bus

@ initialize bus state as soon as practical

@ initialize Printer Capture

@ initialize G\+P\+IB timer tasks

Process hp85disk emulator config file

G\+P\+IB talking/listening state variables Must be done A\+F\+T\+ER \mbox{\hyperlink{gpib__task_8c_a29b89503cfbf214695082b16d6d40f52}{gpib\+\_\+file\+\_\+init()}} so we have a valid configuration

Display Address Summary

Display debug level

Format any drives that do not yet exist

Start main G\+P\+IB state machine

Keep the task running task does not exit unless a keypress occurs When it restarts A\+LL G\+P\+IB states are reset ~\newline


Definition at line 523 of file main.\+c.

\mbox{\Hypertarget{main_8c_a60bde6d5d7a2cb6c56e942f0fa898dcb}\label{main_8c_a60bde6d5d7a2cb6c56e942f0fa898dcb}} 
\index{main.c@{main.c}!user\_task@{user\_task}}
\index{user\_task@{user\_task}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{user\_task()}{user\_task()}}
{\footnotesize\ttfamily void user\+\_\+task (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{gpib }\end{DoxyParamCaption})}



User command handler -\/ called as main task. 

If a keypress is detected read a line from the uart parse the result and call various user functions. ? will return a list of fuctions and paramters permitted 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em gpib} & -\/ if non-\/zero run gpib while there are no user commands \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 338 of file main.\+c.



Referenced by main().

