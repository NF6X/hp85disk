\hypertarget{amigo_8h}{}\section{gpib/amigo.h File Reference}
\label{amigo_8h}\index{gpib/amigo.\+h@{gpib/amigo.\+h}}


A\+M\+I\+GO disk emulator for H\+P85 disk emulator project for A\+V\+R8.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{amigo_8h_a2853286c50783f39131810ec2b0e9610}{U\+NL}~0x3F
\item 
\#define \hyperlink{amigo_8h_aa370bdc64b3b5d37eeb63a4c499f3ef3}{U\+NT}~0x5F
\item 
\#define \hyperlink{amigo_8h_af75952fda4dcd61b5fd81ecc2f764413}{L\+LO}~0x11
\item 
\#define \hyperlink{amigo_8h_a865c763cb20dd8d8d1bbe2df29f6a50d}{D\+CL}~0x14
\item 
\#define \hyperlink{amigo_8h_aa9720ef12852cf4e0293b5a0a8b19bdc}{P\+PU}~0x15
\item 
\#define \hyperlink{amigo_8h_a4b23fe370a3a09cc47acd1e837a5b125}{S\+PE}~0x18
\item 
\#define \hyperlink{amigo_8h_a3fee30674709bf7cf2601f2e499372cf}{S\+PD}~0x19
\item 
\#define \hyperlink{amigo_8h_a4a5ce0eaf1fcd7131fba9ec08df9bc1e}{G\+TL}~0x01
\item 
\#define \hyperlink{amigo_8h_a26ebbac1e849f9c61421e7279c597f2b}{S\+DC}~0x04
\item 
\#define \hyperlink{amigo_8h_aa53c4577418b64bd81732884048fae00}{P\+PC}~0x05
\item 
\#define \hyperlink{amigo_8h_a982a66f513611f7f83ebfa4b4ecf1df9}{G\+ET}~0x08
\item 
\#define \hyperlink{amigo_8h_a62d9d5d853e9cf2072dd811ce956ec56}{T\+CT}~0x09
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{amigo_8h_ab63435382919a7106a374b021861a2e1}{amigo\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Initialize Amigo state machine, Disk Position, Error status. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a8cbb86a2e44ef4a770a370dcb65d3fbf}{amigo\+\_\+request\+\_\+logical\+\_\+address} (void)
\begin{DoxyCompactList}\small\item\em Set current address in A\+M\+I\+G\+O\+State.\+logical\+\_\+address\mbox{[}\mbox{]}. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_afb2f0c0517c5c10c38f8e15b8b281a8c}{amigo\+\_\+request\+\_\+status} (void)
\begin{DoxyCompactList}\small\item\em Set drive status in A\+M\+I\+G\+O\+State.\+status\mbox{[}\mbox{]}. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a7c6a930fa7cc03f1e926ae99dbe1881c}{amigo\+\_\+send\+\_\+logical\+\_\+address} (void)
\begin{DoxyCompactList}\small\item\em Send current address in A\+M\+I\+G\+O\+State.\+logical\+\_\+address\mbox{[}\mbox{]}. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_af4df946daf08c99b2d3b85318c9e9df8}{amigo\+\_\+send\+\_\+status} (void)
\begin{DoxyCompactList}\small\item\em Send drive status in A\+M\+I\+G\+O\+State.\+status\mbox{[}\mbox{]}. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_ae6c9b56f7f0179eecd6d57c2844bc56c}{amigo\+\_\+increment} (char $\ast$msg)
\begin{DoxyCompactList}\small\item\em Increment sector if it will not overflow. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a17be7a7fc76ab2dc6018801be855e1d5}{amigo\+\_\+seek} (\hyperlink{structAMIGOStateType}{A\+M\+I\+G\+O\+State\+Type} $\ast$p)
\begin{DoxyCompactList}\small\item\em Seek to the position held in the disk structure. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_ab08912bf94dc6e8fbe87990ff41f46f0}{amigo\+\_\+verify} (uint16\+\_\+t sectors)
\begin{DoxyCompactList}\small\item\em Verify Disk Sectors at current position. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a85a3d11b8dd534100df603e4c3514c92}{amigo\+\_\+format} (uint8\+\_\+t override, uint8\+\_\+t interleave, uint8\+\_\+t db)
\begin{DoxyCompactList}\small\item\em Format Disk. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a4934ae332e168979dbb865a9948de88b}{amigo\+\_\+buffered\+\_\+read} (void)
\begin{DoxyCompactList}\small\item\em Do a buffered read of the current sector. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_ae9c3505761b1afba4f47a6b593527583}{amigo\+\_\+buffered\+\_\+write} (void)
\begin{DoxyCompactList}\small\item\em Do a buffered write of the current sector. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_af5cfdd8675fce8b93259c76782501394}{amigo\+\_\+cmd\+\_\+dsj} (void)
\begin{DoxyCompactList}\small\item\em Send D\+SJ. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a1893674c480c08927066d7e10029d01c}{amigo\+\_\+cmd\+\_\+wakeup} (void)
\begin{DoxyCompactList}\small\item\em Wakeup (undocumented), just enable P\+PR response. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_ae61925e6fb971862b8b0390c67bc164c}{amigo\+\_\+cmd\+\_\+clear} (void)
\begin{DoxyCompactList}\small\item\em Response to selected device clear or all clear. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a6c99539773ae8be3bd4d3bd7493c16d6}{amigo\+\_\+todo\+\_\+op} (uint8\+\_\+t \hyperlink{gpib_8h_a25538708e408bbc21b380cb6f709f5d8}{secondary}, uint8\+\_\+t opcode, int len)
\begin{DoxyCompactList}\small\item\em Report any Unimplimented commands with Op Codes. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a437bef06e567b3f6728f2519b9065354}{amigo\+\_\+todo} (uint8\+\_\+t \hyperlink{gpib_8h_a25538708e408bbc21b380cb6f709f5d8}{secondary})
\begin{DoxyCompactList}\small\item\em Report any Unimplimented commands. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a2fc6f1413199d33d2b32e675dd45e181}{Amigo\+\_\+\+Command} (int \hyperlink{gpib_8h_a25538708e408bbc21b380cb6f709f5d8}{secondary})
\begin{DoxyCompactList}\small\item\em Amigo Command and OP Code Processing functions. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_ad7271e45e6b3bb6edef42da4ad5bb25a}{Amigo\+\_\+\+Execute} (int \hyperlink{gpib_8h_a25538708e408bbc21b380cb6f709f5d8}{secondary})
\begin{DoxyCompactList}\small\item\em Amigo Execute command processing. \end{DoxyCompactList}\item 
int \hyperlink{amigo_8h_a77b7d46bd469c79c73696a9ae2a3543d}{A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS} (uint8\+\_\+t ch)
\begin{DoxyCompactList}\small\item\em A\+M\+I\+GO Command state processing. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
A\+M\+I\+GO disk emulator for H\+P85 disk emulator project for A\+V\+R8. 

\begin{DoxyParagraph}{Edit History -\/ \mbox{[}1.0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Based on work by Anders Gustafsson.}

\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Anders Gustafsson All rights reserved..}

\end{DoxyParagraph}


\subsection{Macro Definition Documentation}
\index{amigo.\+h@{amigo.\+h}!D\+CL@{D\+CL}}
\index{D\+CL@{D\+CL}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{D\+CL}{DCL}}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+CL~0x14}\hypertarget{amigo_8h_a865c763cb20dd8d8d1bbe2df29f6a50d}{}\label{amigo_8h_a865c763cb20dd8d8d1bbe2df29f6a50d}


Definition at line 26 of file amigo.\+h.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!G\+ET@{G\+ET}}
\index{G\+ET@{G\+ET}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{G\+ET}{GET}}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+ET~0x08}\hypertarget{amigo_8h_a982a66f513611f7f83ebfa4b4ecf1df9}{}\label{amigo_8h_a982a66f513611f7f83ebfa4b4ecf1df9}


Definition at line 33 of file amigo.\+h.

\index{amigo.\+h@{amigo.\+h}!G\+TL@{G\+TL}}
\index{G\+TL@{G\+TL}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{G\+TL}{GTL}}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+TL~0x01}\hypertarget{amigo_8h_a4a5ce0eaf1fcd7131fba9ec08df9bc1e}{}\label{amigo_8h_a4a5ce0eaf1fcd7131fba9ec08df9bc1e}


Definition at line 30 of file amigo.\+h.

\index{amigo.\+h@{amigo.\+h}!L\+LO@{L\+LO}}
\index{L\+LO@{L\+LO}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{L\+LO}{LLO}}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\+LO~0x11}\hypertarget{amigo_8h_af75952fda4dcd61b5fd81ecc2f764413}{}\label{amigo_8h_af75952fda4dcd61b5fd81ecc2f764413}


Definition at line 25 of file amigo.\+h.

\index{amigo.\+h@{amigo.\+h}!P\+PC@{P\+PC}}
\index{P\+PC@{P\+PC}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{P\+PC}{PPC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+PC~0x05}\hypertarget{amigo_8h_aa53c4577418b64bd81732884048fae00}{}\label{amigo_8h_aa53c4577418b64bd81732884048fae00}


Definition at line 32 of file amigo.\+h.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!P\+PU@{P\+PU}}
\index{P\+PU@{P\+PU}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{P\+PU}{PPU}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+PU~0x15}\hypertarget{amigo_8h_aa9720ef12852cf4e0293b5a0a8b19bdc}{}\label{amigo_8h_aa9720ef12852cf4e0293b5a0a8b19bdc}


Definition at line 27 of file amigo.\+h.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!S\+DC@{S\+DC}}
\index{S\+DC@{S\+DC}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{S\+DC}{SDC}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+DC~0x04}\hypertarget{amigo_8h_a26ebbac1e849f9c61421e7279c597f2b}{}\label{amigo_8h_a26ebbac1e849f9c61421e7279c597f2b}


Definition at line 31 of file amigo.\+h.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!S\+PD@{S\+PD}}
\index{S\+PD@{S\+PD}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{S\+PD}{SPD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+PD~0x19}\hypertarget{amigo_8h_a3fee30674709bf7cf2601f2e499372cf}{}\label{amigo_8h_a3fee30674709bf7cf2601f2e499372cf}


Definition at line 29 of file amigo.\+h.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!S\+PE@{S\+PE}}
\index{S\+PE@{S\+PE}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{S\+PE}{SPE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+PE~0x18}\hypertarget{amigo_8h_a4b23fe370a3a09cc47acd1e837a5b125}{}\label{amigo_8h_a4b23fe370a3a09cc47acd1e837a5b125}


Definition at line 28 of file amigo.\+h.



Referenced by G\+P\+I\+B(), and S\+P\+I0\+\_\+\+Init().

\index{amigo.\+h@{amigo.\+h}!T\+CT@{T\+CT}}
\index{T\+CT@{T\+CT}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{T\+CT}{TCT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+CT~0x09}\hypertarget{amigo_8h_a62d9d5d853e9cf2072dd811ce956ec56}{}\label{amigo_8h_a62d9d5d853e9cf2072dd811ce956ec56}


Definition at line 34 of file amigo.\+h.

\index{amigo.\+h@{amigo.\+h}!U\+NL@{U\+NL}}
\index{U\+NL@{U\+NL}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{U\+NL}{UNL}}]{\setlength{\rightskip}{0pt plus 5cm}\#define U\+NL~0x3F}\hypertarget{amigo_8h_a2853286c50783f39131810ec2b0e9610}{}\label{amigo_8h_a2853286c50783f39131810ec2b0e9610}


Definition at line 23 of file amigo.\+h.



Referenced by G\+P\+I\+B\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S(), and G\+P\+I\+B\+\_\+\+L\+I\+S\+T\+E\+N().

\index{amigo.\+h@{amigo.\+h}!U\+NT@{U\+NT}}
\index{U\+NT@{U\+NT}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{U\+NT}{UNT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define U\+NT~0x5F}\hypertarget{amigo_8h_aa370bdc64b3b5d37eeb63a4c499f3ef3}{}\label{amigo_8h_aa370bdc64b3b5d37eeb63a4c499f3ef3}


Definition at line 24 of file amigo.\+h.



Referenced by A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S(), Amigo\+\_\+\+Execute(), amigo\+\_\+todo(), amigo\+\_\+todo\+\_\+op(), G\+P\+I\+B\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S(), G\+P\+I\+B\+\_\+\+L\+I\+S\+T\+E\+N(), G\+P\+I\+B\+\_\+\+T\+A\+L\+K(), and gpib\+\_\+task().



\subsection{Function Documentation}
\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+buffered\+\_\+read@{amigo\+\_\+buffered\+\_\+read}}
\index{amigo\+\_\+buffered\+\_\+read@{amigo\+\_\+buffered\+\_\+read}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+buffered\+\_\+read(void)}{amigo_buffered_read(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+buffered\+\_\+read (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a4934ae332e168979dbb865a9948de88b}{}\label{amigo_8h_a4934ae332e168979dbb865a9948de88b}


Do a buffered read of the current sector. 


\begin{DoxyItemize}
\item Reference\+: A33. \begin{DoxyReturn}{Returns}
0 ok 

G\+P\+IB Errors status,Sets dsj and Amigo\+\_\+errors 
\end{DoxyReturn}

\end{DoxyItemize}\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000004}{Todo}]Do we fail on overflow ? currently djs is set -\/ do we want to report that now ? \end{DoxyRefDesc}


Definition at line 563 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Execute().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+buffered\+\_\+write@{amigo\+\_\+buffered\+\_\+write}}
\index{amigo\+\_\+buffered\+\_\+write@{amigo\+\_\+buffered\+\_\+write}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+buffered\+\_\+write(void)}{amigo_buffered_write(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+buffered\+\_\+write (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ae9c3505761b1afba4f47a6b593527583}{}\label{amigo_8h_ae9c3505761b1afba4f47a6b593527583}


Do a buffered write of the current sector. 


\begin{DoxyItemize}
\item Reference\+: A43. \begin{DoxyReturn}{Returns}
0 ok 

G\+P\+IB Errors status,Sets dsj and Amigo\+\_\+errors 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 629 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Execute().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+cmd\+\_\+clear@{amigo\+\_\+cmd\+\_\+clear}}
\index{amigo\+\_\+cmd\+\_\+clear@{amigo\+\_\+cmd\+\_\+clear}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+cmd\+\_\+clear(void)}{amigo_cmd_clear(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+cmd\+\_\+clear (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ae61925e6fb971862b8b0390c67bc164c}{}\label{amigo_8h_ae61925e6fb971862b8b0390c67bc164c}


Response to selected device clear or all clear. 


\begin{DoxyItemize}
\item Reference\+: A23.
\item Select sector 0. \begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}

\end{DoxyItemize}\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000007}{Todo}]F\+I\+X\+ME\end{DoxyRefDesc}


Clear the D\+SJ byte that might be 2 after powerup

Definition at line 776 of file amigo.\+c.



Referenced by G\+P\+I\+B().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+cmd\+\_\+dsj@{amigo\+\_\+cmd\+\_\+dsj}}
\index{amigo\+\_\+cmd\+\_\+dsj@{amigo\+\_\+cmd\+\_\+dsj}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+cmd\+\_\+dsj(void)}{amigo_cmd_dsj(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+cmd\+\_\+dsj (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_af5cfdd8675fce8b93259c76782501394}{}\label{amigo_8h_af5cfdd8675fce8b93259c76782501394}


Send D\+SJ. 


\begin{DoxyItemize}
\item Reference\+: A11. \begin{DoxyReturn}{Returns}
0 ok 

G\+P\+IB send Errors status
\end{DoxyReturn}

\item Sets dsj and Amigo\+\_\+errors 
\end{DoxyItemize}

Definition at line 696 of file amigo.\+c.



Referenced by A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+cmd\+\_\+wakeup@{amigo\+\_\+cmd\+\_\+wakeup}}
\index{amigo\+\_\+cmd\+\_\+wakeup@{amigo\+\_\+cmd\+\_\+wakeup}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+cmd\+\_\+wakeup(void)}{amigo_cmd_wakeup(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+cmd\+\_\+wakeup (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a1893674c480c08927066d7e10029d01c}{}\label{amigo_8h_a1893674c480c08927066d7e10029d01c}


Wakeup (undocumented), just enable P\+PR response. 

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000005}{Todo}]
\begin{DoxyItemize}
\item not finished
\item Sets dsj and Amigo\+\_\+errors
\end{DoxyItemize}\end{DoxyRefDesc}


\begin{DoxyReturn}{Returns}
G\+P\+IB Errors status -\/ or 0 OK 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000006}{Todo}]F\+I\+X\+ME \end{DoxyRefDesc}


Definition at line 738 of file amigo.\+c.

\index{amigo.\+h@{amigo.\+h}!Amigo\+\_\+\+Command@{Amigo\+\_\+\+Command}}
\index{Amigo\+\_\+\+Command@{Amigo\+\_\+\+Command}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{Amigo\+\_\+\+Command(int secondary)}{Amigo_Command(int secondary)}}]{\setlength{\rightskip}{0pt plus 5cm}int Amigo\+\_\+\+Command (
\begin{DoxyParamCaption}
\item[{int}]{secondary}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a2fc6f1413199d33d2b32e675dd45e181}{}\label{amigo_8h_a2fc6f1413199d33d2b32e675dd45e181}


Amigo Command and OP Code Processing functions. 


\begin{DoxyItemize}
\item We disbale P\+PR as soon as a valide command is decoded.
\item O\+N\+LY process Secondary Commands in listen mode with op codes and optional data
\begin{DoxyItemize}
\item Ignore Talking.
\item Ignore Seconday Addresses.
\item Ignore Execute state \char`\"{}0x60\char`\"{} here.
\item Must have OP Codes, or Data, and E\+OI.
\end{DoxyItemize}
\item Read all of the Data/\+Opcodes/\+Parameters at once -\/ while A\+TN is false.
\item Last byte read should be E\+OI or an error.
\item Unknown OP Code processing rules.
\begin{DoxyItemize}
\item Skip the remaining codes, Wait for Report Phase.
\end{DoxyItemize}
\item We enable P\+PR on exit.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em secondary} & command\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on sucess 

or G\+P\+IB error flags on fail 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib_8h}{gpib.\+h} \hyperlink{gpib_8h_a10916ab21f8ba06e447e898790ef6a4b}{E\+R\+R\+O\+R\+\_\+\+M\+A\+SK} defines for a full list) 
\end{DoxySeeAlso}
Reference\+: A14

Reference\+: A25

Note\+: the function will \char`\"{}unread\char`\"{} any commands and return All Data M\+U\+ST have E\+OI

Reference\+: A40

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000008}{Todo}]F\+I\+X\+ME \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000009}{Todo}]F\+I\+X\+ME \end{DoxyRefDesc}


Reference\+: A27

Seek 1 byte cylinder

Reference\+: A27

Seek 2 byte cylinder

Reference\+: A15

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000010}{Todo}]is this the unit \$ ? \end{DoxyRefDesc}


Reference\+: A35

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000011}{Todo}]unit ??? \end{DoxyRefDesc}


Reference\+: A48 .. A50

Reference\+: A23 

Definition at line 869 of file amigo.\+c.



Referenced by A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\index{amigo.\+h@{amigo.\+h}!A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS}}
\index{A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS@{A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S(uint8\+\_\+t ch)}{AMIGO_COMMANDS(uint8_t ch)}}]{\setlength{\rightskip}{0pt plus 5cm}int A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+DS (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{ch}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a77b7d46bd469c79c73696a9ae2a3543d}{}\label{amigo_8h_a77b7d46bd469c79c73696a9ae2a3543d}


A\+M\+I\+GO Command state processing. 


\begin{DoxyItemize}
\item Perform Command, Execute or Reporting Phase functions.
\begin{DoxyItemize}
\item \hyperlink{amigo_8c_a2fc6f1413199d33d2b32e675dd45e181}{Amigo\+\_\+\+Command()}.
\item \hyperlink{amigo_8c_ad7271e45e6b3bb6edef42da4ad5bb25a}{Amigo\+\_\+\+Execute()}.
\item \hyperlink{amigo_8c_a3ab896c5b3810e84072107a6bcf896c9}{amigo\+\_\+cmd\+\_\+dsj()}.
\end{DoxyItemize}
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ch} & command.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on sucess 

or G\+P\+IB error flags on fail 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib_8h}{gpib.\+h} \hyperlink{gpib_8h_a10916ab21f8ba06e447e898790ef6a4b}{E\+R\+R\+O\+R\+\_\+\+M\+A\+SK} defines for a full list. 
\end{DoxySeeAlso}


Definition at line 1291 of file amigo.\+c.



Referenced by G\+P\+I\+B\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\index{amigo.\+h@{amigo.\+h}!Amigo\+\_\+\+Execute@{Amigo\+\_\+\+Execute}}
\index{Amigo\+\_\+\+Execute@{Amigo\+\_\+\+Execute}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{Amigo\+\_\+\+Execute(int secondary)}{Amigo_Execute(int secondary)}}]{\setlength{\rightskip}{0pt plus 5cm}int Amigo\+\_\+\+Execute (
\begin{DoxyParamCaption}
\item[{int}]{secondary}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ad7271e45e6b3bb6edef42da4ad5bb25a}{}\label{amigo_8h_ad7271e45e6b3bb6edef42da4ad5bb25a}


Amigo Execute command processing. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em secondary} & command\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on sucess 

or G\+P\+IB error flags on fail 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib_8h}{gpib.\+h} \hyperlink{gpib_8h_a10916ab21f8ba06e447e898790ef6a4b}{E\+R\+R\+O\+R\+\_\+\+M\+A\+SK} defines for a full list) 
\end{DoxySeeAlso}


Definition at line 1179 of file amigo.\+c.



Referenced by A\+M\+I\+G\+O\+\_\+\+C\+O\+M\+M\+A\+N\+D\+S().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+format@{amigo\+\_\+format}}
\index{amigo\+\_\+format@{amigo\+\_\+format}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+format(uint8\+\_\+t override, uint8\+\_\+t interleave, uint8\+\_\+t db)}{amigo_format(uint8_t override, uint8_t interleave, uint8_t db)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+format (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{override, }
\item[{uint8\+\_\+t}]{interleave, }
\item[{uint8\+\_\+t}]{db}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a85a3d11b8dd534100df603e4c3514c92}{}\label{amigo_8h_a85a3d11b8dd534100df603e4c3514c92}


Format Disk. 


\begin{DoxyItemize}
\item Refernce\+: A50.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em override} & not used \\
\hline
\mbox{\tt in}  & {\em interleave} & not used \\
\hline
\mbox{\tt in}  & {\em db} & byte to fill sector buffer with)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 ok 

1 on Error,Sets dsj and Amigo\+\_\+errors 
\end{DoxyReturn}


Definition at line 507 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+increment@{amigo\+\_\+increment}}
\index{amigo\+\_\+increment@{amigo\+\_\+increment}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+increment(char $\ast$msg)}{amigo_increment(char *msg)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+increment (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{msg}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ae6c9b56f7f0179eecd6d57c2844bc56c}{}\label{amigo_8h_ae6c9b56f7f0179eecd6d57c2844bc56c}


Increment sector if it will not overflow. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em msg} & user message on overflow.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 ok. 

1 error. 
\end{DoxyReturn}


Definition at line 396 of file amigo.\+c.



Referenced by amigo\+\_\+buffered\+\_\+read(), amigo\+\_\+buffered\+\_\+write(), amigo\+\_\+format(), and amigo\+\_\+verify().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+init@{amigo\+\_\+init}}
\index{amigo\+\_\+init@{amigo\+\_\+init}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+init(void)}{amigo_init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void amigo\+\_\+init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ab63435382919a7106a374b021861a2e1}{}\label{amigo_8h_ab63435382919a7106a374b021861a2e1}


Initialize Amigo state machine, Disk Position, Error status. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]verify that we always want P\+PR disabled \end{DoxyRefDesc}


Definition at line 171 of file amigo.\+c.



Referenced by gpib\+\_\+init\+\_\+devices().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+request\+\_\+logical\+\_\+address@{amigo\+\_\+request\+\_\+logical\+\_\+address}}
\index{amigo\+\_\+request\+\_\+logical\+\_\+address@{amigo\+\_\+request\+\_\+logical\+\_\+address}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+request\+\_\+logical\+\_\+address(void)}{amigo_request_logical_address(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+request\+\_\+logical\+\_\+address (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a8cbb86a2e44ef4a770a370dcb65d3fbf}{}\label{amigo_8h_a8cbb86a2e44ef4a770a370dcb65d3fbf}


Set current address in A\+M\+I\+G\+O\+State.\+logical\+\_\+address\mbox{[}\mbox{]}. 


\begin{DoxyItemize}
\item Reference\+: A15-\/\+A19
\item State\+: Command \begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 198 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+request\+\_\+status@{amigo\+\_\+request\+\_\+status}}
\index{amigo\+\_\+request\+\_\+status@{amigo\+\_\+request\+\_\+status}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+request\+\_\+status(void)}{amigo_request_status(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+request\+\_\+status (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_afb2f0c0517c5c10c38f8e15b8b281a8c}{}\label{amigo_8h_afb2f0c0517c5c10c38f8e15b8b281a8c}


Set drive status in A\+M\+I\+G\+O\+State.\+status\mbox{[}\mbox{]}. 


\begin{DoxyItemize}
\item Reference\+: A15-\/\+A19.
\item State\+: Command. \begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}

\end{DoxyItemize}\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000003}{Todo}]dsj \end{DoxyRefDesc}


Definition at line 215 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+seek@{amigo\+\_\+seek}}
\index{amigo\+\_\+seek@{amigo\+\_\+seek}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+seek(\+A\+M\+I\+G\+O\+State\+Type $\ast$p)}{amigo_seek(AMIGOStateType *p)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+seek (
\begin{DoxyParamCaption}
\item[{{\bf A\+M\+I\+G\+O\+State\+Type} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a17be7a7fc76ab2dc6018801be855e1d5}{}\label{amigo_8h_a17be7a7fc76ab2dc6018801be855e1d5}


Seek to the position held in the disk structure. 


\begin{DoxyItemize}
\item Reference\+: A27.
\item We should not commit bad head/sector/cylinder values until tested!..
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p} & \hyperlink{structAMIGOStateType}{A\+M\+I\+G\+O\+State\+Type} (Current Disk Position) pointer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 ok 

1 error 
\end{DoxyReturn}


Definition at line 422 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+send\+\_\+logical\+\_\+address@{amigo\+\_\+send\+\_\+logical\+\_\+address}}
\index{amigo\+\_\+send\+\_\+logical\+\_\+address@{amigo\+\_\+send\+\_\+logical\+\_\+address}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+send\+\_\+logical\+\_\+address(void)}{amigo_send_logical_address(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+send\+\_\+logical\+\_\+address (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a7c6a930fa7cc03f1e926ae99dbe1881c}{}\label{amigo_8h_a7c6a930fa7cc03f1e926ae99dbe1881c}


Send current address in A\+M\+I\+G\+O\+State.\+logical\+\_\+address\mbox{[}\mbox{]}. 


\begin{DoxyItemize}
\item Reference\+: A15-\/\+A19.
\item State\+: Execute \begin{DoxyReturn}{Returns}
0 on sucess 

status G\+P\+IB error flags on fail 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib_8h}{gpib.\+h} \hyperlink{gpib_8h_a10916ab21f8ba06e447e898790ef6a4b}{E\+R\+R\+O\+R\+\_\+\+M\+A\+SK} defines for a full list. 
\end{DoxySeeAlso}

\end{DoxyItemize}

Definition at line 266 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Execute().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+send\+\_\+status@{amigo\+\_\+send\+\_\+status}}
\index{amigo\+\_\+send\+\_\+status@{amigo\+\_\+send\+\_\+status}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+send\+\_\+status(void)}{amigo_send_status(void)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+send\+\_\+status (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_af4df946daf08c99b2d3b85318c9e9df8}{}\label{amigo_8h_af4df946daf08c99b2d3b85318c9e9df8}


Send drive status in A\+M\+I\+G\+O\+State.\+status\mbox{[}\mbox{]}. 


\begin{DoxyItemize}
\item Reference\+: A15-\/\+A19.
\item State\+: Execute$>$ \begin{DoxyReturn}{Returns}
0 

status G\+P\+IB error flags on fail 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{gpib_8h}{gpib.\+h} \hyperlink{gpib_8h_a10916ab21f8ba06e447e898790ef6a4b}{E\+R\+R\+O\+R\+\_\+\+M\+A\+SK} defines for a full list. 
\end{DoxySeeAlso}

\end{DoxyItemize}

Definition at line 303 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Execute().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+todo@{amigo\+\_\+todo}}
\index{amigo\+\_\+todo@{amigo\+\_\+todo}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+todo(uint8\+\_\+t secondary)}{amigo_todo(uint8_t secondary)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+todo (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{secondary}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a437bef06e567b3f6728f2519b9065354}{}\label{amigo_8h_a437bef06e567b3f6728f2519b9065354}


Report any Unimplimented commands. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em secondary} & G\+P\+IB seconday command\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 829 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Execute().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+todo\+\_\+op@{amigo\+\_\+todo\+\_\+op}}
\index{amigo\+\_\+todo\+\_\+op@{amigo\+\_\+todo\+\_\+op}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+todo\+\_\+op(uint8\+\_\+t secondary, uint8\+\_\+t opcode, int len)}{amigo_todo_op(uint8_t secondary, uint8_t opcode, int len)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+todo\+\_\+op (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{secondary, }
\item[{uint8\+\_\+t}]{opcode, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_a6c99539773ae8be3bd4d3bd7493c16d6}{}\label{amigo_8h_a6c99539773ae8be3bd4d3bd7493c16d6}


Report any Unimplimented commands with Op Codes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em secondary} & G\+P\+IB secondary command \\
\hline
\mbox{\tt in}  & {\em opcode} & G\+P\+IB data byte OP Code \\
\hline
\mbox{\tt in}  & {\em len} & Length of G\+O\+IB data returned \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}


Definition at line 804 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

\index{amigo.\+h@{amigo.\+h}!amigo\+\_\+verify@{amigo\+\_\+verify}}
\index{amigo\+\_\+verify@{amigo\+\_\+verify}!amigo.\+h@{amigo.\+h}}
\subsubsection[{\texorpdfstring{amigo\+\_\+verify(uint16\+\_\+t sectors)}{amigo_verify(uint16_t sectors)}}]{\setlength{\rightskip}{0pt plus 5cm}int amigo\+\_\+verify (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{sectors}
\end{DoxyParamCaption}
)}\hypertarget{amigo_8h_ab08912bf94dc6e8fbe87990ff41f46f0}{}\label{amigo_8h_ab08912bf94dc6e8fbe87990ff41f46f0}


Verify Disk Sectors at current position. 


\begin{DoxyItemize}
\item Refernce\+: A36 \begin{DoxyReturn}{Returns}
0 ok 

1 Error, Sets dsj and Amigo\+\_\+errors 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 450 of file amigo.\+c.



Referenced by Amigo\+\_\+\+Command().

