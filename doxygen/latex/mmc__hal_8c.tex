\hypertarget{mmc__hal_8c}{}\doxysection{fatfs.\+hal/mmc\+\_\+hal.c File Reference}
\label{mmc__hal_8c}\index{fatfs.hal/mmc\_hal.c@{fatfs.hal/mmc\_hal.c}}
{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mathio.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}time.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}timer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}fatfs.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task}} (void)
\begin{DoxyCompactList}\small\item\em 1000HZ timer task \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void \mbox{\hyperlink{mmc__hal_8c_a35434a6e722b07d8fee213c2256391be}{mmc\+\_\+install\+\_\+timer}} (void)
\begin{DoxyCompactList}\small\item\em Install M\+MC timer task\+: \mbox{\hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()}} \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_ae9d8b33ee8fd54f03d5d6946d6022df9}{mmc\+\_\+spi\+\_\+init}} ()
\begin{DoxyCompactList}\small\item\em M\+MC S\+PI setup and chip select. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_a6baca506fd7fb368a968a82e9093b4a0}{mmc\+\_\+spi\+\_\+begin}} ()
\begin{DoxyCompactList}\small\item\em M\+MC S\+PI setup and chip select. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_a3ef82f5ac21c4adcf55addccf88f3d5a}{mmc\+\_\+spi\+\_\+end}} ()
\begin{DoxyCompactList}\small\item\em M\+MC S\+PI end and chip deselect. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_a120c1501f6694e4947cb37f09679dda9}{mmc\+\_\+slow}} ()
\begin{DoxyCompactList}\small\item\em M\+MC set slow S\+PI bus speed Only called when deselected. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_a7d41efb1efa51ca4c815ee275553ecae}{mmc\+\_\+fast}} ()
\begin{DoxyCompactList}\small\item\em M\+MC fast S\+PI bus speed Only called when deselected. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_a850895a4f23c495249a3074fd2dafbcb}{mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer}} (const uint8\+\_\+t $\ast$data, int count)
\begin{DoxyCompactList}\small\item\em S\+PI write buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{mmc__hal_8c_ac5b4aae5665fe63d3d0a280215f759f8}{mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer}} (const uint8\+\_\+t $\ast$data, int count)
\begin{DoxyCompactList}\small\item\em S\+PI read buffer. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{mmc__hal_8c_a8f6b7c1f3819cd4bd2aa114c8ebb7f19}{mmc\+\_\+spi\+\_\+\+T\+X\+RX}} (uint8\+\_\+t data)
\begin{DoxyCompactList}\small\item\em S\+PI read and write 1 byte. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void \mbox{\hyperlink{mmc__hal_8c_a95af3dbb0e5e0a16710138786c29fb4f}{mmc\+\_\+set\+\_\+ms\+\_\+timeout}} (uint16\+\_\+t ms)
\begin{DoxyCompactList}\small\item\em Set M\+MC timeout timer in Milliseconds. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int \mbox{\hyperlink{mmc__hal_8c_a7383533f1b6630ff4f0337f400b4b62e}{mmc\+\_\+test\+\_\+timeout}} ()
\begin{DoxyCompactList}\small\item\em Wait for timeout. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void \mbox{\hyperlink{mmc__hal_8c_abb3b85d2e3abc4df68487df05510bb55}{mmc\+\_\+ms\+\_\+wait}} (int ms)
\begin{DoxyCompactList}\small\item\em Wait for time in milliseconds. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int \mbox{\hyperlink{mmc__hal_8c_ad417477e66c88b40dcce683fd6a5c47a}{mmc\+\_\+init}} (int verbose)
\begin{DoxyCompactList}\small\item\em Initialize M\+MC and Fat\+Fs interface, display diagnostics. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void \mbox{\hyperlink{mmc__hal_8c_a5ebdcf7dd5b0f47163d20481a5d09e00}{mmc\+\_\+power\+\_\+on}} ()
\begin{DoxyCompactList}\small\item\em M\+MC Power ON. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void \mbox{\hyperlink{mmc__hal_8c_af1357b405b44e70bd22a537e67fc56db}{mmc\+\_\+power\+\_\+off}} ()
\begin{DoxyCompactList}\small\item\em M\+MC Power O\+FF. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int \mbox{\hyperlink{mmc__hal_8c_a76337667431fa723bc6d50503a52f8e0}{mmc\+\_\+ins\+\_\+status}} ()
\begin{DoxyCompactList}\small\item\em M\+MC Card Inserted status. \end{DoxyCompactList}\item 
\mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int \mbox{\hyperlink{mmc__hal_8c_acbc9faece423623a86f62b50ac59b312}{mmc\+\_\+wp\+\_\+status}} ()
\begin{DoxyCompactList}\small\item\em M\+MC Card Write Protect status. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{diskio_8h_adba6790898ce4029c20a34b898ce73c1}{D\+S\+T\+A\+T\+US}} \mbox{\hyperlink{mmc__hal_8c_a5e05b0c3f7ba56fa9c23be08c497eb9f}{Stat}}
\item 
uint16\+\_\+t \mbox{\hyperlink{mmc__hal_8c_abf71973875545f3b42702ac99d5d87ef}{\+\_\+mmc\+\_\+timeout}} = 0
\begin{DoxyCompactList}\small\item\em M\+MC timeout counter in ms. \end{DoxyCompactList}\item 
uint32\+\_\+t \mbox{\hyperlink{mmc__hal_8c_a72ddc159b1a36ffda342f0f2d5c144f4}{\+\_\+mmc\+\_\+clock}} = 0
\begin{DoxyCompactList}\small\item\em M\+MC S\+PI C\+L\+O\+CK cache. \end{DoxyCompactList}\item 
uint16\+\_\+t \mbox{\hyperlink{mmc__hal_8c_adc0a07c5ad80e8ecbabee0cf04a1564e}{\+\_\+mmc\+\_\+pre}} = 0
\item 
static int \mbox{\hyperlink{mmc__hal_8c_a530d484dee6be1fc954f32f677add7c4}{mmc\+\_\+init\+\_\+flag}} = 0
\begin{DoxyCompactList}\small\item\em has the M\+MC interface been initialized yet ? \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{mmc__hal_8c_a7d41efb1efa51ca4c815ee275553ecae}\label{mmc__hal_8c_a7d41efb1efa51ca4c815ee275553ecae}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_fast@{mmc\_fast}}
\index{mmc\_fast@{mmc\_fast}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_fast()}{mmc\_fast()}}
{\footnotesize\ttfamily void mmc\+\_\+fast (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC fast S\+PI bus speed Only called when deselected. 


\begin{DoxyItemize}
\item Used during normal file IO phases \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 129 of file mmc\+\_\+hal.\+c.

\mbox{\Hypertarget{mmc__hal_8c_ad417477e66c88b40dcce683fd6a5c47a}\label{mmc__hal_8c_ad417477e66c88b40dcce683fd6a5c47a}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_init@{mmc\_init}}
\index{mmc\_init@{mmc\_init}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_init()}{mmc\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int mmc\+\_\+init (\begin{DoxyParamCaption}\item[{int}]{verbose }\end{DoxyParamCaption})}



Initialize M\+MC and Fat\+Fs interface, display diagnostics. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em verbose} & display initialisation messages \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 219 of file mmc\+\_\+hal.\+c.



Referenced by fatfs\+\_\+tests(), main(), and open().

\mbox{\Hypertarget{mmc__hal_8c_a76337667431fa723bc6d50503a52f8e0}\label{mmc__hal_8c_a76337667431fa723bc6d50503a52f8e0}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_ins\_status@{mmc\_ins\_status}}
\index{mmc\_ins\_status@{mmc\_ins\_status}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_ins\_status()}{mmc\_ins\_status()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int mmc\+\_\+ins\+\_\+status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC Card Inserted status. 


\begin{DoxyItemize}
\item We do not detect card insert status in this project. \begin{DoxyReturn}{Returns}
1 card inserted 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 328 of file mmc\+\_\+hal.\+c.



Referenced by gpib\+\_\+error\+\_\+test(), mmc\+\_\+init(), and mmc\+\_\+task().

\mbox{\Hypertarget{mmc__hal_8c_a35434a6e722b07d8fee213c2256391be}\label{mmc__hal_8c_a35434a6e722b07d8fee213c2256391be}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_install\_timer@{mmc\_install\_timer}}
\index{mmc\_install\_timer@{mmc\_install\_timer}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_install\_timer()}{mmc\_install\_timer()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void mmc\+\_\+install\+\_\+timer (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Install M\+MC timer task\+: \mbox{\hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()}} 

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}{mmc\+\_\+task()}} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 82 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+init().

\mbox{\Hypertarget{mmc__hal_8c_abb3b85d2e3abc4df68487df05510bb55}\label{mmc__hal_8c_abb3b85d2e3abc4df68487df05510bb55}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_ms\_wait@{mmc\_ms\_wait}}
\index{mmc\_ms\_wait@{mmc\_ms\_wait}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_ms\_wait()}{mmc\_ms\_wait()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void mmc\+\_\+ms\+\_\+wait (\begin{DoxyParamCaption}\item[{int}]{ms }\end{DoxyParamCaption})}



Wait for time in milliseconds. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ms} & timeout in Milliseconds \\
\hline
\end{DoxyParams}


Definition at line 204 of file mmc\+\_\+hal.\+c.

\mbox{\Hypertarget{mmc__hal_8c_af1357b405b44e70bd22a537e67fc56db}\label{mmc__hal_8c_af1357b405b44e70bd22a537e67fc56db}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_power\_off@{mmc\_power\_off}}
\index{mmc\_power\_off@{mmc\_power\_off}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_power\_off()}{mmc\_power\_off()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void mmc\+\_\+power\+\_\+off (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC Power O\+FF. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 317 of file mmc\+\_\+hal.\+c.



Referenced by power\+\_\+off().

\mbox{\Hypertarget{mmc__hal_8c_a5ebdcf7dd5b0f47163d20481a5d09e00}\label{mmc__hal_8c_a5ebdcf7dd5b0f47163d20481a5d09e00}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_power\_on@{mmc\_power\_on}}
\index{mmc\_power\_on@{mmc\_power\_on}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_power\_on()}{mmc\_power\_on()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void mmc\+\_\+power\+\_\+on (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC Power ON. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 308 of file mmc\+\_\+hal.\+c.



Referenced by power\+\_\+on().

\mbox{\Hypertarget{mmc__hal_8c_a95af3dbb0e5e0a16710138786c29fb4f}\label{mmc__hal_8c_a95af3dbb0e5e0a16710138786c29fb4f}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_set\_ms\_timeout@{mmc\_set\_ms\_timeout}}
\index{mmc\_set\_ms\_timeout@{mmc\_set\_ms\_timeout}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_set\_ms\_timeout()}{mmc\_set\_ms\_timeout()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} void mmc\+\_\+set\+\_\+ms\+\_\+timeout (\begin{DoxyParamCaption}\item[{uint16\+\_\+t}]{ms }\end{DoxyParamCaption})}



Set M\+MC timeout timer in Milliseconds. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ms} & timeout in Milliseconds \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{mmc__hal_8c_a7383533f1b6630ff4f0337f400b4b62e}{mmc\+\_\+test\+\_\+timeout}} ( ) 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 169 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+ms\+\_\+wait(), rcvr\+\_\+datablock(), and wait\+\_\+ready().

\mbox{\Hypertarget{mmc__hal_8c_a120c1501f6694e4947cb37f09679dda9}\label{mmc__hal_8c_a120c1501f6694e4947cb37f09679dda9}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_slow@{mmc\_slow}}
\index{mmc\_slow@{mmc\_slow}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_slow()}{mmc\_slow()}}
{\footnotesize\ttfamily void mmc\+\_\+slow (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC set slow S\+PI bus speed Only called when deselected. 


\begin{DoxyItemize}
\item Used during card detect phase \begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 119 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+spi\+\_\+init().

\mbox{\Hypertarget{mmc__hal_8c_a6baca506fd7fb368a968a82e9093b4a0}\label{mmc__hal_8c_a6baca506fd7fb368a968a82e9093b4a0}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_begin@{mmc\_spi\_begin}}
\index{mmc\_spi\_begin@{mmc\_spi\_begin}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_begin()}{mmc\_spi\_begin()}}
{\footnotesize\ttfamily void mmc\+\_\+spi\+\_\+begin (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC S\+PI setup and chip select. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 101 of file mmc\+\_\+hal.\+c.

\mbox{\Hypertarget{mmc__hal_8c_a3ef82f5ac21c4adcf55addccf88f3d5a}\label{mmc__hal_8c_a3ef82f5ac21c4adcf55addccf88f3d5a}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_end@{mmc\_spi\_end}}
\index{mmc\_spi\_end@{mmc\_spi\_end}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_end()}{mmc\_spi\_end()}}
{\footnotesize\ttfamily void mmc\+\_\+spi\+\_\+end (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC S\+PI end and chip deselect. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 109 of file mmc\+\_\+hal.\+c.

\mbox{\Hypertarget{mmc__hal_8c_ae9d8b33ee8fd54f03d5d6946d6022df9}\label{mmc__hal_8c_ae9d8b33ee8fd54f03d5d6946d6022df9}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_init@{mmc\_spi\_init}}
\index{mmc\_spi\_init@{mmc\_spi\_init}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_init()}{mmc\_spi\_init()}}
{\footnotesize\ttfamily void mmc\+\_\+spi\+\_\+init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC S\+PI setup and chip select. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 92 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+init().

\mbox{\Hypertarget{mmc__hal_8c_ac5b4aae5665fe63d3d0a280215f759f8}\label{mmc__hal_8c_ac5b4aae5665fe63d3d0a280215f759f8}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_RX\_buffer@{mmc\_spi\_RX\_buffer}}
\index{mmc\_spi\_RX\_buffer@{mmc\_spi\_RX\_buffer}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_RX\_buffer()}{mmc\_spi\_RX\_buffer()}}
{\footnotesize\ttfamily void mmc\+\_\+spi\+\_\+\+R\+X\+\_\+buffer (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{count }\end{DoxyParamCaption})}



S\+PI read buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$data} & transmit buffer \\
\hline
\mbox{\texttt{ in}}  & {\em count} & number of bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 149 of file mmc\+\_\+hal.\+c.



Referenced by rcvr\+\_\+spi\+\_\+multi().

\mbox{\Hypertarget{mmc__hal_8c_a850895a4f23c495249a3074fd2dafbcb}\label{mmc__hal_8c_a850895a4f23c495249a3074fd2dafbcb}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_TX\_buffer@{mmc\_spi\_TX\_buffer}}
\index{mmc\_spi\_TX\_buffer@{mmc\_spi\_TX\_buffer}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_TX\_buffer()}{mmc\_spi\_TX\_buffer()}}
{\footnotesize\ttfamily void mmc\+\_\+spi\+\_\+\+T\+X\+\_\+buffer (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{count }\end{DoxyParamCaption})}



S\+PI write buffer. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em $\ast$data} & transmit buffer \\
\hline
\mbox{\texttt{ in}}  & {\em count} & number of bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 139 of file mmc\+\_\+hal.\+c.



Referenced by xmit\+\_\+spi\+\_\+multi().

\mbox{\Hypertarget{mmc__hal_8c_a8f6b7c1f3819cd4bd2aa114c8ebb7f19}\label{mmc__hal_8c_a8f6b7c1f3819cd4bd2aa114c8ebb7f19}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_spi\_TXRX@{mmc\_spi\_TXRX}}
\index{mmc\_spi\_TXRX@{mmc\_spi\_TXRX}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_spi\_TXRX()}{mmc\_spi\_TXRX()}}
{\footnotesize\ttfamily uint8\+\_\+t mmc\+\_\+spi\+\_\+\+T\+X\+RX (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{data }\end{DoxyParamCaption})}



S\+PI read and write 1 byte. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em data} & value to transmit \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t value read 
\end{DoxyReturn}


Definition at line 158 of file mmc\+\_\+hal.\+c.



Referenced by xchg\+\_\+spi().

\mbox{\Hypertarget{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}\label{mmc__hal_8c_a3371d3911fed5af510a9b6e313773171}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_task@{mmc\_task}}
\index{mmc\_task@{mmc\_task}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_task()}{mmc\_task()}}
{\footnotesize\ttfamily static void mmc\+\_\+task (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



1000HZ timer task 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 59 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+install\+\_\+timer().

\mbox{\Hypertarget{mmc__hal_8c_a7383533f1b6630ff4f0337f400b4b62e}\label{mmc__hal_8c_a7383533f1b6630ff4f0337f400b4b62e}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_test\_timeout@{mmc\_test\_timeout}}
\index{mmc\_test\_timeout@{mmc\_test\_timeout}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_test\_timeout()}{mmc\_test\_timeout()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int mmc\+\_\+test\+\_\+timeout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Wait for timeout. 

\begin{DoxyReturn}{Returns}
1 ready 

0 timeout 
\end{DoxyReturn}


Definition at line 181 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+ms\+\_\+wait(), rcvr\+\_\+datablock(), and wait\+\_\+ready().

\mbox{\Hypertarget{mmc__hal_8c_acbc9faece423623a86f62b50ac59b312}\label{mmc__hal_8c_acbc9faece423623a86f62b50ac59b312}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_wp\_status@{mmc\_wp\_status}}
\index{mmc\_wp\_status@{mmc\_wp\_status}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_wp\_status()}{mmc\_wp\_status()}}
{\footnotesize\ttfamily \mbox{\hyperlink{mmc__hal_8h_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE}} int mmc\+\_\+wp\+\_\+status (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



M\+MC Card Write Protect status. 


\begin{DoxyItemize}
\item We do not detect card write protect status in this project. \begin{DoxyReturn}{Returns}
0 == not write protected 
\end{DoxyReturn}

\end{DoxyItemize}

Definition at line 344 of file mmc\+\_\+hal.\+c.



Referenced by gpib\+\_\+file\+\_\+init(), and S\+S80\+\_\+locate\+\_\+and\+\_\+write().



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{mmc__hal_8c_a72ddc159b1a36ffda342f0f2d5c144f4}\label{mmc__hal_8c_a72ddc159b1a36ffda342f0f2d5c144f4}} 
\index{mmc\_hal.c@{mmc\_hal.c}!\_mmc\_clock@{\_mmc\_clock}}
\index{\_mmc\_clock@{\_mmc\_clock}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{\_mmc\_clock}{\_mmc\_clock}}
{\footnotesize\ttfamily uint32\+\_\+t \+\_\+mmc\+\_\+clock = 0}



M\+MC S\+PI C\+L\+O\+CK cache. 



Definition at line 50 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+fast(), mmc\+\_\+slow(), and mmc\+\_\+spi\+\_\+begin().

\mbox{\Hypertarget{mmc__hal_8c_adc0a07c5ad80e8ecbabee0cf04a1564e}\label{mmc__hal_8c_adc0a07c5ad80e8ecbabee0cf04a1564e}} 
\index{mmc\_hal.c@{mmc\_hal.c}!\_mmc\_pre@{\_mmc\_pre}}
\index{\_mmc\_pre@{\_mmc\_pre}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{\_mmc\_pre}{\_mmc\_pre}}
{\footnotesize\ttfamily uint16\+\_\+t \+\_\+mmc\+\_\+pre = 0}



Definition at line 53 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+task().

\mbox{\Hypertarget{mmc__hal_8c_abf71973875545f3b42702ac99d5d87ef}\label{mmc__hal_8c_abf71973875545f3b42702ac99d5d87ef}} 
\index{mmc\_hal.c@{mmc\_hal.c}!\_mmc\_timeout@{\_mmc\_timeout}}
\index{\_mmc\_timeout@{\_mmc\_timeout}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{\_mmc\_timeout}{\_mmc\_timeout}}
{\footnotesize\ttfamily uint16\+\_\+t \+\_\+mmc\+\_\+timeout = 0}



M\+MC timeout counter in ms. 



Definition at line 47 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+install\+\_\+timer(), mmc\+\_\+set\+\_\+ms\+\_\+timeout(), mmc\+\_\+task(), and mmc\+\_\+test\+\_\+timeout().

\mbox{\Hypertarget{mmc__hal_8c_a530d484dee6be1fc954f32f677add7c4}\label{mmc__hal_8c_a530d484dee6be1fc954f32f677add7c4}} 
\index{mmc\_hal.c@{mmc\_hal.c}!mmc\_init\_flag@{mmc\_init\_flag}}
\index{mmc\_init\_flag@{mmc\_init\_flag}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{mmc\_init\_flag}{mmc\_init\_flag}}
{\footnotesize\ttfamily int mmc\+\_\+init\+\_\+flag = 0\hspace{0.3cm}{\ttfamily [static]}}



has the M\+MC interface been initialized yet ? 



Definition at line 213 of file mmc\+\_\+hal.\+c.



Referenced by mmc\+\_\+init().

\mbox{\Hypertarget{mmc__hal_8c_a5e05b0c3f7ba56fa9c23be08c497eb9f}\label{mmc__hal_8c_a5e05b0c3f7ba56fa9c23be08c497eb9f}} 
\index{mmc\_hal.c@{mmc\_hal.c}!Stat@{Stat}}
\index{Stat@{Stat}!mmc\_hal.c@{mmc\_hal.c}}
\doxysubsubsection{\texorpdfstring{Stat}{Stat}}
{\footnotesize\ttfamily \mbox{\hyperlink{diskio_8h_adba6790898ce4029c20a34b898ce73c1}{D\+S\+T\+A\+T\+US}} Stat}



Definition at line 78 of file mmc.\+c.



Referenced by mmc\+\_\+disk\+\_\+initialize(), mmc\+\_\+disk\+\_\+read(), mmc\+\_\+disk\+\_\+status(), mmc\+\_\+disk\+\_\+timerproc(), mmc\+\_\+init(), and mmc\+\_\+test\+\_\+timeout().

