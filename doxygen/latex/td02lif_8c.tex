\hypertarget{td02lif_8c}{}\section{lif/td02lif.c File Reference}
\label{td02lif_8c}\index{lif/td02lif.\+c@{lif/td02lif.\+c}}


Tele\+Disk decoder library targetting L\+IF format images only.  


{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$inttypes.\+h$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include \char`\"{}lifsup.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lifutils.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}td02lif.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}td0\+\_\+lzss.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}{td0\+\_\+unpack\+\_\+disk\+\_\+header} (uint8\+\_\+t $\ast$B, \hyperlink{structtd__header__t}{td\+\_\+header\+\_\+t} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk image header data in architecture nutral way. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}{td0\+\_\+unpack\+\_\+comment\+\_\+header} (uint8\+\_\+t $\ast$B, \hyperlink{structtd__comment__t}{td\+\_\+comment\+\_\+t} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk comment header data in architecture nutral way. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}{td0\+\_\+unpack\+\_\+track\+\_\+header} (uint8\+\_\+t $\ast$B, \hyperlink{structtd__track__t}{td\+\_\+track\+\_\+t} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk track header data in architecture nutral way. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_ac393151af482d511b246de534da58e6f}{td0\+\_\+unpack\+\_\+sector\+\_\+header} (uint8\+\_\+t $\ast$B, \hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t} $\ast$p)
\begin{DoxyCompactList}\small\item\em Extract Tele\+Disk sector header data in architecture nutral way. \end{DoxyCompactList}\item 
void \hyperlink{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}{td0\+\_\+compressed} (int flag)
\begin{DoxyCompactList}\small\item\em Enable Tele\+Disk image compression mode. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}{td0\+\_\+read} (void $\ast$p, int osize, int size, \hyperlink{posix_8h_aed4dabeb9f7c518ded42f930a04abce8}{F\+I\+LE} $\ast$fp)
\begin{DoxyCompactList}\small\item\em Read Tele\+Disk image data block Optionally decompress the data if decompression is enabled. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}{td0\+\_\+rle} (uint8\+\_\+t $\ast$\hyperlink{time_8c_a5a388b2bb2a2a9914c7d68ed3d09f7e9}{dst}, uint8\+\_\+t $\ast$src, int max)
\begin{DoxyCompactList}\small\item\em Expand a Run Length encoded Tele\+Disk sector Notes\+: the source length is encoded in the source data Credits based on work (C) 2006-\/2014 Jean-\/\+François D\+EL N\+E\+RO Part of the Hx\+C\+Floppy\+Emulator library G\+NU G\+PL version 2 or later Rewitten for clarity,to enforce size limits, provide error reporting and to avoid word order dependent assumptions,. \end{DoxyCompactList}\item 
void \hyperlink{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}{td0\+\_\+trackinfo} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}, int trackind, int index)
\begin{DoxyCompactList}\small\item\em Display Tele\+Disk track sector values. \end{DoxyCompactList}\item 
void \hyperlink{td02lif_8c_aff9adf4831cee8528e02b6456459435e}{td0\+\_\+sectorinfo} (\hyperlink{structtd__sector__t}{td\+\_\+sector\+\_\+t} $\ast$P)
\begin{DoxyCompactList}\small\item\em Display Tele\+Disk sector data. \end{DoxyCompactList}\item 
long \hyperlink{td02lif_8c_a48825de35a808127b9c304a764a48439}{td0\+\_\+density2bitrate} (uint8\+\_\+t density)
\begin{DoxyCompactList}\small\item\em Convert Denisity to bitrate  don\textquotesingle{}t care about the density except as a possible filter. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}{td0\+\_\+open} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}, char $\ast$name)
\begin{DoxyCompactList}\small\item\em Opne Tele\+Disk image file process header and optional comment block. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}{td0\+\_\+read\+\_\+disk} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk})
\begin{DoxyCompactList}\small\item\em Read Tele\+Disk image file and save all sector data. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}{td0\+\_\+analize\+\_\+format} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk})
\begin{DoxyCompactList}\small\item\em Analize Tele\+Disk disk sector data Problem\+: We may a disk reformatted multiple times Each format may have used differing sector sizes, number of tracks, sides For example\+: First format 80 track disk, two sided, and 9 512 byte sectors per track Second format 35 tracks, single sided, 16 sectors 256 bytes size per track Clearly we only want the 35 tracks on the first side. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a2b045f601a00f806f99e466e18109a08}{td0\+\_\+save\+\_\+lif} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}, \hyperlink{structlif__t}{lif\+\_\+t} $\ast$L\+IF)
\begin{DoxyCompactList}\small\item\em save remaining sectors as L\+IF data \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}{td0\+\_\+save\+\_\+lif\+\_\+sector} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}, uint8\+\_\+t $\ast$data, int size, \hyperlink{structlif__t}{lif\+\_\+t} $\ast$L\+IF)
\begin{DoxyCompactList}\small\item\em Process all sectors on a track from Tele\+Disk image. \end{DoxyCompactList}\item 
void \hyperlink{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}{td0\+\_\+help} (int full)
\item 
void \hyperlink{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}{td0\+\_\+init\+\_\+liftel} ()
\begin{DoxyCompactList}\small\item\em Tele\+Disk image Analisis structure Find attributes of L\+IF image stored in Tele\+Disk image. \end{DoxyCompactList}\item 
void \hyperlink{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}{td0\+\_\+init\+\_\+sectors} (\hyperlink{structdisk__t}{disk\+\_\+t} $\ast$\hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk})
\begin{DoxyCompactList}\small\item\em Initialize track sector information Optionally decompress the data if decompression is enabled. \end{DoxyCompactList}\item 
int \hyperlink{td02lif_8c_a768caca68199c490335ee088781e7bba}{td02lif} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Convert a Teledisk L\+IF formatted disk image into a pure L\+IF image. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structdisk__t}{disk\+\_\+t} \hyperlink{td02lif_8c_affcceda12b139f26819f4929be705eb1}{disk}
\begin{DoxyCompactList}\small\item\em Dave Dunfiled L\+Z\+SS expander. \end{DoxyCompactList}\item 
\hyperlink{structliftel__t}{liftel\+\_\+t} \hyperlink{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}{liftel}
\begin{DoxyCompactList}\small\item\em Teledisk liftel analisis and user overrides. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Tele\+Disk decoder library targetting L\+IF format images only. 

\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2017 Mike Gore, Inc. All rights reserved. G\+PL}

\end{DoxyParagraph}
\begin{DoxySeeAlso}{See also}
\href{http://github.com/magore/hp85disk}{\tt http\+://github.\+com/magore/hp85disk} 

\href{http://github.com/magore/hp85disk/COPYRIGHT.md}{\tt http\+://github.\+com/magore/hp85disk/\+C\+O\+P\+Y\+R\+I\+G\+H\+T.\+md} for Copyright details
\end{DoxySeeAlso}
L\+IF command help lif td02lif image.\+td0 image.\+lif Convert Tele\+Disk encoded L\+IF disk image into to pure L\+IF image T\+E\+L\+E\+D\+I\+SK command help td02lif file.\+td0 file.\+lif Convert Tele\+Disk encoded L\+IF disk image into to pure L\+IF image

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
lif/teledisk My T\+E\+L\+E\+D\+I\+SK L\+IF extracter Note\+: The Tele\+Disk image M\+U\+ST contain a L\+IF image -\/ we do N\+OT translate it R\+E\+A\+D\+M\+E.\+txt Credits Important Contributions (My converted would not have been possible without these) Dave Dunfield, L\+Z\+SS Code and Tele\+Disk documentation Copyright 2007-\/2008 Dave Dunfield All rights reserved. td0\+\_\+lzss.\+h td0\+\_\+lzss.\+c L\+Z\+SS decoder td0notes.\+txt Teledisk Documentation Jean-\/\+Franois D\+EL N\+E\+RO, Tele\+Disk Documentation Copyright (C) 2006-\/2014 Jean-\/\+Franois D\+EL N\+E\+RO wteledsk.\+htm Tele\+Disk documenation See his github project \href{https://github.com/jfdelnero/libhxcfe}{\tt https\+://github.\+com/jfdelnero/libhxcfe} 

\subsection{Function Documentation}
\index{td02lif.\+c@{td02lif.\+c}!td02lif@{td02lif}}
\index{td02lif@{td02lif}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td02lif(int argc, char $\ast$argv[])}{td02lif(int argc, char *argv[])}}]{\setlength{\rightskip}{0pt plus 5cm}int td02lif (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a768caca68199c490335ee088781e7bba}{}\label{td02lif_8c_a768caca68199c490335ee088781e7bba}


Convert a Teledisk L\+IF formatted disk image into a pure L\+IF image. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em telediskname} & T\+E\+L\+E\+D\+I\+SK image name \\
\hline
\mbox{\tt in}  & {\em lifname} & L\+IF file name to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 on error 
\end{DoxyReturn}
Write L\+IF file

L\+IF summary

Close L\+IF file 

Definition at line 1572 of file td02lif.\+c.



Referenced by lif\+\_\+tests().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+analize\+\_\+format@{td0\+\_\+analize\+\_\+format}}
\index{td0\+\_\+analize\+\_\+format@{td0\+\_\+analize\+\_\+format}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+analize\+\_\+format(disk\+\_\+t $\ast$disk)}{td0_analize_format(disk_t *disk)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+analize\+\_\+format (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}{}\label{td02lif_8c_ac777daf6e56deb920d24ac72f83f0624}


Analize Tele\+Disk disk sector data Problem\+: We may a disk reformatted multiple times Each format may have used differing sector sizes, number of tracks, sides For example\+: First format 80 track disk, two sided, and 9 512 byte sectors per track Second format 35 tracks, single sided, 16 sectors 256 bytes size per track Clearly we only want the 35 tracks on the first side. 

What we do is examine the first 30 tracks (note\+: 30 is just a safe number less then 35) On side 1, on 30 tracks Find first sector and save its size Reject sectors that do not match size Find Last sector matching size Count sectors matching size On side 2, on 30 tracks Reject sectors that do not match size Find first sector and save its size Find Last sector matching size Count sectors matching size

If the disk had two sides recorded in the header Reject second side if side sector counts do N\+OT match Reject second side if NO remaining sectors Reject second side if sector ranges do not match or continue in range


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dist} & T\+D0 image data  1 if OK, 0 on error \\
\hline
\end{DoxyParams}


Definition at line 808 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+compressed@{td0\+\_\+compressed}}
\index{td0\+\_\+compressed@{td0\+\_\+compressed}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+compressed(int flag)}{td0_compressed(int flag)}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+compressed (
\begin{DoxyParamCaption}
\item[{int}]{flag}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}{}\label{td02lif_8c_a786b280e1ac85ba19bcb2f4ca0d21ee3}


Enable Tele\+Disk image compression mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em flag} & compression anable/disable \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 162 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+density2bitrate@{td0\+\_\+density2bitrate}}
\index{td0\+\_\+density2bitrate@{td0\+\_\+density2bitrate}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+density2bitrate(uint8\+\_\+t density)}{td0_density2bitrate(uint8_t density)}}]{\setlength{\rightskip}{0pt plus 5cm}long td0\+\_\+density2bitrate (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{density}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a48825de35a808127b9c304a764a48439}{}\label{td02lif_8c_a48825de35a808127b9c304a764a48439}


Convert Denisity to bitrate  don\textquotesingle{}t care about the density except as a possible filter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Density} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bitrate 
\end{DoxyReturn}


Definition at line 378 of file td02lif.\+c.

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+help@{td0\+\_\+help}}
\index{td0\+\_\+help@{td0\+\_\+help}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+help(int full)}{td0_help(int full)}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+help (
\begin{DoxyParamCaption}
\item[{int}]{full}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}{}\label{td02lif_8c_a26d4f0afc5df75f388d93a9510ab39ee}


Definition at line 1478 of file td02lif.\+c.



Referenced by lif\+\_\+tests(), and td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+init\+\_\+liftel@{td0\+\_\+init\+\_\+liftel}}
\index{td0\+\_\+init\+\_\+liftel@{td0\+\_\+init\+\_\+liftel}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+init\+\_\+liftel()}{td0_init_liftel()}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+init\+\_\+liftel (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}{}\label{td02lif_8c_af8f1231cf42003200a45f8b6828f13c1}


Tele\+Disk image Analisis structure Find attributes of L\+IF image stored in Tele\+Disk image. 



Definition at line 1498 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+init\+\_\+sectors@{td0\+\_\+init\+\_\+sectors}}
\index{td0\+\_\+init\+\_\+sectors@{td0\+\_\+init\+\_\+sectors}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+init\+\_\+sectors(disk\+\_\+t $\ast$disk)}{td0_init_sectors(disk_t *disk)}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+init\+\_\+sectors (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}{}\label{td02lif_8c_a250c5e050c7c158c05611ba8dbf985a9}


Initialize track sector information Optionally decompress the data if decompression is enabled. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em p} & data buffer for read \\
\hline
\mbox{\tt out}  & {\em osize} & size of object \\
\hline
\mbox{\tt out}  & {\em size} & number of objects to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of dataactually read 
\end{DoxyReturn}


Definition at line 1534 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+open@{td0\+\_\+open}}
\index{td0\+\_\+open@{td0\+\_\+open}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+open(disk\+\_\+t $\ast$disk, char $\ast$name)}{td0_open(disk_t *disk, char *name)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+open (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk, }
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}{}\label{td02lif_8c_ab49e4bf7cf89d5c6b90181a6bac46de6}


Opne Tele\+Disk image file process header and optional comment block. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$disk} & Tele\+Disk information structure \\
\hline
\mbox{\tt in}  & {\em $\ast$name} & image file name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success 0 on error Note\+: on success disk-\/$>$fi has the file handle disk-\/$>$td0\+\_\+name has the file name disk-\/$>$compresssed if image is compressed disk-\/$>$td\+\_\+header has teledisk header disk-\/$>$td\+\_\+comment has optional teledisk comment header or zeroed If disk.\+td\+\_\+comment.\+Size $>$ 0 disk-\/$>$comment has optional comment string or empty string If disk.\+td\+\_\+comment.\+Size $>$ 0 
\end{DoxyReturn}
Tele\+Disk disk image header

we expect \char`\"{}\+T\+D\char`\"{} (uncompressed) or \char`\"{}td\char`\"{} (compressed) format

We only accept Tele\+Disk versions $>$= 10 \&\& version $<$= 21

Time to Unix format 

Definition at line 411 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+read@{td0\+\_\+read}}
\index{td0\+\_\+read@{td0\+\_\+read}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+read(void $\ast$p, int osize, int size, F\+I\+L\+E $\ast$fp)}{td0_read(void *p, int osize, int size, FILE *fp)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+read (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{p, }
\item[{int}]{osize, }
\item[{int}]{size, }
\item[{{\bf F\+I\+LE} $\ast$}]{fp}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}{}\label{td02lif_8c_a3f65dd34ac6cf2ee2ab6d5a913b0e457}


Read Tele\+Disk image data block Optionally decompress the data if decompression is enabled. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em p} & data buffer for read \\
\hline
\mbox{\tt out}  & {\em osize} & size of object \\
\hline
\mbox{\tt out}  & {\em size} & number of objects to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success all bytes read, 0 on failure not all bytes read 
\end{DoxyReturn}


Definition at line 175 of file td02lif.\+c.



Referenced by td0\+\_\+open(), and td0\+\_\+read\+\_\+disk().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+read\+\_\+disk@{td0\+\_\+read\+\_\+disk}}
\index{td0\+\_\+read\+\_\+disk@{td0\+\_\+read\+\_\+disk}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+read\+\_\+disk(disk\+\_\+t $\ast$disk)}{td0_read_disk(disk_t *disk)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+read\+\_\+disk (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}{}\label{td02lif_8c_a87120823fa3dd587214e6c70ebde151f}


Read Tele\+Disk image file and save all sector data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dist} & T\+D0 image data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success 0 on error 
\end{DoxyReturn}
Process all image Data

E\+OF? Tele\+Disk specification says E\+OF is 255 sectors

Process all track sectors

Sector Header

first test verifies sector $<$ 2K in size second test verifies no data or address mark errors

Compute how much data to read

td0\+\_\+rle does not use len internal data in the buffer does this We limit the expansion to sector size 



Definition at line 550 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+rle@{td0\+\_\+rle}}
\index{td0\+\_\+rle@{td0\+\_\+rle}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+rle(uint8\+\_\+t $\ast$dst, uint8\+\_\+t $\ast$src, int max)}{td0_rle(uint8_t *dst, uint8_t *src, int max)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+rle (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{dst, }
\item[{uint8\+\_\+t $\ast$}]{src, }
\item[{int}]{max}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}{}\label{td02lif_8c_a7f9b8f09a74778aafcef0ccfcf7e73e6}


Expand a Run Length encoded Tele\+Disk sector Notes\+: the source length is encoded in the source data Credits based on work (C) 2006-\/2014 Jean-\/\+François D\+EL N\+E\+RO Part of the Hx\+C\+Floppy\+Emulator library G\+NU G\+PL version 2 or later Rewitten for clarity,to enforce size limits, provide error reporting and to avoid word order dependent assumptions,. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em dst} & destination expanded data \\
\hline
\mbox{\tt in}  & {\em src} & source data \\
\hline
\mbox{\tt in}  & {\em max} & maximum size of destination data \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of expanded data, negative if size $>$ max 
\end{DoxyReturn}
length

block size

repeat count 

Definition at line 217 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+save\+\_\+lif@{td0\+\_\+save\+\_\+lif}}
\index{td0\+\_\+save\+\_\+lif@{td0\+\_\+save\+\_\+lif}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+save\+\_\+lif(disk\+\_\+t $\ast$disk, lif\+\_\+t $\ast$\+L\+I\+F)}{td0_save_lif(disk_t *disk, lif_t *LIF)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+save\+\_\+lif (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk, }
\item[{{\bf lif\+\_\+t} $\ast$}]{L\+IF}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a2b045f601a00f806f99e466e18109a08}{}\label{td02lif_8c_a2b045f601a00f806f99e466e18109a08}


save remaining sectors as L\+IF data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & sector data \\
\hline
\mbox{\tt in}  & {\em L\+IF} & L\+IF structure  1 if OK, 0 on error \\
\hline
\end{DoxyParams}


Definition at line 1221 of file td02lif.\+c.



Referenced by td02lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+save\+\_\+lif\+\_\+sector@{td0\+\_\+save\+\_\+lif\+\_\+sector}}
\index{td0\+\_\+save\+\_\+lif\+\_\+sector@{td0\+\_\+save\+\_\+lif\+\_\+sector}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+save\+\_\+lif\+\_\+sector(disk\+\_\+t $\ast$disk, uint8\+\_\+t $\ast$data, int size, lif\+\_\+t $\ast$\+L\+I\+F)}{td0_save_lif_sector(disk_t *disk, uint8_t *data, int size, lif_t *LIF)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+save\+\_\+lif\+\_\+sector (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk, }
\item[{uint8\+\_\+t $\ast$}]{data, }
\item[{int}]{size, }
\item[{{\bf lif\+\_\+t} $\ast$}]{L\+IF}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}{}\label{td02lif_8c_a08cbf8c12076d3677df348da2dbf7ca2}


Process all sectors on a track from Tele\+Disk image. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & sector data \\
\hline
\mbox{\tt in}  & {\em size} & sector size \\
\hline
\mbox{\tt in}  & {\em L\+IF} & L\+IF structure  1 if OK, 0 on error \\
\hline
\end{DoxyParams}
==================================================== Write sectors from Teledisk track to L\+IF file \subsection*{We continue until the last last file sector }

Definition at line 1285 of file td02lif.\+c.



Referenced by td0\+\_\+save\+\_\+lif().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+sectorinfo@{td0\+\_\+sectorinfo}}
\index{td0\+\_\+sectorinfo@{td0\+\_\+sectorinfo}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+sectorinfo(td\+\_\+sector\+\_\+t $\ast$\+P)}{td0_sectorinfo(td_sector_t *P)}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+sectorinfo (
\begin{DoxyParamCaption}
\item[{{\bf td\+\_\+sector\+\_\+t} $\ast$}]{P}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_aff9adf4831cee8528e02b6456459435e}{}\label{td02lif_8c_aff9adf4831cee8528e02b6456459435e}


Display Tele\+Disk sector data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P} & td\+\_\+sector pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 365 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+trackinfo@{td0\+\_\+trackinfo}}
\index{td0\+\_\+trackinfo@{td0\+\_\+trackinfo}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+trackinfo(disk\+\_\+t $\ast$disk, int trackind, int index)}{td0_trackinfo(disk_t *disk, int trackind, int index)}}]{\setlength{\rightskip}{0pt plus 5cm}void td0\+\_\+trackinfo (
\begin{DoxyParamCaption}
\item[{{\bf disk\+\_\+t} $\ast$}]{disk, }
\item[{int}]{trackind, }
\item[{int}]{index}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}{}\label{td02lif_8c_ab14f2a074ca85e1b32cc26f3369c574f}


Display Tele\+Disk track sector values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sector} & track sector structure \\
\hline
\mbox{\tt in}  & {\em index} & sector index (not sector number) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 352 of file td02lif.\+c.



Referenced by td0\+\_\+analize\+\_\+format(), and td0\+\_\+read\+\_\+disk().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+unpack\+\_\+comment\+\_\+header@{td0\+\_\+unpack\+\_\+comment\+\_\+header}}
\index{td0\+\_\+unpack\+\_\+comment\+\_\+header@{td0\+\_\+unpack\+\_\+comment\+\_\+header}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+unpack\+\_\+comment\+\_\+header(uint8\+\_\+t $\ast$\+B, td\+\_\+comment\+\_\+t $\ast$p)}{td0_unpack_comment_header(uint8_t *B, td_comment_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+unpack\+\_\+comment\+\_\+header (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{B, }
\item[{{\bf td\+\_\+comment\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}{}\label{td02lif_8c_aa2721b8d8bba4008a2b48d1b362b9850}


Extract Tele\+Disk comment header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B} & source data \\
\hline
\mbox{\tt out}  & {\em p} & Tele\+Disk comment header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk comment header size (not structure size) 
\end{DoxyReturn}


Definition at line 93 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+unpack\+\_\+disk\+\_\+header@{td0\+\_\+unpack\+\_\+disk\+\_\+header}}
\index{td0\+\_\+unpack\+\_\+disk\+\_\+header@{td0\+\_\+unpack\+\_\+disk\+\_\+header}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+unpack\+\_\+disk\+\_\+header(uint8\+\_\+t $\ast$\+B, td\+\_\+header\+\_\+t $\ast$p)}{td0_unpack_disk_header(uint8_t *B, td_header_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+unpack\+\_\+disk\+\_\+header (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{B, }
\item[{{\bf td\+\_\+header\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}{}\label{td02lif_8c_a038d4e9f86f76569a97e443e376a8e11}


Extract Tele\+Disk image header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B} & source data \\
\hline
\mbox{\tt out}  & {\em p} & Tele\+Disk image header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk image header size (not structure size) 
\end{DoxyReturn}


Definition at line 67 of file td02lif.\+c.



Referenced by td0\+\_\+open().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+unpack\+\_\+sector\+\_\+header@{td0\+\_\+unpack\+\_\+sector\+\_\+header}}
\index{td0\+\_\+unpack\+\_\+sector\+\_\+header@{td0\+\_\+unpack\+\_\+sector\+\_\+header}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+unpack\+\_\+sector\+\_\+header(uint8\+\_\+t $\ast$\+B, td\+\_\+sector\+\_\+t $\ast$p)}{td0_unpack_sector_header(uint8_t *B, td_sector_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+unpack\+\_\+sector\+\_\+header (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{B, }
\item[{{\bf td\+\_\+sector\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_ac393151af482d511b246de534da58e6f}{}\label{td02lif_8c_ac393151af482d511b246de534da58e6f}


Extract Tele\+Disk sector header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B} & source data \\
\hline
\mbox{\tt out}  & {\em p} & Tele\+Disk sector header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk sector header size (not structure size) 
\end{DoxyReturn}


Definition at line 145 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().

\index{td02lif.\+c@{td02lif.\+c}!td0\+\_\+unpack\+\_\+track\+\_\+header@{td0\+\_\+unpack\+\_\+track\+\_\+header}}
\index{td0\+\_\+unpack\+\_\+track\+\_\+header@{td0\+\_\+unpack\+\_\+track\+\_\+header}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{td0\+\_\+unpack\+\_\+track\+\_\+header(uint8\+\_\+t $\ast$\+B, td\+\_\+track\+\_\+t $\ast$p)}{td0_unpack_track_header(uint8_t *B, td_track_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}int td0\+\_\+unpack\+\_\+track\+\_\+header (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{B, }
\item[{{\bf td\+\_\+track\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}{}\label{td02lif_8c_ab9cc29346498d37ff85d3a3417d8fc11}


Extract Tele\+Disk track header data in architecture nutral way. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B} & source data \\
\hline
\mbox{\tt out}  & {\em p} & Tele\+Disk track header structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tele\+Disk track header size (not structure size) 
\end{DoxyReturn}


Definition at line 115 of file td02lif.\+c.



Referenced by td0\+\_\+read\+\_\+disk().



\subsection{Variable Documentation}
\index{td02lif.\+c@{td02lif.\+c}!disk@{disk}}
\index{disk@{disk}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{disk}{disk}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf disk\+\_\+t} disk}\hypertarget{td02lif_8c_affcceda12b139f26819f4929be705eb1}{}\label{td02lif_8c_affcceda12b139f26819f4929be705eb1}


Dave Dunfiled L\+Z\+SS expander. 



Definition at line 57 of file td02lif.\+c.

\index{td02lif.\+c@{td02lif.\+c}!liftel@{liftel}}
\index{liftel@{liftel}!td02lif.\+c@{td02lif.\+c}}
\subsubsection[{\texorpdfstring{liftel}{liftel}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf liftel\+\_\+t} liftel}\hypertarget{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}{}\label{td02lif_8c_af2b2b3e4827acc662c88bb762e41106d}


Teledisk liftel analisis and user overrides. 



Definition at line 60 of file td02lif.\+c.

