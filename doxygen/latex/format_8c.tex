\hypertarget{format_8c}{}\section{gpib/format.c File Reference}
\label{format_8c}\index{gpib/format.\+c@{gpib/format.\+c}}


L\+IF Disk Format.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}drives.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}format.\+h\char`\"{}}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{format_8c_a2691478126c4c013b2dff751b6627921}{lif\+\_\+closedir} (\hyperlink{structlifdir__t}{lifdir\+\_\+t} $\ast$\hyperlink{structDIR}{D\+IR})
\begin{DoxyCompactList}\small\item\em Close L\+IF directory Modeled after Linux \hyperlink{posix_8c_aaeac2b41e8c2c3a5f91c9bd511a8c0a6}{closedir()} \end{DoxyCompactList}\item 
\hyperlink{structlifdir__t}{lifdir\+\_\+t} $\ast$ \hyperlink{format_8c_a6b37a1c50e14b4e64e8110f13b74dfeb}{lif\+\_\+opendir} (char $\ast$name)
\item 
\hyperlink{structDirEntryType}{Dir\+Entry\+Type} $\ast$ \hyperlink{format_8c_a988bd344905db14af1dc71642fbd6177}{lif\+\_\+readdir} (\hyperlink{structlifdir__t}{lifdir\+\_\+t} $\ast$\hyperlink{structDIR}{D\+IR})
\item 
void \hyperlink{format_8c_a0b3856561199bf3d16df40c642e6fd39}{lif\+\_\+filename} (char $\ast$name, \hyperlink{structDirEntryType}{Dir\+Entry\+Type} $\ast$DE)
\begin{DoxyCompactList}\small\item\em get L\+IF file name from directory entry \end{DoxyCompactList}\item 
long \hyperlink{format_8c_a7432d0e114aafc7a2e6564fc8367a42a}{lif\+\_\+filelength} (\hyperlink{structDirEntryType}{Dir\+Entry\+Type} $\ast$DE)
\begin{DoxyCompactList}\small\item\em get L\+IF file size from directory entry \end{DoxyCompactList}\item 
int \hyperlink{format_8c_a63dc5fd58d2400c95df45fe39d1710b3}{lif\+\_\+dir} (char $\ast$name)
\begin{DoxyCompactList}\small\item\em Display a L\+IF image file directory. \end{DoxyCompactList}\item 
long \hyperlink{format_8c_a59446cf1799ef917e028c8010c508927}{lif\+\_\+create\+\_\+image} (char $\ast$name, char $\ast$label, long dirsecs, long sectors)
\begin{DoxyCompactList}\small\item\em Create L\+IF disk image This can take a while to run. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{structlifdir__t}{lifdir\+\_\+t} \hyperlink{format_8c_a21b7472d17feca1b2680863dacd8e133}{\+\_\+lifdir}
\begin{DoxyCompactList}\small\item\em Open L\+IF directory for reading Modeled after Linux \hyperlink{posix_8c_a19051b9081dfef221d9bf4583e935031}{opendir()} \end{DoxyCompactList}\item 
static \hyperlink{structDirEntryType}{Dir\+Entry\+Type} \hyperlink{format_8c_a88c7fc9bca0a31b17c59a5e2ecadf7c4}{\+\_\+lifent}
\begin{DoxyCompactList}\small\item\em Open L\+IF directory for reading Modeled after Linux \hyperlink{posix_8c_a1508fedaef509d2976b43300306d1400}{readdir()} \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
L\+IF Disk Format. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2017 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Function Documentation}
\index{format.\+c@{format.\+c}!lif\+\_\+closedir@{lif\+\_\+closedir}}
\index{lif\+\_\+closedir@{lif\+\_\+closedir}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+closedir(lifdir\+\_\+t $\ast$\+D\+I\+R)}{lif_closedir(lifdir_t *DIR)}}]{\setlength{\rightskip}{0pt plus 5cm}int lif\+\_\+closedir (
\begin{DoxyParamCaption}
\item[{{\bf lifdir\+\_\+t} $\ast$}]{D\+IR}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a2691478126c4c013b2dff751b6627921}{}\label{format_8c_a2691478126c4c013b2dff751b6627921}


Close L\+IF directory Modeled after Linux \hyperlink{posix_8c_aaeac2b41e8c2c3a5f91c9bd511a8c0a6}{closedir()} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$\+D\+IR} & pointer to L\+IF Volume/\+Directoy structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on sucesss, -\/1 on error 
\end{DoxyReturn}


Definition at line 25 of file format.\+c.



Referenced by lif\+\_\+dir().

\index{format.\+c@{format.\+c}!lif\+\_\+create\+\_\+image@{lif\+\_\+create\+\_\+image}}
\index{lif\+\_\+create\+\_\+image@{lif\+\_\+create\+\_\+image}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+create\+\_\+image(char $\ast$name, char $\ast$label, long dirsecs, long sectors)}{lif_create_image(char *name, char *label, long dirsecs, long sectors)}}]{\setlength{\rightskip}{0pt plus 5cm}long lif\+\_\+create\+\_\+image (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name, }
\item[{char $\ast$}]{label, }
\item[{long}]{dirsecs, }
\item[{long}]{sectors}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a59446cf1799ef917e028c8010c508927}{}\label{format_8c_a59446cf1799ef917e028c8010c508927}


Create L\+IF disk image This can take a while to run. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & L\+IF disk image name \\
\hline
\mbox{\tt in}  & {\em label} & L\+IF Volume Label name \\
\hline
\mbox{\tt in}  & {\em dirsecs} & Number of L\+IF directory sectors \\
\hline
\mbox{\tt in}  & {\em sectors} & total disk image size in sectors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bytes writting to disk image 
\end{DoxyReturn}
Setup Volume Header

Current Date

Opne disk image for writting

Initial file position

Allocate working buffer for all writes

store Volume data into buffer

File type of 0xffff is last directory entry

F\+I\+X\+ME this is the default that the H\+Pdrive project uses, not sure of this

Zero out remining disk image 

Definition at line 205 of file format.\+c.



Referenced by format\+\_\+drives(), and gpib\+\_\+tests().

\index{format.\+c@{format.\+c}!lif\+\_\+dir@{lif\+\_\+dir}}
\index{lif\+\_\+dir@{lif\+\_\+dir}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+dir(char $\ast$name)}{lif_dir(char *name)}}]{\setlength{\rightskip}{0pt plus 5cm}int lif\+\_\+dir (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a63dc5fd58d2400c95df45fe39d1710b3}{}\label{format_8c_a63dc5fd58d2400c95df45fe39d1710b3}


Display a L\+IF image file directory. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & L\+IF disk image name  -\/1 on error or number of files found \\
\hline
\end{DoxyParams}


Definition at line 160 of file format.\+c.



Referenced by gpib\+\_\+tests().

\index{format.\+c@{format.\+c}!lif\+\_\+filelength@{lif\+\_\+filelength}}
\index{lif\+\_\+filelength@{lif\+\_\+filelength}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+filelength(\+Dir\+Entry\+Type $\ast$\+D\+E)}{lif_filelength(DirEntryType *DE)}}]{\setlength{\rightskip}{0pt plus 5cm}long lif\+\_\+filelength (
\begin{DoxyParamCaption}
\item[{{\bf Dir\+Entry\+Type} $\ast$}]{DE}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a7432d0e114aafc7a2e6564fc8367a42a}{}\label{format_8c_a7432d0e114aafc7a2e6564fc8367a42a}


get L\+IF file size from directory entry 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & L\+IF disk image name \\
\hline
\mbox{\tt in}  & {\em DE} & L\+IF directory entry  void \\
\hline
\end{DoxyParams}


Definition at line 147 of file format.\+c.



Referenced by lif\+\_\+dir().

\index{format.\+c@{format.\+c}!lif\+\_\+filename@{lif\+\_\+filename}}
\index{lif\+\_\+filename@{lif\+\_\+filename}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+filename(char $\ast$name, Dir\+Entry\+Type $\ast$\+D\+E)}{lif_filename(char *name, DirEntryType *DE)}}]{\setlength{\rightskip}{0pt plus 5cm}void lif\+\_\+filename (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name, }
\item[{{\bf Dir\+Entry\+Type} $\ast$}]{DE}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a0b3856561199bf3d16df40c642e6fd39}{}\label{format_8c_a0b3856561199bf3d16df40c642e6fd39}


get L\+IF file name from directory entry 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em name} & L\+IF disk image name \\
\hline
\mbox{\tt in}  & {\em DE} & L\+IF directory entry  void \\
\hline
\end{DoxyParams}


Definition at line 129 of file format.\+c.



Referenced by lif\+\_\+dir().

\index{format.\+c@{format.\+c}!lif\+\_\+opendir@{lif\+\_\+opendir}}
\index{lif\+\_\+opendir@{lif\+\_\+opendir}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+opendir(char $\ast$name)}{lif_opendir(char *name)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lifdir\+\_\+t}$\ast$ lif\+\_\+opendir (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{name}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a6b37a1c50e14b4e64e8110f13b74dfeb}{}\label{format_8c_a6b37a1c50e14b4e64e8110f13b74dfeb}
Initial file position 

Definition at line 40 of file format.\+c.



Referenced by lif\+\_\+dir().

\index{format.\+c@{format.\+c}!lif\+\_\+readdir@{lif\+\_\+readdir}}
\index{lif\+\_\+readdir@{lif\+\_\+readdir}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{lif\+\_\+readdir(lifdir\+\_\+t $\ast$\+D\+I\+R)}{lif_readdir(lifdir_t *DIR)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Dir\+Entry\+Type}$\ast$ lif\+\_\+readdir (
\begin{DoxyParamCaption}
\item[{{\bf lifdir\+\_\+t} $\ast$}]{D\+IR}
\end{DoxyParamCaption}
)}\hypertarget{format_8c_a988bd344905db14af1dc71642fbd6177}{}\label{format_8c_a988bd344905db14af1dc71642fbd6177}
Initial file position 

Definition at line 83 of file format.\+c.



Referenced by lif\+\_\+dir().



\subsection{Variable Documentation}
\index{format.\+c@{format.\+c}!\+\_\+lifdir@{\+\_\+lifdir}}
\index{\+\_\+lifdir@{\+\_\+lifdir}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+lifdir}{_lifdir}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lifdir\+\_\+t} \+\_\+lifdir\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{format_8c_a21b7472d17feca1b2680863dacd8e133}{}\label{format_8c_a21b7472d17feca1b2680863dacd8e133}


Open L\+IF directory for reading Modeled after Linux \hyperlink{posix_8c_a19051b9081dfef221d9bf4583e935031}{opendir()} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$name} & file name of L\+IF image \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+LL on error, \hyperlink{structlifdir__t}{lifdir\+\_\+t} pointer to L\+IF Volume/\+Directoy structure on sucesss 
\end{DoxyReturn}


Definition at line 39 of file format.\+c.

\index{format.\+c@{format.\+c}!\+\_\+lifent@{\+\_\+lifent}}
\index{\+\_\+lifent@{\+\_\+lifent}!format.\+c@{format.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+lifent}{_lifent}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Dir\+Entry\+Type} \+\_\+lifent\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{format_8c_a88c7fc9bca0a31b17c59a5e2ecadf7c4}{}\label{format_8c_a88c7fc9bca0a31b17c59a5e2ecadf7c4}


Open L\+IF directory for reading Modeled after Linux \hyperlink{posix_8c_a1508fedaef509d2976b43300306d1400}{readdir()} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$\+D\+IR} & to L\+IF Volume/\+Diractoy structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structDirEntryType}{Dir\+Entry\+Type} filled with directory structure, or N\+U\+LL on error of end of Directory 
\end{DoxyReturn}


Definition at line 82 of file format.\+c.

