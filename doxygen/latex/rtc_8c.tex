\hypertarget{rtc_8c}{\section{hardware/rtc.c File Reference}
\label{rtc_8c}\index{hardware/rtc.\-c@{hardware/rtc.\-c}}
}


D\-S1307 R\-T\-C Driver A\-V\-R8.  


{\ttfamily \#include \char`\"{}hardware.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}lib/time.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\-\_\-t \hyperlink{rtc_8c_a221016815913bd1b20c9b619900b40b8}{B\-I\-Nto\-B\-C\-D} (uint8\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Convert number $>$= 0 and $<$= 99 to B\-C\-D. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{rtc_8c_a2487d4ced293cbe6f2779960032e30c2}{B\-C\-Dto\-B\-I\-N} (uint8\-\_\-t data)
\begin{DoxyCompactList}\small\item\em Convert two \char`\"{}digit\char`\"{} B\-C\-D number to binary. \end{DoxyCompactList}\item 
int8\-\_\-t \hyperlink{rtc_8c_a4cc3a3f4decdc4ef7cfb28227e10c36d}{rtc\-\_\-run\-\_\-test} ()
\begin{DoxyCompactList}\small\item\em Check if the D\-S1307 device is running. \end{DoxyCompactList}\item 
int \hyperlink{rtc_8c_a18a3db53342227574822a9b6b9c0386b}{rtc\-\_\-run} (int run)
\begin{DoxyCompactList}\small\item\em Set D\-S1307 run state. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{rtc_8c_aca651806fd67e4d5345fc45f70b35814}{rtc\-\_\-init} (int force, \hyperlink{posix_8h_a3346b04b0420b32ccf6b706551b70762}{time\-\_\-t} seconds)
\begin{DoxyCompactList}\small\item\em Initialize D\-S1307 rtc if not initialied -\/ or if forced. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{rtc_8c_a9ba6382e802fb431c0460599c191763f}{rtc\-\_\-write} (\hyperlink{time_8h_a2fea857c30e2c901566fcf45fac68ac5}{tm\-\_\-t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Set D\-S1307 R\-T\-C from P\-O\-S\-I\-X struct tm $\ast$ structure. \end{DoxyCompactList}\item 
uint8\-\_\-t \hyperlink{rtc_8c_a3794738edaf3a42409aa1d9e12be60c3}{rtc\-\_\-read} (\hyperlink{time_8h_a2fea857c30e2c901566fcf45fac68ac5}{tm\-\_\-t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Read D\-S1307 R\-T\-C into P\-O\-S\-I\-X struct tm $\ast$ structure. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
D\-S1307 R\-T\-C Driver A\-V\-R8. \begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\-0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


Definition in file \hyperlink{rtc_8c_source}{rtc.\-c}.



\subsection{Function Documentation}
\hypertarget{rtc_8c_a2487d4ced293cbe6f2779960032e30c2}{\index{rtc.\-c@{rtc.\-c}!B\-C\-Dto\-B\-I\-N@{B\-C\-Dto\-B\-I\-N}}
\index{B\-C\-Dto\-B\-I\-N@{B\-C\-Dto\-B\-I\-N}!rtc.c@{rtc.\-c}}
\subsubsection[{B\-C\-Dto\-B\-I\-N}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t B\-C\-Dto\-B\-I\-N (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a2487d4ced293cbe6f2779960032e30c2}


Convert two \char`\"{}digit\char`\"{} B\-C\-D number to binary. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & B\-C\-D number.
\begin{DoxyItemize}
\item number $>$= 0 and $<$= 99 to B\-C\-D 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Binary value. 
\end{DoxyReturn}


Definition at line 34 of file rtc.\-c.



Referenced by rtc\-\_\-read().

\hypertarget{rtc_8c_a221016815913bd1b20c9b619900b40b8}{\index{rtc.\-c@{rtc.\-c}!B\-I\-Nto\-B\-C\-D@{B\-I\-Nto\-B\-C\-D}}
\index{B\-I\-Nto\-B\-C\-D@{B\-I\-Nto\-B\-C\-D}!rtc.c@{rtc.\-c}}
\subsubsection[{B\-I\-Nto\-B\-C\-D}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t B\-I\-Nto\-B\-C\-D (
\begin{DoxyParamCaption}
\item[{uint8\-\_\-t}]{data}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a221016815913bd1b20c9b619900b40b8}


Convert number $>$= 0 and $<$= 99 to B\-C\-D. 


\begin{DoxyItemize}
\item B\-C\-D format has each hex nibble has a digit 0 .. 9
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em data} & number to convert. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\-C\-D value 
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
we assume the number is in range. 
\end{DoxyWarning}


Definition at line 23 of file rtc.\-c.



Referenced by rtc\-\_\-write().

\hypertarget{rtc_8c_aca651806fd67e4d5345fc45f70b35814}{\index{rtc.\-c@{rtc.\-c}!rtc\-\_\-init@{rtc\-\_\-init}}
\index{rtc\-\_\-init@{rtc\-\_\-init}!rtc.c@{rtc.\-c}}
\subsubsection[{rtc\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t rtc\-\_\-init (
\begin{DoxyParamCaption}
\item[{int}]{force, }
\item[{{\bf time\-\_\-t}}]{seconds}
\end{DoxyParamCaption}
)}}\label{rtc_8c_aca651806fd67e4d5345fc45f70b35814}


Initialize D\-S1307 rtc if not initialied -\/ or if forced. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em force} & force initialiation flag.
\begin{DoxyItemize}
\item If 1 then alwasy force initialiation. 
\end{DoxyItemize}\\
\hline
\mbox{\tt in}  & {\em seconds} & P\-O\-S\-I\-X E\-P\-O\-C\-H time in seconds.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success. 

0 on fail. 
\end{DoxyReturn}


Definition at line 111 of file rtc.\-c.



Referenced by setdate\-\_\-r(), and setup\-\_\-clock().

\hypertarget{rtc_8c_a3794738edaf3a42409aa1d9e12be60c3}{\index{rtc.\-c@{rtc.\-c}!rtc\-\_\-read@{rtc\-\_\-read}}
\index{rtc\-\_\-read@{rtc\-\_\-read}!rtc.c@{rtc.\-c}}
\subsubsection[{rtc\-\_\-read}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t rtc\-\_\-read (
\begin{DoxyParamCaption}
\item[{{\bf tm\-\_\-t} $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a3794738edaf3a42409aa1d9e12be60c3}


Read D\-S1307 R\-T\-C into P\-O\-S\-I\-X struct tm $\ast$ structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt out}  & {\em t} & struct tm $\ast$ P\-O\-S\-I\-X time returned. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on sucess. 

0 on fail. 
\end{DoxyReturn}


Definition at line 231 of file rtc.\-c.



Referenced by display\-\_\-time(), and setup\-\_\-clock().

\hypertarget{rtc_8c_a18a3db53342227574822a9b6b9c0386b}{\index{rtc.\-c@{rtc.\-c}!rtc\-\_\-run@{rtc\-\_\-run}}
\index{rtc\-\_\-run@{rtc\-\_\-run}!rtc.c@{rtc.\-c}}
\subsubsection[{rtc\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}int rtc\-\_\-run (
\begin{DoxyParamCaption}
\item[{int}]{run}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a18a3db53342227574822a9b6b9c0386b}


Set D\-S1307 run state. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em run} & state.
\begin{DoxyItemize}
\item 1 = run.
\item 0 = stop.
\item -\/1 = check run state.
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
run state 0/1 on success. 

-\/1 on error. 
\end{DoxyReturn}


Definition at line 73 of file rtc.\-c.



Referenced by rtc\-\_\-init().

\hypertarget{rtc_8c_a4cc3a3f4decdc4ef7cfb28227e10c36d}{\index{rtc.\-c@{rtc.\-c}!rtc\-\_\-run\-\_\-test@{rtc\-\_\-run\-\_\-test}}
\index{rtc\-\_\-run\-\_\-test@{rtc\-\_\-run\-\_\-test}!rtc.c@{rtc.\-c}}
\subsubsection[{rtc\-\_\-run\-\_\-test}]{\setlength{\rightskip}{0pt plus 5cm}int8\-\_\-t rtc\-\_\-run\-\_\-test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a4cc3a3f4decdc4ef7cfb28227e10c36d}


Check if the D\-S1307 device is running. 


\begin{DoxyItemize}
\item display error if read error occurs.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
1 if running. 

0 if not running. 
\end{DoxyReturn}


Definition at line 47 of file rtc.\-c.

\hypertarget{rtc_8c_a9ba6382e802fb431c0460599c191763f}{\index{rtc.\-c@{rtc.\-c}!rtc\-\_\-write@{rtc\-\_\-write}}
\index{rtc\-\_\-write@{rtc\-\_\-write}!rtc.c@{rtc.\-c}}
\subsubsection[{rtc\-\_\-write}]{\setlength{\rightskip}{0pt plus 5cm}uint8\-\_\-t rtc\-\_\-write (
\begin{DoxyParamCaption}
\item[{{\bf tm\-\_\-t} $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{rtc_8c_a9ba6382e802fb431c0460599c191763f}


Set D\-S1307 R\-T\-C from P\-O\-S\-I\-X struct tm $\ast$ structure. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em t} & P\-O\-S\-I\-X struct tm $\ast$ time to set.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on sucess. 

0 on fail. 
\end{DoxyReturn}


Definition at line 179 of file rtc.\-c.



Referenced by rtc\-\_\-init().

