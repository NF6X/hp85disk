\hypertarget{spi_8h}{}\section{hardware/spi.h File Reference}
\label{spi_8h}\index{hardware/spi.\+h@{hardware/spi.\+h}}


S\+PI Driver A\+V\+R8.  


{\ttfamily \#include \char`\"{}user\+\_\+config.\+h\char`\"{}}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{spi_8h_ae943d062808970152164ee319b313aa9}{S\+P\+I0\+\_\+\+M\+O\+D\+E0}~0
\item 
\#define \hyperlink{spi_8h_a01bdd9f196f0cf87a8cf2287611f429c}{S\+P\+I0\+\_\+\+M\+O\+D\+E1}~1
\item 
\#define \hyperlink{spi_8h_a686d660ab468c89851eac9e1776f5f11}{S\+P\+I0\+\_\+\+M\+O\+D\+E2}~2
\item 
\#define \hyperlink{spi_8h_a7baa1e6e83f8e91c1b83ed05f906acb9}{S\+P\+I0\+\_\+\+M\+O\+D\+E3}~3
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{spi_8h_ab3a9992a0e94660ccd4a3e6e622d0093}{S\+P\+I0\+\_\+cs\+\_\+enable} (uint8\+\_\+t cs)
\item 
void \hyperlink{spi_8h_a6dbd255bdf03dcf728853158e512d662}{S\+P\+I0\+\_\+cs\+\_\+disable} (uint8\+\_\+t cs)
\item 
void \hyperlink{spi_8h_a4b8379d9d83e3283bb53cfeca92f2e02}{S\+P\+I0\+\_\+\+Speed} (uint32\+\_\+t speed)
\begin{DoxyCompactList}\small\item\em Set A\+VR S\+PI bus rate in HZ. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{spi_8h_a6b19a886a9e63fbc9ed02a6a6361e68b}{S\+P\+I0\+\_\+\+Get\+\_\+\+Speed} (void)
\begin{DoxyCompactList}\small\item\em Return previously saved S\+PI B\+US rate in HZ. \end{DoxyCompactList}\item 
void \hyperlink{spi_8h_a50834bfd8ff3e59840ef35d5283f5306}{S\+P\+I0\+\_\+\+Mode} (int mode)
\begin{DoxyCompactList}\small\item\em Set S\+PI clock mode. \end{DoxyCompactList}\item 
int \hyperlink{spi_8h_ab93aed2163d123a27c97758c8cde0587}{S\+P\+I0\+\_\+\+Get\+\_\+\+Mode} (void)
\begin{DoxyCompactList}\small\item\em Return saved S\+PI mode as set by \hyperlink{spi_8c_a50834bfd8ff3e59840ef35d5283f5306}{S\+P\+I0\+\_\+\+Mode()}. \end{DoxyCompactList}\item 
void \hyperlink{spi_8h_a09a39e7befac69f184fd466e10730595}{S\+P\+I0\+\_\+\+Init} (uint32\+\_\+t speed)
\begin{DoxyCompactList}\small\item\em Initialize S\+P\+I0 device. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{spi_8h_a795b3fa18e16d366d9a64e88f1cb18ab}{S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte} (uint8\+\_\+t Data)
\begin{DoxyCompactList}\small\item\em S\+PI read/\+Write byte. \end{DoxyCompactList}\item 
void \hyperlink{spi_8h_a491de3187a3fd4b12dfc1f7fbd50238f}{S\+P\+I0\+\_\+\+TX} (uint8\+\_\+t $\ast$data, int count)
\begin{DoxyCompactList}\small\item\em S\+PI buffered write functions. \end{DoxyCompactList}\item 
void \hyperlink{spi_8h_a7b56f3fcfe9a88adaac0c59465c0e845}{S\+P\+I0\+\_\+\+T\+X\+RX} (uint8\+\_\+t $\ast$data, int count)
\begin{DoxyCompactList}\small\item\em H\+S\+PI write and read using F\+I\+FO. \end{DoxyCompactList}\item 
void \hyperlink{spi_8h_a8e36c17c5822efaecdbcc75829f7582e}{S\+P\+I0\+\_\+\+RX} (uint8\+\_\+t $\ast$data, int count)
\begin{DoxyCompactList}\small\item\em H\+S\+PI read using F\+I\+FO. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
S\+PI Driver A\+V\+R8. 

\begin{DoxyParagraph}{Edit History}

\begin{DoxyItemize}
\item \mbox{[}1.\+0\mbox{]} \mbox{[}Mike Gore\mbox{]} Initial revision of file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Copyright \copyright{} 2014-\/2020 Mike Gore, Inc. All rights reserved.}

\end{DoxyParagraph}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{spi_8h_ae943d062808970152164ee319b313aa9}\label{spi_8h_ae943d062808970152164ee319b313aa9}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+M\+O\+D\+E0@{S\+P\+I0\+\_\+\+M\+O\+D\+E0}}
\index{S\+P\+I0\+\_\+\+M\+O\+D\+E0@{S\+P\+I0\+\_\+\+M\+O\+D\+E0}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+M\+O\+D\+E0}{SPI0\_MODE0}}
{\footnotesize\ttfamily \#define S\+P\+I0\+\_\+\+M\+O\+D\+E0~0}



Definition at line 18 of file spi.\+h.

\mbox{\Hypertarget{spi_8h_a01bdd9f196f0cf87a8cf2287611f429c}\label{spi_8h_a01bdd9f196f0cf87a8cf2287611f429c}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+M\+O\+D\+E1@{S\+P\+I0\+\_\+\+M\+O\+D\+E1}}
\index{S\+P\+I0\+\_\+\+M\+O\+D\+E1@{S\+P\+I0\+\_\+\+M\+O\+D\+E1}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+M\+O\+D\+E1}{SPI0\_MODE1}}
{\footnotesize\ttfamily \#define S\+P\+I0\+\_\+\+M\+O\+D\+E1~1}



Definition at line 19 of file spi.\+h.

\mbox{\Hypertarget{spi_8h_a686d660ab468c89851eac9e1776f5f11}\label{spi_8h_a686d660ab468c89851eac9e1776f5f11}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+M\+O\+D\+E2@{S\+P\+I0\+\_\+\+M\+O\+D\+E2}}
\index{S\+P\+I0\+\_\+\+M\+O\+D\+E2@{S\+P\+I0\+\_\+\+M\+O\+D\+E2}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+M\+O\+D\+E2}{SPI0\_MODE2}}
{\footnotesize\ttfamily \#define S\+P\+I0\+\_\+\+M\+O\+D\+E2~2}



Definition at line 20 of file spi.\+h.

\mbox{\Hypertarget{spi_8h_a7baa1e6e83f8e91c1b83ed05f906acb9}\label{spi_8h_a7baa1e6e83f8e91c1b83ed05f906acb9}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+M\+O\+D\+E3@{S\+P\+I0\+\_\+\+M\+O\+D\+E3}}
\index{S\+P\+I0\+\_\+\+M\+O\+D\+E3@{S\+P\+I0\+\_\+\+M\+O\+D\+E3}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+M\+O\+D\+E3}{SPI0\_MODE3}}
{\footnotesize\ttfamily \#define S\+P\+I0\+\_\+\+M\+O\+D\+E3~3}



Definition at line 21 of file spi.\+h.



\subsection{Function Documentation}
\mbox{\Hypertarget{spi_8h_a6dbd255bdf03dcf728853158e512d662}\label{spi_8h_a6dbd255bdf03dcf728853158e512d662}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+cs\+\_\+disable@{S\+P\+I0\+\_\+cs\+\_\+disable}}
\index{S\+P\+I0\+\_\+cs\+\_\+disable@{S\+P\+I0\+\_\+cs\+\_\+disable}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+cs\+\_\+disable()}{SPI0\_cs\_disable()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+cs\+\_\+disable (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{cs }\end{DoxyParamCaption})}

\mbox{\Hypertarget{spi_8h_ab3a9992a0e94660ccd4a3e6e622d0093}\label{spi_8h_ab3a9992a0e94660ccd4a3e6e622d0093}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+cs\+\_\+enable@{S\+P\+I0\+\_\+cs\+\_\+enable}}
\index{S\+P\+I0\+\_\+cs\+\_\+enable@{S\+P\+I0\+\_\+cs\+\_\+enable}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+cs\+\_\+enable()}{SPI0\_cs\_enable()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+cs\+\_\+enable (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{cs }\end{DoxyParamCaption})}

\mbox{\Hypertarget{spi_8h_ab93aed2163d123a27c97758c8cde0587}\label{spi_8h_ab93aed2163d123a27c97758c8cde0587}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+Get\+\_\+\+Mode@{S\+P\+I0\+\_\+\+Get\+\_\+\+Mode}}
\index{S\+P\+I0\+\_\+\+Get\+\_\+\+Mode@{S\+P\+I0\+\_\+\+Get\+\_\+\+Mode}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+Get\+\_\+\+Mode()}{SPI0\_Get\_Mode()}}
{\footnotesize\ttfamily int S\+P\+I0\+\_\+\+Get\+\_\+\+Mode (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Return saved S\+PI mode as set by \hyperlink{spi_8c_a50834bfd8ff3e59840ef35d5283f5306}{S\+P\+I0\+\_\+\+Mode()}. 

\begin{DoxyReturn}{Returns}
saved mode. 
\end{DoxyReturn}


Definition at line 176 of file spi.\+c.

\mbox{\Hypertarget{spi_8h_a6b19a886a9e63fbc9ed02a6a6361e68b}\label{spi_8h_a6b19a886a9e63fbc9ed02a6a6361e68b}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+Get\+\_\+\+Speed@{S\+P\+I0\+\_\+\+Get\+\_\+\+Speed}}
\index{S\+P\+I0\+\_\+\+Get\+\_\+\+Speed@{S\+P\+I0\+\_\+\+Get\+\_\+\+Speed}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+Get\+\_\+\+Speed()}{SPI0\_Get\_Speed()}}
{\footnotesize\ttfamily uint32\+\_\+t S\+P\+I0\+\_\+\+Get\+\_\+\+Speed (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Return previously saved S\+PI B\+US rate in HZ. 

\begin{DoxyReturn}{Returns}
S\+PI clock rate in HZ. 
\end{DoxyReturn}


Definition at line 124 of file spi.\+c.

\mbox{\Hypertarget{spi_8h_a09a39e7befac69f184fd466e10730595}\label{spi_8h_a09a39e7befac69f184fd466e10730595}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+Init@{S\+P\+I0\+\_\+\+Init}}
\index{S\+P\+I0\+\_\+\+Init@{S\+P\+I0\+\_\+\+Init}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+Init()}{SPI0\_Init()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+Init (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{speed }\end{DoxyParamCaption})}



Initialize S\+P\+I0 device. 


\begin{DoxyItemize}
\item Set default speed, IO pins and mode. 
\end{DoxyItemize}

Definition at line 188 of file spi.\+c.



Referenced by spi\+\_\+init().

\mbox{\Hypertarget{spi_8h_a50834bfd8ff3e59840ef35d5283f5306}\label{spi_8h_a50834bfd8ff3e59840ef35d5283f5306}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+Mode@{S\+P\+I0\+\_\+\+Mode}}
\index{S\+P\+I0\+\_\+\+Mode@{S\+P\+I0\+\_\+\+Mode}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+Mode()}{SPI0\_Mode()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+Mode (\begin{DoxyParamCaption}\item[{int}]{mode }\end{DoxyParamCaption})}



Set S\+PI clock mode. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mode} & valid mades\+: \begin{DoxyVerb}*   SPI Mode     CPOL    CPHA            Sample
*   0    0       0       Leading (Rising)   Edge
*   1    0       1       Trailing (Falling) Edge
*   2    1       0       Leading (Falling)  Edge
*   3    1       1       Trailing (Rising)  Edge
* \end{DoxyVerb}
\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 146 of file spi.\+c.



Referenced by S\+P\+I0\+\_\+\+Init(), and spi\+\_\+init().

\mbox{\Hypertarget{spi_8h_a8e36c17c5822efaecdbcc75829f7582e}\label{spi_8h_a8e36c17c5822efaecdbcc75829f7582e}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+RX@{S\+P\+I0\+\_\+\+RX}}
\index{S\+P\+I0\+\_\+\+RX@{S\+P\+I0\+\_\+\+RX}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+R\+X()}{SPI0\_RX()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+RX (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{count }\end{DoxyParamCaption})}



H\+S\+PI read using F\+I\+FO. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$data} & receive buffer \\
\hline
\mbox{\tt in}  & {\em count} & number of bytes to read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 270 of file spi.\+c.



Referenced by spi\+\_\+\+R\+X(), and spi\+\_\+\+R\+X\+\_\+buffer().

\mbox{\Hypertarget{spi_8h_a4b8379d9d83e3283bb53cfeca92f2e02}\label{spi_8h_a4b8379d9d83e3283bb53cfeca92f2e02}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+Speed@{S\+P\+I0\+\_\+\+Speed}}
\index{S\+P\+I0\+\_\+\+Speed@{S\+P\+I0\+\_\+\+Speed}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+Speed()}{SPI0\_Speed()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+Speed (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{speed }\end{DoxyParamCaption})}



Set A\+VR S\+PI bus rate in HZ. 


\begin{DoxyItemize}
\item Compute precsale rate from desired frequency in HZ.
\begin{DoxyItemize}
\item Slowest rate\+: F\+\_\+\+C\+P\+U/128.
\item Fastest rate\+: F\+\_\+\+C\+P\+U/2.
\end{DoxyItemize}
\item Precsale value is truncated not rounded.
\item Valid precsle values are 2,4,8,16,32,64,128. \begin{DoxyVerb}/// SPI2X   SPR1    SPR0     SCK Frequency
/// 1       0       0        fosc/2
/// 0       0       0        fosc/4
/// 1       0       1        fosc/8
/// 0       0       1        fosc/16
/// 1       1       0        fosc/32
/// 0       1       0        fosc/64
/// 1       1       1        fosc/64
/// 0       1       1        fosc/128
/// \end{DoxyVerb}
 \begin{DoxyVerb}@param[in] speed: SPI clock rate in HZ.

@return  void  \end{DoxyVerb}
 
\end{DoxyItemize}Save speed value 

Definition at line 47 of file spi.\+c.



Referenced by S\+P\+I0\+\_\+\+Init().

\mbox{\Hypertarget{spi_8h_a491de3187a3fd4b12dfc1f7fbd50238f}\label{spi_8h_a491de3187a3fd4b12dfc1f7fbd50238f}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+TX@{S\+P\+I0\+\_\+\+TX}}
\index{S\+P\+I0\+\_\+\+TX@{S\+P\+I0\+\_\+\+TX}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+T\+X()}{SPI0\_TX()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+TX (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{count }\end{DoxyParamCaption})}



S\+PI buffered write functions. 

H\+S\+PI write using F\+I\+FO 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$data} & transmit buffer \\
\hline
\mbox{\tt in}  & {\em count} & number of bytes to write \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 239 of file spi.\+c.



Referenced by spi\+\_\+\+T\+X(), and spi\+\_\+\+T\+X\+\_\+buffer().

\mbox{\Hypertarget{spi_8h_a7b56f3fcfe9a88adaac0c59465c0e845}\label{spi_8h_a7b56f3fcfe9a88adaac0c59465c0e845}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+T\+X\+RX@{S\+P\+I0\+\_\+\+T\+X\+RX}}
\index{S\+P\+I0\+\_\+\+T\+X\+RX@{S\+P\+I0\+\_\+\+T\+X\+RX}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+T\+X\+R\+X()}{SPI0\_TXRX()}}
{\footnotesize\ttfamily void S\+P\+I0\+\_\+\+T\+X\+RX (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{int}]{count }\end{DoxyParamCaption})}



H\+S\+PI write and read using F\+I\+FO. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em $\ast$data} & transmit / receive buffer \\
\hline
\mbox{\tt in}  & {\em count} & number of bytes to write / read \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 255 of file spi.\+c.



Referenced by spi\+\_\+\+T\+X\+R\+X(), and spi\+\_\+\+T\+X\+R\+X\+\_\+buffer().

\mbox{\Hypertarget{spi_8h_a795b3fa18e16d366d9a64e88f1cb18ab}\label{spi_8h_a795b3fa18e16d366d9a64e88f1cb18ab}} 
\index{spi.\+h@{spi.\+h}!S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte@{S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte}}
\index{S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte@{S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte}!spi.\+h@{spi.\+h}}
\subsubsection{\texorpdfstring{S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte()}{SPI0\_TXRX\_Byte()}}
{\footnotesize\ttfamily uint8\+\_\+t S\+P\+I0\+\_\+\+T\+X\+R\+X\+\_\+\+Byte (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{Data }\end{DoxyParamCaption})}



S\+PI read/\+Write byte. 


\begin{DoxyItemize}
\item We Write and read at the same time.
\item If we want to read only set Data to 0xff.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Data} & Data to send.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Data received. 
\end{DoxyReturn}


Definition at line 220 of file spi.\+c.



Referenced by ppr\+\_\+set(), S\+P\+I0\+\_\+\+Init(), S\+P\+I0\+\_\+\+R\+X(), S\+P\+I0\+\_\+\+T\+X(), and S\+P\+I0\+\_\+\+T\+X\+R\+X().

