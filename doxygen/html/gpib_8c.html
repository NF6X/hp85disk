<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HP85 GPIB Disk Emulator: gpib/gpib.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HP85 GPIB Disk Emulator
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">HP85GPIBDiskEmulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d6b38c553053a83c6809a5b0d50557a4.html">gpib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gpib.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>GPIB emulator for HP85 disk emulator project for AVR.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;avr/pgmspace.h&gt;</code><br />
<code>#include &lt;avr/portpins.h&gt;</code><br />
<code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &quot;<a class="el" href="user__config_8h_source.html">user_config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hal_8h_source.html">hardware/hal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gpib__hal_8h_source.html">gpib_hal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="defines_8h_source.html">defines.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gpib_8h_source.html">gpib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gpib__task_8h_source.html">gpib_task.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="amigo_8h_source.html">amigo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ss80_8h_source.html">ss80.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="posix_8h_source.html">posix.h</a>&quot;</code><br />
</div>
<p><a href="gpib_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6dcb5fc551174cd685f0802f86329f3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a6dcb5fc551174cd685f0802f86329f3b">HTIMEOUT</a>&#160;&#160;&#160;(500000L / GPIB_TASK_TIC_US)</td></tr>
<tr class="memdesc:a6dcb5fc551174cd685f0802f86329f3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the default BUS timeout of 0.5 Seconds in Microseconds.  <a href="#a6dcb5fc551174cd685f0802f86329f3b">More...</a><br /></td></tr>
<tr class="separator:a6dcb5fc551174cd685f0802f86329f3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a3c1941e17626338b878123677ae797"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a6a3c1941e17626338b878123677ae797">gpib_timer_elapsed_begin</a> (void)</td></tr>
<tr class="memdesc:a6a3c1941e17626338b878123677ae797"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start measuring time - used with hpib_timer_elapsed_end()  <a href="#a6a3c1941e17626338b878123677ae797">More...</a><br /></td></tr>
<tr class="separator:a6a3c1941e17626338b878123677ae797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe05115c27148ec7013e6f62dc94ae78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#abe05115c27148ec7013e6f62dc94ae78">gpib_timer_reset</a> (void)</td></tr>
<tr class="memdesc:abe05115c27148ec7013e6f62dc94ae78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset elapsed and timeout timers Elapses and Timeout Timers.  <a href="#abe05115c27148ec7013e6f62dc94ae78">More...</a><br /></td></tr>
<tr class="separator:abe05115c27148ec7013e6f62dc94ae78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ae4b4852f4a1987fc61fec20f53d42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a87ae4b4852f4a1987fc61fec20f53d42">gpib_timer_elapsed_end</a> (char *msg)</td></tr>
<tr class="memdesc:a87ae4b4852f4a1987fc61fec20f53d42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display user message and time delta since <a class="el" href="gpib_8c.html#a6a3c1941e17626338b878123677ae797" title="Start measuring time - used with hpib_timer_elapsed_end() ">gpib_timer_elapsed_begin()</a> call.  <a href="#a87ae4b4852f4a1987fc61fec20f53d42">More...</a><br /></td></tr>
<tr class="separator:a87ae4b4852f4a1987fc61fec20f53d42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9291b22beebb9d24354af643505f9cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#ae9291b22beebb9d24354af643505f9cd">gpib_timer_task</a> ()</td></tr>
<tr class="memdesc:ae9291b22beebb9d24354af643505f9cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main GPIB timer task called by low level interrup hander.  <a href="#ae9291b22beebb9d24354af643505f9cd">More...</a><br /></td></tr>
<tr class="separator:ae9291b22beebb9d24354af643505f9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a687395337dd5c6604a775e3ffd3f006f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a687395337dd5c6604a775e3ffd3f006f">gpib_timeout_set</a> (uint32_t <a class="el" href="time_8h.html#a32b1cbd925752f0cd61d202bbe204a69">time</a>)</td></tr>
<tr class="memdesc:a687395337dd5c6604a775e3ffd3f006f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set GPIB timeout timer in units of GPIB_TASK_TIC_US.  <a href="#a687395337dd5c6604a775e3ffd3f006f">More...</a><br /></td></tr>
<tr class="separator:a687395337dd5c6604a775e3ffd3f006f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb10b99d17dd69982b6bfc820fb29db"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a3eb10b99d17dd69982b6bfc820fb29db">gpib_timeout_test</a> ()</td></tr>
<tr class="memdesc:a3eb10b99d17dd69982b6bfc820fb29db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test GPIB timeout timer for timeout condition.  <a href="#a3eb10b99d17dd69982b6bfc820fb29db">More...</a><br /></td></tr>
<tr class="separator:a3eb10b99d17dd69982b6bfc820fb29db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5576f7a1bab2c1beaab0c03bc62bb349"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a5576f7a1bab2c1beaab0c03bc62bb349">gpib_bus_init</a> (int cold)</td></tr>
<tr class="memdesc:a5576f7a1bab2c1beaab0c03bc62bb349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize GPIB Bus control lines for powerup or reset conditions.  <a href="#a5576f7a1bab2c1beaab0c03bc62bb349">More...</a><br /></td></tr>
<tr class="separator:a5576f7a1bab2c1beaab0c03bc62bb349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32d2476eec2bbdf15e7db1b901c5a671"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a32d2476eec2bbdf15e7db1b901c5a671">gpib_state_init</a> (void)</td></tr>
<tr class="memdesc:a32d2476eec2bbdf15e7db1b901c5a671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset GPIB states and related variables.  <a href="#a32d2476eec2bbdf15e7db1b901c5a671">More...</a><br /></td></tr>
<tr class="separator:a32d2476eec2bbdf15e7db1b901c5a671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0320b576cbb529fcec04e1fed8da198"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#ad0320b576cbb529fcec04e1fed8da198">EnablePPR</a> (int bit)</td></tr>
<tr class="separator:ad0320b576cbb529fcec04e1fed8da198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fd9be01cfd79cffd369aacae939408"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a09fd9be01cfd79cffd369aacae939408">DisablePPR</a> (int bit)</td></tr>
<tr class="memdesc:a09fd9be01cfd79cffd369aacae939408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable PPR (Parallel Poll Response) for a device.  <a href="#a09fd9be01cfd79cffd369aacae939408">More...</a><br /></td></tr>
<tr class="separator:a09fd9be01cfd79cffd369aacae939408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d306c338c639682d0d6f0434a5c88b"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a42d306c338c639682d0d6f0434a5c88b">Parallel_Poll</a> ()</td></tr>
<tr class="memdesc:a42d306c338c639682d0d6f0434a5c88b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to detect the Parallel Poll Reposnse state Used only for debugging - it is unlikely that we will catch this state.  <a href="#a42d306c338c639682d0d6f0434a5c88b">More...</a><br /></td></tr>
<tr class="separator:a42d306c338c639682d0d6f0434a5c88b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01eaf30370a0b43263d19ebaa2fa4a38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a01eaf30370a0b43263d19ebaa2fa4a38">gpib_assert_ifc</a> (void)</td></tr>
<tr class="memdesc:a01eaf30370a0b43263d19ebaa2fa4a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assert Interface clear for 250us.  <a href="#a01eaf30370a0b43263d19ebaa2fa4a38">More...</a><br /></td></tr>
<tr class="separator:a01eaf30370a0b43263d19ebaa2fa4a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae826d722b789698ce9217758fe55fdcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#ae826d722b789698ce9217758fe55fdcb">gpib_assert_ren</a> (unsigned char state)</td></tr>
<tr class="memdesc:ae826d722b789698ce9217758fe55fdcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assert REN to put instrument in remote mode.  <a href="#ae826d722b789698ce9217758fe55fdcb">More...</a><br /></td></tr>
<tr class="separator:ae826d722b789698ce9217758fe55fdcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3d50cc1d56705d107e2f8fb00692e68"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#ac3d50cc1d56705d107e2f8fb00692e68">gpib_write_byte</a> (uint16_t ch)</td></tr>
<tr class="memdesc:ac3d50cc1d56705d107e2f8fb00692e68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send 1 byte and control line states to GPIB BUS.  <a href="#ac3d50cc1d56705d107e2f8fb00692e68">More...</a><br /></td></tr>
<tr class="separator:ac3d50cc1d56705d107e2f8fb00692e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fdb3d4996ff399dc2fbfcada417bb1a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a">gpib_unread</a> (uint16_t ch)</td></tr>
<tr class="memdesc:a2fdb3d4996ff399dc2fbfcada417bb1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIB ungets one character and all status states.  <a href="#a2fdb3d4996ff399dc2fbfcada417bb1a">More...</a><br /></td></tr>
<tr class="separator:a2fdb3d4996ff399dc2fbfcada417bb1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd0928ed1cdc2319fd14c122b333cba"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a8dd0928ed1cdc2319fd14c122b333cba">gpib_read_byte</a> (void)</td></tr>
<tr class="memdesc:a8dd0928ed1cdc2319fd14c122b333cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">read 1 byte and control line status from GPIB BUS  <a href="#a8dd0928ed1cdc2319fd14c122b333cba">More...</a><br /></td></tr>
<tr class="separator:a8dd0928ed1cdc2319fd14c122b333cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65786186b6eceb91bf717888b03ca9f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a65786186b6eceb91bf717888b03ca9f1">gpib_decode_header</a> (void)</td></tr>
<tr class="memdesc:a65786186b6eceb91bf717888b03ca9f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays help for <a class="el" href="gpib_8c.html#a37b2271a4a82b5c953bf08cf0c571577" title="Calls gpib_decode_str() and dosplays the result. ">gpib_decode()</a> function.  <a href="#a65786186b6eceb91bf717888b03ca9f1">More...</a><br /></td></tr>
<tr class="separator:a65786186b6eceb91bf717888b03ca9f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a702e73930b9d9909d1fd8fb26d716797"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a702e73930b9d9909d1fd8fb26d716797">gpib_decode_str</a> (uint16_t ch)</td></tr>
<tr class="memdesc:a702e73930b9d9909d1fd8fb26d716797"><td class="mdescLeft">&#160;</td><td class="mdescRight">decode/display all control flags and data on the GPIB BUS  <a href="#a702e73930b9d9909d1fd8fb26d716797">More...</a><br /></td></tr>
<tr class="separator:a702e73930b9d9909d1fd8fb26d716797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b2271a4a82b5c953bf08cf0c571577"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a37b2271a4a82b5c953bf08cf0c571577">gpib_decode</a> (uint16_t ch)</td></tr>
<tr class="memdesc:a37b2271a4a82b5c953bf08cf0c571577"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls <a class="el" href="gpib_8c.html#a702e73930b9d9909d1fd8fb26d716797" title="decode/display all control flags and data on the GPIB BUS ">gpib_decode_str()</a> and dosplays the result.  <a href="#a37b2271a4a82b5c953bf08cf0c571577">More...</a><br /></td></tr>
<tr class="separator:a37b2271a4a82b5c953bf08cf0c571577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f7cdca85091b3eb0eea0051a200fbe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a67f7cdca85091b3eb0eea0051a200fbe">gpib_read_str</a> (uint8_t *buf, int size, uint16_t *status)</td></tr>
<tr class="memdesc:a67f7cdca85091b3eb0eea0051a200fbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read string from GPIB BUS - controlled by status flags.  <a href="#a67f7cdca85091b3eb0eea0051a200fbe">More...</a><br /></td></tr>
<tr class="separator:a67f7cdca85091b3eb0eea0051a200fbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bdaac9496e7a0a3523481f2e8a2b9fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a1bdaac9496e7a0a3523481f2e8a2b9fe">gpib_write_str</a> (uint8_t *buf, int size, uint16_t *status)</td></tr>
<tr class="memdesc:a1bdaac9496e7a0a3523481f2e8a2b9fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send string to GPIB BUS - controlled by status flags.  <a href="#a1bdaac9496e7a0a3523481f2e8a2b9fe">More...</a><br /></td></tr>
<tr class="separator:a1bdaac9496e7a0a3523481f2e8a2b9fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a00023217d54aa8bb6473583593942869"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a00023217d54aa8bb6473583593942869">gpib_iobuff</a> [<a class="el" href="gpib_8h.html#a78f2361b60656c29cf6da26f240aaae2">GPIB_IOBUFF_LEN</a>]</td></tr>
<tr class="memdesc:a00023217d54aa8bb6473583593942869"><td class="mdescLeft">&#160;</td><td class="mdescRight">common IO buffer for <a class="el" href="gpib_8c.html#a67f7cdca85091b3eb0eea0051a200fbe" title="Read string from GPIB BUS - controlled by status flags. ">gpib_read_str()</a> and <a class="el" href="gpib_8c.html#a1bdaac9496e7a0a3523481f2e8a2b9fe" title="Send string to GPIB BUS - controlled by status flags. ">gpib_write_str()</a>  <a href="#a00023217d54aa8bb6473583593942869">More...</a><br /></td></tr>
<tr class="separator:a00023217d54aa8bb6473583593942869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2296b83cccf9d7a3b954d18ece282bd1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a2296b83cccf9d7a3b954d18ece282bd1">gpib_unread_f</a> = 0</td></tr>
<tr class="memdesc:a2296b83cccf9d7a3b954d18ece282bd1"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a" title="GPIB ungets one character and all status states. ">gpib_unread()</a> flag  <a href="#a2296b83cccf9d7a3b954d18ece282bd1">More...</a><br /></td></tr>
<tr class="separator:a2296b83cccf9d7a3b954d18ece282bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f8b0bbe03e4f62aa8e736a9a1f5f609"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a8f8b0bbe03e4f62aa8e736a9a1f5f609">gpib_unread_data</a></td></tr>
<tr class="memdesc:a8f8b0bbe03e4f62aa8e736a9a1f5f609"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a" title="GPIB ungets one character and all status states. ">gpib_unread()</a> data  <a href="#a8f8b0bbe03e4f62aa8e736a9a1f5f609">More...</a><br /></td></tr>
<tr class="separator:a8f8b0bbe03e4f62aa8e736a9a1f5f609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acef501d1e292f230efac5ed0cddf90e8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#acef501d1e292f230efac5ed0cddf90e8">talking</a></td></tr>
<tr class="memdesc:acef501d1e292f230efac5ed0cddf90e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib talk address  <a href="#acef501d1e292f230efac5ed0cddf90e8">More...</a><br /></td></tr>
<tr class="separator:acef501d1e292f230efac5ed0cddf90e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f34b1ce42fbf3391219cfedde825495"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a8f34b1ce42fbf3391219cfedde825495">talking_last</a></td></tr>
<tr class="memdesc:a8f34b1ce42fbf3391219cfedde825495"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib last talk address  <a href="#a8f34b1ce42fbf3391219cfedde825495">More...</a><br /></td></tr>
<tr class="separator:a8f34b1ce42fbf3391219cfedde825495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a906eb6f6a81521d91f73f9ab2e03b02e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a906eb6f6a81521d91f73f9ab2e03b02e">listening</a></td></tr>
<tr class="memdesc:a906eb6f6a81521d91f73f9ab2e03b02e"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib listen address  <a href="#a906eb6f6a81521d91f73f9ab2e03b02e">More...</a><br /></td></tr>
<tr class="separator:a906eb6f6a81521d91f73f9ab2e03b02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049cdc383eed2f97e4384a5728c00123"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a049cdc383eed2f97e4384a5728c00123">listening_last</a></td></tr>
<tr class="memdesc:a049cdc383eed2f97e4384a5728c00123"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib last listen address  <a href="#a049cdc383eed2f97e4384a5728c00123">More...</a><br /></td></tr>
<tr class="separator:a049cdc383eed2f97e4384a5728c00123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0205f89c3878a7a6cb4ee1f75de35fb3"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a0205f89c3878a7a6cb4ee1f75de35fb3">spoll</a></td></tr>
<tr class="memdesc:a0205f89c3878a7a6cb4ee1f75de35fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib serial poll status  <a href="#a0205f89c3878a7a6cb4ee1f75de35fb3">More...</a><br /></td></tr>
<tr class="separator:a0205f89c3878a7a6cb4ee1f75de35fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8bc74192b6d8a3e352b03e724dac5b7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#ab8bc74192b6d8a3e352b03e724dac5b7">lastcmd</a></td></tr>
<tr class="memdesc:ab8bc74192b6d8a3e352b03e724dac5b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib current and last command  <a href="#ab8bc74192b6d8a3e352b03e724dac5b7">More...</a><br /></td></tr>
<tr class="separator:ab8bc74192b6d8a3e352b03e724dac5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad5615d233044464c3661481a6760cd"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#aaad5615d233044464c3661481a6760cd">current</a></td></tr>
<tr class="separator:aaad5615d233044464c3661481a6760cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25538708e408bbc21b380cb6f709f5d8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpib_8c.html#a25538708e408bbc21b380cb6f709f5d8">secondary</a></td></tr>
<tr class="memdesc:a25538708e408bbc21b380cb6f709f5d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">gpib secondary  <a href="#a25538708e408bbc21b380cb6f709f5d8">More...</a><br /></td></tr>
<tr class="separator:a25538708e408bbc21b380cb6f709f5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>GPIB emulator for HP85 disk emulator project for AVR. </p>
<dl class="section user"><dt>Edit History - [1.0] [Mike Gore] Initial revision of file.</dt><dd></dd></dl>
<dl class="section user"><dt>Copyright &copy; 2014-2017 Mike Gore, Inc. All rights reserved.</dt><dd></dd></dl>
<dl class="section user"><dt>Based on work by Anders Gustafsson.</dt><dd></dd></dl>
<dl class="section user"><dt>Copyright &copy; 2014 Anders Gustafsson All rights reserved..</dt><dd></dd></dl>

<p>Definition in file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a6dcb5fc551174cd685f0802f86329f3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HTIMEOUT&#160;&#160;&#160;(500000L / GPIB_TASK_TIC_US)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the default BUS timeout of 0.5 Seconds in Microseconds. </p>
<ul>
<li>References: Documenation and related sources of information<ul>
<li>Web Resources:<ul>
<li><a href="http://www.hp9845.net">http://www.hp9845.net</a></li>
<li><a href="http://www.hpmuseum.net">http://www.hpmuseum.net</a></li>
<li><a href="http://www.hpmusuem.org">http://www.hpmusuem.org</a></li>
<li><a href="http://bitsavers.trailing-edge.com">http://bitsavers.trailing-edge.com</a></li>
<li><a href="http://en.wikipedia.org/wiki/IEEE-488">http://en.wikipedia.org/wiki/IEEE-488</a></li>
</ul>
</li>
</ul>
</li>
<li>SS80 References:<ul>
<li>"SS80" is the short form used in the project</li>
<li>"Subset 80 from Fixed and flexible disc drives"</li>
<li>Printed November, 1985</li>
<li>HP Part# 5958-4129</li>
</ul>
</li>
<li>CS80 References:<ul>
<li>"CS80" is the short form used in the project</li>
<li>"CS/80 Instruction Set Programming Manual"</li>
<li>Printed: APR 1983</li>
<li>HP Part# 5955-3442</li>
</ul>
</li>
<li>Amigo References:<ul>
<li>"Amigo" is the short form used in the project</li>
<li>"Appendix A of 9895A Flexible Disc Memory Service Manual"</li>
<li>HP Part# 09895-90030</li>
</ul>
</li>
<li>HP-IB<ul>
<li>"HP-IB" is the short form used in the project</li>
<li>"Condensed Description of the Hewlett Packard Interface Bus"</li>
<li>Printed March 1975</li>
<li>HP Part# 59401-90030</li>
</ul>
</li>
<li>Tutorial Description of The Hewllet Packard Interface Bus"
  - "HP-IB Tutorial" is the short form used in the project<ul>
<li><a href="http://www.hpmemory.org/an/pdf/hp-ib_tutorial_1980.pdf">http://www.hpmemory.org/an/pdf/hp-ib_tutorial_1980.pdf</a><ul>
<li>Printed January 1983</li>
</ul>
</li>
<li><a href="http://www.ko4bb.com/Manuals/HP_Agilent/HPIB_tutorial_HP.pdf">http://www.ko4bb.com/Manuals/HP_Agilent/HPIB_tutorial_HP.pdf</a><ul>
<li>Printed 1987</li>
</ul>
</li>
</ul>
</li>
<li>GPIB / IEEE 488 Tutorial by Ian Poole<ul>
<li><a href="http://www.radio-electronics.com/info/t_and_m/gpib/ieee488-basics-tutorial.php">http://www.radio-electronics.com/info/t_and_m/gpib/ieee488-basics-tutorial.php</a> </li>
</ul>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00076">76</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00442">gpib_write_byte()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a09fd9be01cfd79cffd369aacae939408"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DisablePPR </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable PPR (Parallel Poll Response) for a device. </p>
<ul>
<li>Reference: SS80 pg 3-4, section 3-3 <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00298">298</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00886">GPIB_SECONDARY_ADDRESS()</a>, <a class="el" href="ss80_8c_source.html#l00999">SS80_Command_State()</a>, <a class="el" href="ss80_8c_source.html#l01865">SS80_COMMANDS()</a>, <a class="el" href="ss80_8c_source.html#l00299">SS80_Execute_State()</a>, <a class="el" href="ss80_8c_source.html#l00268">SS80_init()</a>, and <a class="el" href="ss80_8c_source.html#l01381">SS80_Transparent_State()</a>.</p>

</div>
</div>
<a class="anchor" id="ad0320b576cbb529fcec04e1fed8da198"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnablePPR </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<ul>
<li>Reference: SS80 pg 3-4, section 3-3 <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00278">278</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="ss80_8c_source.html#l01767">SS80_Amigo_Clear()</a>, <a class="el" href="ss80_8c_source.html#l01801">SS80_Cancel()</a>, <a class="el" href="ss80_8c_source.html#l01711">SS80_Channel_Independent_Clear()</a>, <a class="el" href="ss80_8c_source.html#l00999">SS80_Command_State()</a>, <a class="el" href="ss80_8c_source.html#l00299">SS80_Execute_State()</a>, <a class="el" href="ss80_8c_source.html#l01747">SS80_Selected_Device_Clear()</a>, <a class="el" href="ss80_8c_source.html#l01381">SS80_Transparent_State()</a>, and <a class="el" href="ss80_8c_source.html#l01729">SS80_Universal_Device_Clear()</a>.</p>

</div>
</div>
<a class="anchor" id="a01eaf30370a0b43263d19ebaa2fa4a38"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_assert_ifc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assert Interface clear for 250us. </p>
<ul>
<li>100us is the Minumum</li>
<li>Reference: SS80 section 3-15, pg 3-26 <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00365">365</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__tests_8c_source.html#l00059">gpib_tests()</a>.</p>

</div>
</div>
<a class="anchor" id="ae826d722b789698ce9217758fe55fdcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_assert_ren </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assert REN to put instrument in remote mode. </p>
<ul>
<li>If state != 0 -&gt; assert REN</li>
<li>If state == 0 -&gt; deassert REN <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00385">385</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5576f7a1bab2c1beaab0c03bc62bb349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_bus_init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cold</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize GPIB Bus control lines for powerup or reset conditions. </p>
<ul>
<li>Set cold = 1 at powerup</li>
<li>set cold = 0 in operation to reset bus state<ul>
<li>If cold = 0 NRFD/NDAC is setto 0 busy</li>
</ul>
</li>
<li>References:<ul>
<li>HP-IB Tutorial</li>
<li>HP-IB pg 8-11 <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>
</li>
</ul>
<p>References: HP-IB Tutorial pg 12,13 HP-IB pg 8-11 </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00212">212</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00330">gpib_init_devices()</a>, <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>, <a class="el" href="gpib__task_8c_source.html#l00188">gpib_trace_task()</a>, <a class="el" href="main_8c_source.html#l00192">main()</a>, and <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>.</p>

</div>
</div>
<a class="anchor" id="a37b2271a4a82b5c953bf08cf0c571577"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_decode </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls <a class="el" href="gpib_8c.html#a702e73930b9d9909d1fd8fb26d716797" title="decode/display all control flags and data on the GPIB BUS ">gpib_decode_str()</a> and dosplays the result. </p>
<p>Display: decode/display all control flags and data on GPIB BUS. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8c.html#a702e73930b9d9909d1fd8fb26d716797" title="decode/display all control flags and data on the GPIB BUS ">gpib_decode_str()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00938">938</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00983">gpib_read_str()</a>, and <a class="el" href="gpib_8c_source.html#l01072">gpib_write_str()</a>.</p>

</div>
</div>
<a class="anchor" id="a65786186b6eceb91bf717888b03ca9f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_decode_header </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Displays help for <a class="el" href="gpib_8c.html#a37b2271a4a82b5c953bf08cf0c571577" title="Calls gpib_decode_str() and dosplays the result. ">gpib_decode()</a> function. </p>
<p>You would call this once at the start of a trace for example. </p><dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list is control <a class="el" href="drives_8c.html#a9921ae02cadccc99dd6c3a9b68be050a" title="Config file line number. ">lines</a> we track </dd>
<dd>
: gpib_trace() </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00834">834</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00188">gpib_trace_task()</a>, and <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>.</p>

</div>
</div>
<a class="anchor" id="a702e73930b9d9909d1fd8fb26d716797"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* gpib_decode_str </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>decode/display all control flags and data on the GPIB BUS </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td><ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors.<ul>
<li></li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list.<ul>
<li>An error implies the data byte can't be trusted</li>
<li>Control Line Flags.<ul>
<li><a class="el" href="gpib_8h.html#ab6e601afadf8d274d9d341323a5c6a3e">EOI_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#aadec0e361e7d2ed6a82ef28bee7231f6">SRQ_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#abbe287946c2beaa1f76fe5be364c07ad">ATN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#ac5ae85572f7432aaab806c29177eec8d">REN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#a660f399a9ffcc5c666bcc726073338cb">PP_FLAG</a></li>
</ul>
</li>
<li>Error Flags:<ul>
<li><a class="el" href="gpib_8h.html#a0202c6cc39130a2c251235ef2336cd13">IFC_FLAG</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>string pointer to store the decoded result in.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8c.html#a8dd0928ed1cdc2319fd14c122b333cba" title="read 1 byte and control line status from GPIB BUS ">gpib_read_byte()</a> </dd>
<dd>
: gpib_write_byte(int ch) </dd>
<dd>
: <a class="el" href="gpib_8c.html#a65786186b6eceb91bf717888b03ca9f1" title="Displays help for gpib_decode() function. ">gpib_decode_header()</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>return </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00875">875</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00938">gpib_decode()</a>, <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>, <a class="el" href="gpib__task_8c_source.html#l00188">gpib_trace_task()</a>, <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>, and <a class="el" href="printer_8c_source.html#l00181">printer_buffer()</a>.</p>

</div>
</div>
<a class="anchor" id="a8dd0928ed1cdc2319fd14c122b333cba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpib_read_byte </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read 1 byte and control line status from GPIB BUS </p>
<ul>
<li>References: HP-IB Tutorial pg 13, 14.</li>
<li>Notes: Their diagram is a bit misleading - they start in the BUS init phase. The init happens much earlier in other code - we NEVER want to do that here or bad things will happen - we could step on the sender NRFD test and false trigger it. We instead start with NRFD FLOAT, and NDAC LOW. See loop in send diagram it has NDAC == 0 and NRFD == 1 in the return to send (beginning) part of the loop.</li>
<li>The HP-IB reference has an error: Read ready actually starts when NRFD = 1 and NDAC = 0. If you look at the Write state diagram that can be confirmed.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors.<ul>
<li></li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list.<ul>
<li>An error implies the data byte can't be trusted</li>
<li>Control Line Flags.<ul>
<li><a class="el" href="gpib_8h.html#ab6e601afadf8d274d9d341323a5c6a3e">EOI_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#aadec0e361e7d2ed6a82ef28bee7231f6">SRQ_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#abbe287946c2beaa1f76fe5be364c07ad">ATN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#ac5ae85572f7432aaab806c29177eec8d">REN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#a660f399a9ffcc5c666bcc726073338cb">PP_FLAG</a></li>
</ul>
</li>
<li>Error Flags:<ul>
<li><a class="el" href="gpib_8h.html#a0202c6cc39130a2c251235ef2336cd13">IFC_FLAG</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<p>Note: see: HP-IB Tutorial pg 13</p><ul>
<li>Remember that NDAC and NRFD are now both LOW!</li>
<li>The spec says to KEEP BOTH LOW when NOT ready to read otherwise we may miss a transfer and cause a controller timeout!</li>
<li>GPIB TX state expects NRFD LOW on entry or it is an ERROR! </li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00697">697</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00983">gpib_read_str()</a>, <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>, <a class="el" href="gpib__task_8c_source.html#l00188">gpib_trace_task()</a>, and <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>.</p>

</div>
</div>
<a class="anchor" id="a67f7cdca85091b3eb0eea0051a200fbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gpib_read_str </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read string from GPIB BUS - controlled by status flags. </p>
<ul>
<li>Status flags used when reading<ul>
<li>If EOI is set then EOI detection will end reading when EOI is detected.</li>
<li>If an early or unexpected EOI is detected a warning is displayed.</li>
<li>The state of ATN controls the type of data read.<ul>
<li>If ATN is set then parity is stripped.</li>
<li>Only data matching the ATN flag state set by user is read.<ul>
<li>If we see a mismatch we "unread" it and exit.</li>
<li>Unreading saves data AND status to be reread later on.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8c.html#a8dd0928ed1cdc2319fd14c122b333cba" title="read 1 byte and control line status from GPIB BUS ">gpib_read_byte()</a> </dd>
<dd>
: <a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a" title="GPIB ungets one character and all status states. ">gpib_unread()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Binary gpib string to read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Size of string we want to read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>controls sending modes and returns status</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bytes read </dd>
<dd>
status</dd></dl>
<ul>
<li>Errors TIMEOUT_FLAG or IFC_FLAG will cause early exit and set status.<ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors.<ul>
<li><dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list.</dd></dl>
</li>
<li>An error implies the data byte can't be trusted</li>
<li>Control Line Flags.<ul>
<li>EOI_FLAG</li>
<li>SRQ_FLAG</li>
<li>ATN_FLAG</li>
<li>REN_FLAG</li>
<li>PP_FLAG</li>
</ul>
</li>
<li>Error Flags:<ul>
<li>IFC_FLAG </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>TODO decode this state - for now I just set the EOI_FLAG </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00983">983</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="ss80_8c_source.html#l01767">SS80_Amigo_Clear()</a>, <a class="el" href="ss80_8c_source.html#l00999">SS80_Command_State()</a>, <a class="el" href="ss80_8c_source.html#l00495">SS80_locate_and_write()</a>, and <a class="el" href="ss80_8c_source.html#l01381">SS80_Transparent_State()</a>.</p>

</div>
</div>
<a class="anchor" id="a32d2476eec2bbdf15e7db1b901c5a671"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_state_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset GPIB states and related variables. </p>
<ul>
<li>Called at powerup and IFC or reset states.</li>
<li>Does not reset BUS <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00253">253</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>, <a class="el" href="gpib__task_8c_source.html#l00188">gpib_trace_task()</a>, <a class="el" href="main_8c_source.html#l00192">main()</a>, and <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>.</p>

</div>
</div>
<a class="anchor" id="a687395337dd5c6604a775e3ffd3f006f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_timeout_set </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set GPIB timeout timer in units of GPIB_TASK_TIC_US. </p>
<dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8c.html#a3eb10b99d17dd69982b6bfc820fb29db" title="Test GPIB timeout timer for timeout condition. ">gpib_timeout_test()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00186">186</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00442">gpib_write_byte()</a>.</p>

</div>
</div>
<a class="anchor" id="a3eb10b99d17dd69982b6bfc820fb29db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gpib_timeout_test </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test GPIB timeout timer for timeout condition. </p>
<dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8c.html#a687395337dd5c6604a775e3ffd3f006f" title="Set GPIB timeout timer in units of GPIB_TASK_TIC_US. ">gpib_timeout_set()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>1 if timeout, 0 if not </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00198">198</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00442">gpib_write_byte()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a3c1941e17626338b878123677ae797"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_timer_elapsed_begin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start measuring time - used with hpib_timer_elapsed_end() </p>
<p>See <a class="el" href="gpib__hal_8c.html" title="GPIB emulator hardwware layer for HP85 disk emulator project for AVR. ">gpib_hal.c</a> for CPU specific code Provide Elapsed timer and Timeout timer - both in Microseconds We use the lower level clock elapsed timer functions here </p><dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00112">112</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__tests_8c_source.html#l00059">gpib_tests()</a>, <a class="el" href="ss80_8c_source.html#l00364">SS80_locate_and_read()</a>, and <a class="el" href="ss80_8c_source.html#l00495">SS80_locate_and_write()</a>.</p>

</div>
</div>
<a class="anchor" id="a87ae4b4852f4a1987fc61fec20f53d42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_timer_elapsed_end </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display user message and time delta since <a class="el" href="gpib_8c.html#a6a3c1941e17626338b878123677ae797" title="Start measuring time - used with hpib_timer_elapsed_end() ">gpib_timer_elapsed_begin()</a> call. </p>
<p>Display a message </p><dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00143">143</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__tests_8c_source.html#l00059">gpib_tests()</a>, <a class="el" href="ss80_8c_source.html#l00364">SS80_locate_and_read()</a>, and <a class="el" href="ss80_8c_source.html#l00495">SS80_locate_and_write()</a>.</p>

</div>
</div>
<a class="anchor" id="abe05115c27148ec7013e6f62dc94ae78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_timer_reset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset elapsed and timeout timers Elapses and Timeout Timers. </p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00129">129</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__hal_8c_source.html#l00026">gpib_timer_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ae9291b22beebb9d24354af643505f9cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gpib_timer_task </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main GPIB timer task called by low level interrup hander. </p>
<ul>
<li>Provides Down timers and Elapsed timers</li>
<li>Called every GPIB_TASK_TIC_US Micro Seconds <dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00169">169</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__hal_8c_source.html#l00026">gpib_timer_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a2fdb3d4996ff399dc2fbfcada417bb1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpib_unread </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPIB ungets one character and all status states. </p>
<p>Pushes a character back into the read buffer </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ch</td><td><ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors present.<ul>
<li></li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>ch </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00654">654</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00360">GPIB_COMMANDS()</a>, and <a class="el" href="gpib_8c_source.html#l00983">gpib_read_str()</a>.</p>

</div>
</div>
<a class="anchor" id="ac3d50cc1d56705d107e2f8fb00692e68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpib_write_byte </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send 1 byte and control line states to GPIB BUS. </p>
<ul>
<li>We assume we are talking to an active controller already in read state<ul>
<li>Any error flags set on return imply the data was not likely sent</li>
<li>You can OR the control flags ATN_FLAG, EOI_FLAG with (ch) to send them these states.</li>
<li>Results can be displayed for debugging with the decode(ch) funnction</li>
<li>We always exit with NRFD and NDAC LOW</li>
</ul>
</li>
<li>References: HP-IB Tutorial pg13. HP-IB Tutorial pg 13 for the receive and send control line states Correction: The send routine MUST also wait for NDAC LOW before exit. (You can verify this by checking the receive part of the handshake diagram just before it returns to the start of the loop) Failing to wait will cause problems that may masqurade as timing issues.</li>
<li>(It caused problems with my HP85 before I added the code)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ch</td><td>( Data or Command ) and control flags<ul>
<li>Upper 8 bits: contril flags</li>
<li>Flags:<ul>
<li>EOI_FLAG</li>
<li>ATN_FLAG</li>
</ul>
</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors.<ul>
<li></li>
</ul>
</li>
</ul>
</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list.<ul>
<li>An error implies the data byte can't be trusted</li>
<li>Control Line Flags.<ul>
<li><a class="el" href="gpib_8h.html#ab6e601afadf8d274d9d341323a5c6a3e">EOI_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#aadec0e361e7d2ed6a82ef28bee7231f6">SRQ_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#abbe287946c2beaa1f76fe5be364c07ad">ATN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#ac5ae85572f7432aaab806c29177eec8d">REN_FLAG</a></li>
<li><a class="el" href="gpib_8h.html#a660f399a9ffcc5c666bcc726073338cb">PP_FLAG</a></li>
</ul>
</li>
<li>Error Flags:<ul>
<li><a class="el" href="gpib_8h.html#a0202c6cc39130a2c251235ef2336cd13">IFC_FLAG</a> </li>
</ul>
</li>
</ul>
</dd></dl>
<p>See HP-IB Tutorial pg 13 for the receive and send control line states</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>FIXME If we test NRFD == 1 and NDAC == 1 and exit rather then waiting we frequently fail. Why does this happen ??? Disabling the test and waiting fixes the problem. Why ??? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>FIXME </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00442">442</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l01072">gpib_write_str()</a>.</p>

</div>
</div>
<a class="anchor" id="a1bdaac9496e7a0a3523481f2e8a2b9fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gpib_write_str </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send string to GPIB BUS - controlled by status flags. </p>
<ul>
<li>Status flags used when sending<ul>
<li>If EOI is set then EOI is sent at last character</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Binary gpib string to send </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Size of string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>User status flags that control the sending process.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bytes sent<ul>
<li>will match size on success (no other tests needed).</li>
<li>Any size mismatch impiles error flags IFC_FLAG and TIMEOUT_FLAG.</li>
</ul>
</dd></dl>
<ul>
<li>Errors TIMEOUT_FLAG or IFC_FLAG will cause early exit and set status.<ul>
<li>Lower 8 bits: Data or Command.<ul>
<li>If ATN is LOW then we strip parity from the byte.</li>
</ul>
</li>
<li>Upper 8 bits: Status and Errors.<ul>
<li><dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list.</dd></dl>
</li>
<li>An error implies the data byte can't be trusted</li>
<li>Control Line Flags.<ul>
<li>EOI_FLAG</li>
<li>SRQ_FLAG</li>
<li>ATN_FLAG</li>
<li>REN_FLAG</li>
<li>PP_FLAG</li>
</ul>
</li>
<li>Error Flags:<ul>
<li>IFC_FLAG <dl class="section see"><dt>See also</dt><dd>: <a class="el" href="gpib_8c.html#ac3d50cc1d56705d107e2f8fb00692e68" title="Send 1 byte and control line states to GPIB BUS. ">gpib_write_byte()</a> </dd>
<dd>
: <a class="el" href="gpib_8h.html" title="GPIB emulator for HP85 disk emulator project for AVR. ">gpib.h</a> _FLAGS defines for a full list) </dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>Returns </dd></dl>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l01072">1072</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="printer_8c_source.html#l00253">plot_echo()</a>, <a class="el" href="gpib__task_8c_source.html#l00580">Send_Identify()</a>, <a class="el" href="ss80_8c_source.html#l00914">SS80_describe()</a>, <a class="el" href="ss80_8c_source.html#l01834">SS80_error_return()</a>, <a class="el" href="ss80_8c_source.html#l00364">SS80_locate_and_read()</a>, <a class="el" href="ss80_8c_source.html#l01577">SS80_Report()</a>, and <a class="el" href="ss80_8c_source.html#l00841">SS80_send_status()</a>.</p>

</div>
</div>
<a class="anchor" id="a42d306c338c639682d0d6f0434a5c88b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Parallel_Poll </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attempt to detect the Parallel Poll Reposnse state Used only for debugging - it is unlikely that we will catch this state. </p>
<ul>
<li>PPR is short for "Parellel Poll Response"</li>
<li>PPR happens when the CIC (controller in charge) holds BOTH of ATN == 0 and EOI == 0</li>
<li>PPR Response happens using hardware The hardware pulls a bit low on the GPIB bus corresponding to the device. But only if any PPR mask bits are set in the hardware</li>
<li>Note: EOI is never used in command mode (ATN = 0) 1) Hardware will automatically hold DATA BUS lines low</li>
<li><a class="el" href="gpib__hal_8c.html#a639fcfaa605f43d589798545d9d1a975" title="Return PPR enable register. ">ppr_reg()</a> determines if we have PPR enabled.</li>
<li>References:<ul>
<li>SS80 pg 3-4, section 3-3 <dl class="section see"><dt>See also</dt><dd><a class="el" href="gpib_8c.html#ad0320b576cbb529fcec04e1fed8da198">EnablePPR()</a> </dd>
<dd>
<a class="el" href="gpib_8c.html#a09fd9be01cfd79cffd369aacae939408" title="Disable PPR (Parallel Poll Response) for a device. ">DisablePPR()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>1 if we see a PPR, 0 if not </dd></dl>
</li>
</ul>
</li>
</ul>
<p>Bus pin states</p>
<p>debugging - ddr bits should be 0xff </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00330">330</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00442">gpib_write_byte()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="aaad5615d233044464c3661481a6760cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t current</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00099">99</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="timer_8c_source.html#l00200">clock_elapsed_end()</a>, <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a00023217d54aa8bb6473583593942869"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gpib_iobuff[<a class="el" href="gpib_8h.html#a78f2361b60656c29cf6da26f240aaae2">GPIB_IOBUFF_LEN</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>common IO buffer for <a class="el" href="gpib_8c.html#a67f7cdca85091b3eb0eea0051a200fbe" title="Read string from GPIB BUS - controlled by status flags. ">gpib_read_str()</a> and <a class="el" href="gpib_8c.html#a1bdaac9496e7a0a3523481f2e8a2b9fe" title="Send string to GPIB BUS - controlled by status flags. ">gpib_write_str()</a> </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00079">79</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="ss80_8c_source.html#l00999">SS80_Command_State()</a>, <a class="el" href="ss80_8c_source.html#l00364">SS80_locate_and_read()</a>, <a class="el" href="ss80_8c_source.html#l00495">SS80_locate_and_write()</a>, and <a class="el" href="ss80_8c_source.html#l01381">SS80_Transparent_State()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f8b0bbe03e4f62aa8e736a9a1f5f609"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t gpib_unread_data</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a" title="GPIB ungets one character and all status states. ">gpib_unread()</a> data </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00084">84</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00654">gpib_unread()</a>.</p>

</div>
</div>
<a class="anchor" id="a2296b83cccf9d7a3b954d18ece282bd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gpib_unread_f = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="gpib_8c.html#a2fdb3d4996ff399dc2fbfcada417bb1a" title="GPIB ungets one character and all status states. ">gpib_unread()</a> flag </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00082">82</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00212">gpib_bus_init()</a>, <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, and <a class="el" href="gpib_8c_source.html#l00654">gpib_unread()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8bc74192b6d8a3e352b03e724dac5b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t lastcmd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib current and last command </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00099">99</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00732">GPIB_LISTEN()</a>, <a class="el" href="gpib_8c_source.html#l00697">gpib_read_byte()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, and <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>.</p>

</div>
</div>
<a class="anchor" id="a906eb6f6a81521d91f73f9ab2e03b02e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t listening</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib listen address </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00092">92</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00613">GPIB()</a>, <a class="el" href="gpib__task_8c_source.html#l00360">GPIB_COMMANDS()</a>, <a class="el" href="gpib__task_8c_source.html#l00732">GPIB_LISTEN()</a>, <a class="el" href="gpib__task_8c_source.html#l00886">GPIB_SECONDARY_ADDRESS()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, <a class="el" href="gpib__task_8c_source.html#l00806">GPIB_TALK()</a>, <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>, <a class="el" href="printer_8c_source.html#l00224">PRINTER_COMMANDS()</a>, and <a class="el" href="ss80_8c_source.html#l01865">SS80_COMMANDS()</a>.</p>

</div>
</div>
<a class="anchor" id="a049cdc383eed2f97e4384a5728c00123"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t listening_last</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib last listen address </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00094">94</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00732">GPIB_LISTEN()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, and <a class="el" href="gpib__task_8c_source.html#l00938">listen_cleanup()</a>.</p>

</div>
</div>
<a class="anchor" id="a25538708e408bbc21b380cb6f709f5d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t secondary</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib secondary </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00102">102</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00360">GPIB_COMMANDS()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, and <a class="el" href="gpib__task_8c_source.html#l00445">gpib_task()</a>.</p>

</div>
</div>
<a class="anchor" id="a0205f89c3878a7a6cb4ee1f75de35fb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t spoll</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib serial poll status </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00097">97</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00613">GPIB()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, and <a class="el" href="gpib__task_8c_source.html#l00806">GPIB_TALK()</a>.</p>

</div>
</div>
<a class="anchor" id="acef501d1e292f230efac5ed0cddf90e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t talking</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib talk address </p>
<p>GPIB BUS states. </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00087">87</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib__task_8c_source.html#l00613">GPIB()</a>, <a class="el" href="gpib__task_8c_source.html#l00360">GPIB_COMMANDS()</a>, <a class="el" href="gpib__task_8c_source.html#l00732">GPIB_LISTEN()</a>, <a class="el" href="gpib__task_8c_source.html#l00886">GPIB_SECONDARY_ADDRESS()</a>, <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, <a class="el" href="gpib__task_8c_source.html#l00806">GPIB_TALK()</a>, <a class="el" href="printer_8c_source.html#l00224">PRINTER_COMMANDS()</a>, and <a class="el" href="ss80_8c_source.html#l01865">SS80_COMMANDS()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f34b1ce42fbf3391219cfedde825495"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t talking_last</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gpib last talk address </p>

<p>Definition at line <a class="el" href="gpib_8c_source.html#l00089">89</a> of file <a class="el" href="gpib_8c_source.html">gpib.c</a>.</p>

<p>Referenced by <a class="el" href="gpib_8c_source.html#l00253">gpib_state_init()</a>, and <a class="el" href="gpib__task_8c_source.html#l00806">GPIB_TALK()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 6 2017 20:03:18 for HP85 GPIB Disk Emulator by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
